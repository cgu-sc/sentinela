{"config":{"lang":["pt"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"index.html","title":"\ud83d\udee1\ufe0f Projeto Sentinela","text":"<ul> <li> Sistema de Auditoria Automatizada</li> </ul> <p>O Projeto Sentinela \u00e9 uma solu\u00e7\u00e3o desenvolvida pela Controladoria-Geral da Uni\u00e3o (CGU) para detectar irregularidades no Programa Farm\u00e1cia Popular do Brasil (PFPB).</p> <p> Conhecer o projeto</p> <ul> <li> 17 Indicadores de Fraude</li> </ul> <p>Matriz de risco com indicadores estat\u00edsticos que permitem identificar padr\u00f5es an\u00f4malos de comportamento e priorizar auditorias.</p> <p> Ver indicadores</p> <ul> <li> Relat\u00f3rios Automatizados</li> </ul> <p>Dossi\u00eas individualizados para cada farm\u00e1cia com movimenta\u00e7\u00e3o de estoque, evolu\u00e7\u00e3o financeira e an\u00e1lise de prescritores.</p> <p> Explorar relat\u00f3rios</p> <ul> <li> Guia de Execu\u00e7\u00e3o</li> </ul> <p>Instru\u00e7\u00f5es detalhadas para configura\u00e7\u00e3o do ambiente, execu\u00e7\u00e3o dos scripts e gera\u00e7\u00e3o de resultados.</p> <p> Come\u00e7ar agora</p>"},{"location":"index.html#numeros-do-projeto","title":"\ud83d\udcca N\u00fameros do Projeto","text":"M\u00e9trica Valor Per\u00edodo Analisado Julho/2015 a Dezembro/2024 Farm\u00e1cias Auditadas 34.000+ estabelecimentos Indicadores de Risco 17 m\u00e9tricas independentes Rodadas de An\u00e1lise 2 (2015-2020 e 2021-2024)"},{"location":"index.html#premissa-fundamental","title":"\ud83c\udfaf Premissa Fundamental","text":"<p>Princ\u00edpio Central da Auditoria</p> <p>\"Um estabelecimento n\u00e3o pode vender aquilo que n\u00e3o comprou.\"</p> <pre><code>Essa premissa simples, por\u00e9m poderosa, permite identificar fraudes contra o er\u00e1rio de forma objetiva e rastre\u00e1vel, comparando os registros de vendas (Sistema Autorizador do Minist\u00e9rio da Sa\u00fade) com as aquisi\u00e7\u00f5es documentadas (Notas Fiscais Eletr\u00f4nicas da Receita Federal).\n</code></pre>"},{"location":"index.html#arquitetura-do-sistema","title":"\ud83c\udfd7\ufe0f Arquitetura do Sistema","text":"flowchart LR     subgraph Entrada[\"\ud83d\udce5 Fontes de Dados\"]         A[(db_farmaciapopularVendas)]         B[(db_farmaciapopular_nfNF-e Aquisi\u00e7\u00f5es)]         C[(db_CNPJCadastros)]     end      subgraph Processamento[\"\u2699\ufe0f Processamento\"]         D[Fase 1Prepara\u00e7\u00e3o SQL]         E[Fase 2An\u00e1lise Python]         F[Fase 3Relat\u00f3rios]     end      subgraph Saida[\"\ud83d\udce4 Produtos\"]         G[\ud83d\udcca Matriz de Risco]         H[\ud83d\udcd1 Dossi\u00eas Excel]         I[\ud83d\udcc8 Painel BI]     end      A --&gt; D     B --&gt; D     C --&gt; D     D --&gt; E     E --&gt; F     F --&gt; G     F --&gt; H     F --&gt; I"},{"location":"index.html#como-usar-esta-documentacao","title":"\ud83d\udcda Como Usar Esta Documenta\u00e7\u00e3o","text":"Para AuditoresPara DesenvolvedoresPara Gestores <p>Se voc\u00ea \u00e9 auditor e precisa entender os resultados:</p> <ol> <li>Comece pelo Resumo do Projeto</li> <li>Entenda os Indicadores de Risco</li> <li>Aprenda a interpretar os Relat\u00f3rios</li> </ol> <p>Se voc\u00ea precisa executar ou modificar o sistema:</p> <ol> <li>Revise a Arquitetura</li> <li>Entenda o Fluxo de Dados</li> <li>Siga o Guia de Execu\u00e7\u00e3o</li> </ol> <p>Se voc\u00ea precisa de uma vis\u00e3o executiva:</p> <ol> <li>Leia o Contexto e Objetivos</li> <li>Veja os Resultados Alcan\u00e7ados</li> <li>Conhe\u00e7a a Matriz de Risco</li> </ol>"},{"location":"index.html#acesso-rapido","title":"\ud83d\udd17 Acesso R\u00e1pido","text":"<ul> <li> Painel Sentinela - Visualiza\u00e7\u00e3o online dos resultados</li> <li> Resultados 2015-2020 - Primeira rodada de an\u00e1lise</li> <li> Resultados 2021-2024 - Segunda rodada de an\u00e1lise</li> <li> Contatos da Equipe - Suporte t\u00e9cnico</li> </ul>"},{"location":"contatos.html","title":"Contatos","text":""},{"location":"contatos.html#equipe-tecnica-do-projeto","title":"Equipe T\u00e9cnica do Projeto","text":""},{"location":"contatos.html#desenvolvedores-principais","title":"Desenvolvedores Principais","text":"Nome Fun\u00e7\u00e3o E-mail Guilherme Martins Willemann An\u00e1lise e Desenvolvimento guilherme.willemann@cgu.gov.br Fernando Rodrigues Jo\u00e3o Junior An\u00e1lise fernando.joao-junior@cgu.gov.br Tatiana Popia Corr\u00eaa An\u00e1lise e Desenvolvimento tatiana.correa@cgu.gov.br"},{"location":"contatos.html#supervisao","title":"Supervis\u00e3o","text":"Nome Cargo E-mail Tatiana Popia Corr\u00eaa Chefe do NEP tatiana.correa@cgu.gov.br"},{"location":"contatos.html#unidade-responsavel","title":"Unidade Respons\u00e1vel","text":"<p>N\u00facleo de Estudos e Pesquisas (NEP) CGU Santa Catarina</p> <p>Controladoria-Geral da Uni\u00e3o Superintend\u00eancia Regional de Santa Catarina</p>"},{"location":"contatos.html#canais-de-suporte","title":"Canais de Suporte","text":""},{"location":"contatos.html#duvidas-tecnicas","title":"D\u00favidas T\u00e9cnicas","text":"<p>Para quest\u00f5es sobre:</p> <ul> <li>Execu\u00e7\u00e3o dos scripts</li> <li>Interpreta\u00e7\u00e3o dos resultados</li> <li>Acesso \u00e0s bases de dados</li> <li>Problemas t\u00e9cnicos</li> </ul> <p>Entre em contato com: guilherme.willemann@cgu.gov.br e tatiana.correa@cgu.gov.br</p>"},{"location":"contatos.html#duvidas-metodologicas","title":"D\u00favidas Metodol\u00f3gicas","text":"<p>Para quest\u00f5es sobre:</p> <ul> <li>Metodologia de c\u00e1lculo</li> <li>Interpreta\u00e7\u00e3o de indicadores</li> <li>Crit\u00e9rios de an\u00e1lise</li> </ul> <p>Entre em contato com: guilherme.willemann@cgu.gov.br ou fernando.joao-junior@cgu.gov.br</p>"},{"location":"contatos.html#acesso-ao-painel","title":"Acesso ao Painel","text":"<p>Para solicitar acesso ao Painel Sentinela:</p> <p>\ud83d\udd17 https://paineis.cgu.gov.br/sentinela</p> <p>Entre em contato com: tatiana.correa@cgu.gov.br</p>"},{"location":"contatos.html#links-uteis","title":"Links \u00dateis","text":"Recurso URL Painel Sentinela https://paineis.cgu.gov.br/sentinela Portal CGU https://www.gov.br/cgu Programa Farm\u00e1cia Popular https://www.gov.br/saude/pt-br/composicao/sctie/farmacia-popular"},{"location":"arquitetura/index.html","title":"Arquitetura do Sistema","text":"<p>Esta se\u00e7\u00e3o detalha a arquitetura t\u00e9cnica do Sistema Sentinela, incluindo as fontes de dados, estrutura de tabelas e fluxo de processamento.</p>"},{"location":"arquitetura/index.html#navegacao","title":"Navega\u00e7\u00e3o","text":"<ul> <li> Fontes de Dados</li> </ul> <p>As duas tabelas transacionais principais: vendas do PFPB e aquisi\u00e7\u00f5es por NF-e.</p> <p> Ver fontes</p> <ul> <li> Tabelas de Apoio</li> </ul> <p>Dicion\u00e1rio de medicamentos e outras tabelas auxiliares do sistema.</p> <p> Ver tabelas</p> <ul> <li> Estrutura de Tabelas</li> </ul> <p>Detalhamento das tabelas de resultado criadas pelo sistema.</p> <p> Ver estrutura</p> <ul> <li> Fluxo de Dados</li> </ul> <p>Vis\u00e3o geral do pipeline de processamento de dados.</p> <p> Ver fluxo</p>"},{"location":"arquitetura/index.html#fases-do-projeto","title":"Fases do Projeto","text":"<ul> <li> Fase 1: Prepara\u00e7\u00e3o</li> </ul> <p>Estrutura\u00e7\u00e3o das tabelas, particionamento e c\u00e1lculo do estoque inicial.</p> <p> Detalhar</p> <ul> <li> Fase 2: Processamento</li> </ul> <p>Simula\u00e7\u00e3o de fluxo de estoque e detec\u00e7\u00e3o de irregularidades.</p> <p> Detalhar</p> <ul> <li> Fase 3: Relat\u00f3rios</li> </ul> <p>Gera\u00e7\u00e3o de dossi\u00eas Excel e formata\u00e7\u00e3o dos resultados.</p> <p> Detalhar</p> <ul> <li> Fase 4: An\u00e1lise Gerencial</li> </ul> <p>Agrega\u00e7\u00e3o de resultados e c\u00e1lculo dos indicadores de risco.</p> <p> Detalhar</p>"},{"location":"arquitetura/index.html#stack-tecnologico","title":"Stack Tecnol\u00f3gico","text":""},{"location":"arquitetura/index.html#camadas-do-sistema","title":"Camadas do Sistema","text":"Camada Tecnologia Fun\u00e7\u00e3o Principal Armazenamento SQL Server 2019+ Persist\u00eancia de dados e queries complexas Processamento Python 3.8+ L\u00f3gica de neg\u00f3cio e gera\u00e7\u00e3o de relat\u00f3rios Apresenta\u00e7\u00e3o Excel + Power BI Visualiza\u00e7\u00e3o e an\u00e1lise"},{"location":"arquitetura/index.html#bibliotecas-python","title":"Bibliotecas Python","text":"Biblioteca Vers\u00e3o Fun\u00e7\u00e3o <code>pyodbc</code> 5.1.0 Conex\u00e3o com SQL Server via ODBC <code>pandas</code> 2.2.2 Manipula\u00e7\u00e3o de dados tabulares <code>XlsxWriter</code> 3.2.0 Gera\u00e7\u00e3o de planilhas Excel formatadas <code>tqdm</code> 4.66.4 Barras de progresso no terminal <code>art</code> 6.1 Arte ASCII para interface"},{"location":"arquitetura/index.html#dependencias-de-sistema","title":"Depend\u00eancias de Sistema","text":"<ul> <li>Microsoft ODBC Driver 17 for SQL Server</li> <li>Acesso de rede \u00e0 inst\u00e2ncia SQL Server</li> <li>Permiss\u00f5es de leitura/escrita nas bases de dados</li> </ul>"},{"location":"arquitetura/index.html#principios-de-design","title":"Princ\u00edpios de Design","text":""},{"location":"arquitetura/index.html#1-processamento-em-lotes","title":"1. Processamento em Lotes","text":"<p>O sistema divide o universo de CNPJs em lotes de 50 CNPJs por execu\u00e7\u00e3o para:</p> <ul> <li>Evitar sobrecarga de mem\u00f3ria</li> <li>Permitir interrup\u00e7\u00e3o e retomada</li> <li>Facilitar monitoramento de progresso</li> </ul>"},{"location":"arquitetura/index.html#2-recuperacao-de-falhas","title":"2. Recupera\u00e7\u00e3o de Falhas","text":"<p>O sistema implementa mecanismos de recupera\u00e7\u00e3o:</p> <ul> <li>Detec\u00e7\u00e3o autom\u00e1tica de processamentos incompletos</li> <li>Limpeza de dados parciais antes de reprocessar</li> <li>Log detalhado de erros para diagn\u00f3stico</li> </ul>"},{"location":"arquitetura/index.html#3-otimizacao-de-performance","title":"3. Otimiza\u00e7\u00e3o de Performance","text":"<p>T\u00e9cnicas utilizadas para otimiza\u00e7\u00e3o:</p> <ul> <li>\u00cdndices din\u00e2micos nas tabelas de trabalho</li> <li>Cache em mem\u00f3ria de tabelas de apoio</li> <li>Compress\u00e3o Zlib da mem\u00f3ria de c\u00e1lculo</li> </ul>"},{"location":"arquitetura/index.html#4-rastreabilidade","title":"4. Rastreabilidade","text":"<p>Todas as opera\u00e7\u00f5es s\u00e3o documentadas:</p> <ul> <li>Mem\u00f3ria de c\u00e1lculo completa para cada CNPJ</li> <li>Notas fiscais que comp\u00f5em cada estoque</li> <li>Logs de execu\u00e7\u00e3o com timestamps</li> </ul> <p>Pr\u00f3ximo Passo</p> <p>Explore as Fontes de Dados para entender as tabelas transacionais centrais do sistema.</p>"},{"location":"arquitetura/estrutura-tabelas.html","title":"Estrutura de Tabelas de Resultado","text":"<p>Esta se\u00e7\u00e3o detalha as tabelas criadas pelo sistema para armazenar os resultados da auditoria.</p>"},{"location":"arquitetura/estrutura-tabelas.html#1-tabela-de-processamentos","title":"1. Tabela de Processamentos","text":""},{"location":"arquitetura/estrutura-tabelas.html#11-identificacao","title":"1.1. Identifica\u00e7\u00e3o","text":"Atributo Valor Nome da Tabela <code>temp_CGUSC.dbo.processamentosFP</code> Fun\u00e7\u00e3o Registrar o status de processamento de cada farm\u00e1cia Criada por Script de Prepara\u00e7\u00e3o (Fase 1) Populada por Script Python (Fase 2)"},{"location":"arquitetura/estrutura-tabelas.html#12-descricao","title":"1.2. Descri\u00e7\u00e3o","text":"<p>Cont\u00e9m dados de processamento de cada estabelecimento, como a data de processamento e o per\u00edodo analisado. Funciona como um log de execu\u00e7\u00e3o e permite monitorar o progresso da an\u00e1lise.</p>"},{"location":"arquitetura/estrutura-tabelas.html#13-estrutura-completa","title":"1.3. Estrutura Completa","text":"Campo Tipo Descri\u00e7\u00e3o Exemplo <code>id</code> INT IDENTITY C\u00f3digo incremental \u00fanico 12345 <code>cnpj</code> VARCHAR(14) CNPJ do estabelecimento 12345678000199 <code>razao_social</code> VARCHAR(200) Raz\u00e3o social da farm\u00e1cia FARMACIA EXEMPLO LTDA <code>nome_fantasia</code> VARCHAR(200) Nome fantasia FARMACIA EXEMPLO <code>municipio</code> VARCHAR(100) Munic\u00edpio de localiza\u00e7\u00e3o FLORIAN\u00d3POLIS <code>uf</code> CHAR(2) Unidade da Federa\u00e7\u00e3o SC <code>periodo_inicial</code> DATE Data de in\u00edcio da an\u00e1lise 2015-07-01 <code>periodo_final</code> DATE Data final da an\u00e1lise 2024-12-10 <code>data_processamento</code> DATETIME Momento do processamento 2025-01-15 10:30:00 <code>situacao</code> INT C\u00f3digo de status 1 <code>status_detalhado</code> VARCHAR(500) Mensagem de status Processamento conclu\u00eddo com sucesso <code>tempo_processamento_segundos</code> DECIMAL(10,2) Tempo de execu\u00e7\u00e3o em segundos 45.32 <code>total_registros_processados</code> INT Quantidade de transa\u00e7\u00f5es 15420 <code>total_medicamentos</code> INT Quantidade de GTINs distintos 87"},{"location":"arquitetura/estrutura-tabelas.html#14-codigos-de-situacao","title":"1.4. C\u00f3digos de Situa\u00e7\u00e3o","text":"C\u00f3digo Constante Significado Descri\u00e7\u00e3o 1 <code>SIT_SUCCESS</code> Sucesso com irregularidades Processamento conclu\u00eddo, irregularidades detectadas 2 <code>SIT_RUNNING</code> Em andamento Processamento iniciado, ainda n\u00e3o finalizado 3 <code>SIT_FAILED</code> Falha Erro durante a execu\u00e7\u00e3o 4 <code>SIT_NO_DATA</code> Sem dados CNPJ n\u00e3o possui dados no per\u00edodo 5 <code>SIT_NO_SALES</code> Sem vendas CNPJ sem registros de venda 6 <code>SIT_NO_ISSUES</code> Sucesso sem irregularidades Processamento conclu\u00eddo, nenhuma irregularidade"},{"location":"arquitetura/estrutura-tabelas.html#15-uso-no-sistema","title":"1.5. Uso no Sistema","text":"<ul> <li>Controle de Execu\u00e7\u00e3o: Permite identificar CNPJs j\u00e1 processados</li> <li>Retomada de Falhas: Identifica processamentos interrompidos</li> <li>Monitoramento: Acompanhamento do progresso em tempo real</li> <li>Auditoria: Log completo de quando e como cada CNPJ foi processado</li> </ul>"},{"location":"arquitetura/estrutura-tabelas.html#2-tabela-de-movimentacao-mensal","title":"2. Tabela de Movimenta\u00e7\u00e3o Mensal","text":""},{"location":"arquitetura/estrutura-tabelas.html#21-identificacao","title":"2.1. Identifica\u00e7\u00e3o","text":"Atributo Valor Nome da Tabela <code>temp_CGUSC.dbo.movimentacaoMensalCodigoBarraFP</code> Fun\u00e7\u00e3o Armazenar resumo mensal da movimenta\u00e7\u00e3o por produto Criada por Script de prepara\u00e7\u00e3o (Fase 1) Populada por Script Python (Fase 2)"},{"location":"arquitetura/estrutura-tabelas.html#22-descricao","title":"2.2. Descri\u00e7\u00e3o","text":"<p>Cont\u00e9m dados de movimenta\u00e7\u00e3o dos estabelecimentos em granularidade mensal por produto. Esta tabela permite an\u00e1lise temporal (evolu\u00e7\u00e3o ao longo dos meses) e por medicamento.</p>"},{"location":"arquitetura/estrutura-tabelas.html#23-estrutura-completa","title":"2.3. Estrutura Completa","text":"Campo Tipo Descri\u00e7\u00e3o Exemplo <code>id</code> INT IDENTITY C\u00f3digo incremental \u00fanico 98765 <code>id_processamento</code> INT FK para processamentosFP 12345 <code>codigo_barra</code> BIGINT GTIN do medicamento 7891234567890 <code>periodo</code> DATE M\u00eas/ano da consolida\u00e7\u00e3o (dia 01) 2023-06-01 <code>qnt_vendas</code> INT Quantidade total vendida no per\u00edodo 150 <code>qnt_vendas_sem_comprovacao</code> INT Quantidade sem comprova\u00e7\u00e3o 45 <code>valor_vendas</code> DECIMAL(12,2) Valor total das vendas 3500.00 <code>valor_sem_comprovacao</code> DECIMAL(12,2) Valor sem comprova\u00e7\u00e3o 1050.00"},{"location":"arquitetura/estrutura-tabelas.html#24-relacionamento","title":"2.4. Relacionamento","text":"erDiagram     processamentosFP ||--o{ movimentacaoMensalCodigoBarraFP : \"cont\u00e9m\"      processamentosFP {         int id PK         varchar cnpj         date periodo_inicial         date periodo_final         int situacao     }      movimentacaoMensalCodigoBarraFP {         int id PK         int id_processamento FK         bigint codigo_barra         date periodo         int qnt_vendas         decimal valor_vendas     }"},{"location":"arquitetura/estrutura-tabelas.html#25-uso-no-sistema","title":"2.5. Uso no Sistema","text":"<ul> <li>Fase 3 (Relat\u00f3rios): Base para gr\u00e1ficos de evolu\u00e7\u00e3o financeira</li> <li>Fase 4 (An\u00e1lise): Agrega\u00e7\u00e3o para indicadores gerenciais</li> <li>An\u00e1lise Temporal: Identificar quando irregularidades come\u00e7aram</li> </ul>"},{"location":"arquitetura/estrutura-tabelas.html#3-tabela-de-memoria-de-calculo","title":"3. Tabela de Mem\u00f3ria de C\u00e1lculo","text":""},{"location":"arquitetura/estrutura-tabelas.html#31-identificacao","title":"3.1. Identifica\u00e7\u00e3o","text":"Atributo Valor Nome da Tabela <code>temp_CGUSC.dbo.memoria_calculo_consolidadaFP</code> Fun\u00e7\u00e3o Armazenar mem\u00f3ria de c\u00e1lculo comprimida Populada por Script Python (Fase 2)"},{"location":"arquitetura/estrutura-tabelas.html#32-descricao","title":"3.2. Descri\u00e7\u00e3o","text":"<p>Armazena a mem\u00f3ria de c\u00e1lculo completa de cada processamento em formato JSON comprimido (Zlib). Esta tabela permite a regenera\u00e7\u00e3o de relat\u00f3rios sem necessidade de reprocessamento.</p>"},{"location":"arquitetura/estrutura-tabelas.html#33-estrutura","title":"3.3. Estrutura","text":"Campo Tipo Descri\u00e7\u00e3o <code>id</code> INT IDENTITY C\u00f3digo incremental \u00fanico <code>id_processamento</code> INT FK para processamentosFP <code>cnpj</code> VARCHAR(14) CNPJ da farm\u00e1cia <code>dados_comprimidos</code> VARBINARY(MAX) JSON comprimido com Zlib"},{"location":"arquitetura/estrutura-tabelas.html#34-estrutura-do-json-interno","title":"3.4. Estrutura do JSON Interno","text":"<p>Quando descomprimido, o JSON cont\u00e9m uma lista de registros com a seguinte estrutura:</p> Campo Descri\u00e7\u00e3o <code>tipo</code> Tipo do registro: 'h' (header), 'e' (estoque), 'c' (compra), 'd' (devolu\u00e7\u00e3o), 'v' (venda), 's' (sum\u00e1rio) <code>codigo_barra</code> GTIN do medicamento <code>periodo_inicial</code> Data de in\u00edcio do per\u00edodo de vendas <code>periodo_final</code> Data final do per\u00edodo de vendas <code>estoque_inicial</code> Estoque no in\u00edcio do per\u00edodo <code>estoque_final</code> Estoque no final do per\u00edodo <code>vendas_periodo</code> Quantidade vendida no per\u00edodo <code>vendas_sem_comprovacao</code> Quantidade sem comprova\u00e7\u00e3o <code>valor_movimentado</code> Valor total das vendas <code>valor_sem_comprovacao</code> Valor sem comprova\u00e7\u00e3o <code>data_aquis_dev_estoq</code> Data de aquisi\u00e7\u00e3o/devolu\u00e7\u00e3o/estoque <code>qnt_aquis_dev</code> Quantidade adquirida/devolvida <code>numero_nfe</code> N\u00famero da nota fiscal"},{"location":"arquitetura/estrutura-tabelas.html#35-tipos-de-registro","title":"3.5. Tipos de Registro","text":"Tipo Nome Descri\u00e7\u00e3o <code>h</code> Header Cabe\u00e7alho do produto (GTIN) <code>e</code> Estoque Estoque inicial estimado <code>c</code> Compra Transa\u00e7\u00e3o de aquisi\u00e7\u00e3o (entrada) <code>d</code> Devolu\u00e7\u00e3o Transa\u00e7\u00e3o de devolu\u00e7\u00e3o/transfer\u00eancia (sa\u00edda) <code>v</code> Venda Bloco consolidado de vendas <code>s</code> Sum\u00e1rio Totais do produto"},{"location":"arquitetura/estrutura-tabelas.html#36-compressao","title":"3.6. Compress\u00e3o","text":"<p>Otimiza\u00e7\u00e3o de Espa\u00e7o</p> <p>A mem\u00f3ria de c\u00e1lculo \u00e9 comprimida usando Zlib n\u00edvel 9 (m\u00e1xima compress\u00e3o), resultando em redu\u00e7\u00e3o de aproximadamente 90% no tamanho dos dados.</p>"},{"location":"arquitetura/estrutura-tabelas.html#4-tabela-de-estoque-inicial","title":"4. Tabela de Estoque Inicial","text":""},{"location":"arquitetura/estrutura-tabelas.html#41-identificacao","title":"4.1. Identifica\u00e7\u00e3o","text":"Atributo Valor Nome da Tabela <code>temp_CGUSC.dbo.estoque_inicialFP</code> Fun\u00e7\u00e3o Armazenar estimativa de estoque inicial por produto/farm\u00e1cia Criada por Script de prepara\u00e7\u00e3o (Fase 1)"},{"location":"arquitetura/estrutura-tabelas.html#42-estrutura","title":"4.2. Estrutura","text":"Campo Tipo Descri\u00e7\u00e3o <code>cnpj_estabelecimento</code> VARCHAR(14) CNPJ da farm\u00e1cia <code>codigo_barra</code> BIGINT GTIN do medicamento <code>estoque_inicial</code> INT Quantidade estimada de estoque inicial <code>data_estoque_inicial</code> DATE Data de refer\u00eancia do estoque"},{"location":"arquitetura/estrutura-tabelas.html#43-metodologia-de-calculo","title":"4.3. Metodologia de C\u00e1lculo","text":"<p>O estoque inicial \u00e9 estimado atrav\u00e9s da seguinte metodologia:</p> <ol> <li>Identifica a data da primeira venda do produto na farm\u00e1cia</li> <li>Busca notas fiscais de aquisi\u00e7\u00e3o nos 6 meses anteriores</li> <li>Ordena as notas da mais recente para a mais antiga</li> <li>Soma as quantidades das duas \u00faltimas aquisi\u00e7\u00f5es</li> </ol> <p>Crit\u00e9rio do Estoque Inicial</p> <p>\"Soma das duas \u00faltimas aquisi\u00e7\u00f5es, considerando os 6 meses anteriores \u00e0 primeira venda.\"</p> <pre><code>Este crit\u00e9rio foi definido para criar uma estimativa conservadora e audit\u00e1vel.\n</code></pre>"},{"location":"arquitetura/estrutura-tabelas.html#5-tabela-de-notas-do-estoque-inicial","title":"5. Tabela de Notas do Estoque Inicial","text":""},{"location":"arquitetura/estrutura-tabelas.html#51-identificacao","title":"5.1. Identifica\u00e7\u00e3o","text":"Atributo Valor Nome da Tabela <code>temp_CGUSC.dbo.notas_estoque_inicialFP</code> Fun\u00e7\u00e3o Rastrear as NFs usadas no c\u00e1lculo do estoque inicial"},{"location":"arquitetura/estrutura-tabelas.html#52-descricao","title":"5.2. Descri\u00e7\u00e3o","text":"<p>Armazena as notas fiscais exatas que foram utilizadas para compor a estimativa de estoque inicial. Garante a rastreabilidade e auditabilidade da metodologia.</p>"},{"location":"arquitetura/estrutura-tabelas.html#53-estrutura","title":"5.3. Estrutura","text":"Campo Tipo Descri\u00e7\u00e3o <code>cnpj_estabelecimento</code> VARCHAR(14) CNPJ da farm\u00e1cia <code>quantidade</code> INT Quantidade da NF <code>codigo_barra</code> BIGINT GTIN do medicamento <code>data_aquisicao</code> DATE Data da nota fiscal <code>numero_nfe</code> BIGINT N\u00famero da nota fiscal"},{"location":"arquitetura/estrutura-tabelas.html#6-tabela-de-resultado-consolidado","title":"6. Tabela de Resultado Consolidado","text":""},{"location":"arquitetura/estrutura-tabelas.html#61-identificacao","title":"6.1. Identifica\u00e7\u00e3o","text":"Atributo Valor Nome da Tabela <code>temp_CGUSC.dbo.resultado_Sentinela_2015_2024</code> Fun\u00e7\u00e3o Consolidar todos os resultados e indicadores por farm\u00e1cia Criada por Script de p\u00f3s-processamento (Fase 4)"},{"location":"arquitetura/estrutura-tabelas.html#62-descricao","title":"6.2. Descri\u00e7\u00e3o","text":"<p>Esta \u00e9 a tabela final do projeto. Consolida todos os resultados da auditoria e os indicadores de risco em uma \u00fanica vis\u00e3o por farm\u00e1cia.</p>"},{"location":"arquitetura/estrutura-tabelas.html#63-campos-principais","title":"6.3. Campos Principais","text":"Categoria Campos Identifica\u00e7\u00e3o cnpj, razaoSocial, municipio, uf Resultados da Auditoria valor_vendas, valor_sem_comprovacao, qnt_vendas, qnt_vendas_sem_comprovacao Percentuais pct_irregularidade Contexto num_estabelecimentos_municipio, num_meses_movimentacao, populacao_municipio Indicadores Todos os 17 indicadores de risco"},{"location":"arquitetura/estrutura-tabelas.html#7-tabela-de-matriz-de-risco","title":"7. Tabela de Matriz de Risco","text":""},{"location":"arquitetura/estrutura-tabelas.html#71-identificacao","title":"7.1. Identifica\u00e7\u00e3o","text":"Atributo Valor Nome da Tabela <code>temp_CGUSC.dbo.Matriz_Risco_Final</code> Fun\u00e7\u00e3o Consolidar scores e rankings de risco Criada por Script de indicadores (matriz_risco_final.sql)"},{"location":"arquitetura/estrutura-tabelas.html#72-campos-principais","title":"7.2. Campos Principais","text":"Campo Descri\u00e7\u00e3o <code>cnpj</code> CNPJ da farm\u00e1cia <code>SCORE_RISCO_FINAL</code> Score consolidado (0 a 10+) <code>CLASSIFICACAO_RISCO</code> Categoria de risco (CR\u00cdTICO, ALTO, M\u00c9DIO, BAIXO, M\u00cdNIMO) <code>rank_nacional</code> Posi\u00e7\u00e3o no ranking nacional <code>rank_uf</code> Posi\u00e7\u00e3o no ranking estadual <code>rank_municipio</code> Posi\u00e7\u00e3o no ranking municipal <code>total_nacional</code> Total de farm\u00e1cias no pa\u00eds <code>total_uf</code> Total de farm\u00e1cias no estado <code>total_municipio</code> Total de farm\u00e1cias no munic\u00edpio <code>flag_qualidade_dados</code> Indicador de confiabilidade (ALTA, MEDIA, BAIXA) <p>Pr\u00f3ximo Passo</p> <p>Veja o Fluxo de Dados para entender como os dados fluem entre as tabelas.</p>"},{"location":"arquitetura/fase1-preparacao.html","title":"Fase 1: Prepara\u00e7\u00e3o dos Dados","text":"<p>A Fase 1 \u00e9 respons\u00e1vel por estruturar e limpar os dados brutos para processamento eficiente. Todo o trabalho desta fase \u00e9 realizado em SQL.</p>"},{"location":"arquitetura/fase1-preparacao.html#1-visao-geral","title":"1. Vis\u00e3o Geral","text":""},{"location":"arquitetura/fase1-preparacao.html#11-objetivo","title":"1.1. Objetivo","text":"<p>Preparar o ambiente de dados para que o script Python (Fase 2) possa processar cada estabelecimento de forma eficiente e isolada.</p>"},{"location":"arquitetura/fase1-preparacao.html#12-script-principal","title":"1.2. Script Principal","text":"<pre><code>\ud83d\udcc4 01 - preparacao_dados.sql\n</code></pre>"},{"location":"arquitetura/fase1-preparacao.html#13-etapas-da-fase-1","title":"1.3. Etapas da Fase 1","text":"flowchart TD     A[Etapa 1Defini\u00e7\u00e3o do Universo] --&gt; B[Etapa 2Particionamento em Lotes]     B --&gt; C[Etapa 3Consolida\u00e7\u00e3o Cadastral]     C --&gt; D[Etapa 4Cria\u00e7\u00e3o de Tabelas de Resultado]     D --&gt; E[Etapa 5Enriquecimento com S\u00f3cios]     E --&gt; F[Etapa 6Geocodifica\u00e7\u00e3o]     F --&gt; G[Etapa 7Atualiza\u00e7\u00e3o de Coordenadas]     G --&gt; H[Etapa 8C\u00e1lculo do Estoque Inicial]"},{"location":"arquitetura/fase1-preparacao.html#2-etapa-1-definicao-do-universo-de-analise","title":"2. Etapa 1: Defini\u00e7\u00e3o do Universo de An\u00e1lise","text":""},{"location":"arquitetura/fase1-preparacao.html#21-o-que-faz","title":"2.1. O que faz","text":"<p>Cria a tabela <code>temp_CGUSC.dbo.lista_cnpjs</code> contendo todos os CNPJs que ser\u00e3o analisados.</p>"},{"location":"arquitetura/fase1-preparacao.html#22-como-funciona","title":"2.2. Como funciona","text":"<ol> <li>Consulta a tabela principal de vendas do Farm\u00e1cia Popular</li> <li>Extrai os CNPJs \u00fanicos (<code>SELECT DISTINCT cnpj</code>)</li> <li>Filtra apenas as movimenta\u00e7\u00f5es dentro do per\u00edodo de an\u00e1lise</li> <li>Salva na tabela <code>lista_cnpjs</code></li> </ol>"},{"location":"arquitetura/fase1-preparacao.html#23-parametros-de-filtro","title":"2.3. Par\u00e2metros de Filtro","text":"Par\u00e2metro Valor Padr\u00e3o Descri\u00e7\u00e3o Data Inicial 2015-07-01 In\u00edcio do per\u00edodo de an\u00e1lise Data Final 2024-12-10 Fim do per\u00edodo de an\u00e1lise"},{"location":"arquitetura/fase1-preparacao.html#24-importancia","title":"2.4. Import\u00e2ncia","text":"<p>Por que isso importa</p> <p>Este passo define o escopo total da auditoria. Apenas as farm\u00e1cias presentes nesta lista ser\u00e3o processadas nas fases seguintes. \u00c9 o ponto de partida que delimita o universo de trabalho.</p>"},{"location":"arquitetura/fase1-preparacao.html#3-etapa-2-particionamento-para-processamento-em-lotes","title":"3. Etapa 2: Particionamento para Processamento em Lotes","text":""},{"location":"arquitetura/fase1-preparacao.html#31-o-que-faz","title":"3.1. O que faz","text":"<p>Cria a tabela <code>temp_CGUSC.dbo.classif</code> que divide o universo de CNPJs em 100 lotes de tamanho aproximadamente igual.</p>"},{"location":"arquitetura/fase1-preparacao.html#32-como-funciona","title":"3.2. Como funciona","text":"<p>Utiliza a fun\u00e7\u00e3o de janela <code>NTILE(100)</code> do SQL Server:</p> <ol> <li>Ordena todos os CNPJs alfabeticamente</li> <li>Distribui sequencialmente em 100 grupos</li> <li>Cada CNPJ recebe um n\u00famero de lote (1 a 100)</li> </ol>"},{"location":"arquitetura/fase1-preparacao.html#33-estrutura-da-tabela","title":"3.3. Estrutura da Tabela","text":"Campo Tipo Descri\u00e7\u00e3o <code>cnpj</code> VARCHAR(14) CNPJ da farm\u00e1cia <code>classif</code> INT N\u00famero do lote (1 a 100)"},{"location":"arquitetura/fase1-preparacao.html#34-importancia","title":"3.4. Import\u00e2ncia","text":"<p>Otimiza\u00e7\u00e3o Cr\u00edtica</p> <p>Esta \u00e9 uma otimiza\u00e7\u00e3o de performance cr\u00edtica. Processar centenas de milhares de CNPJs de uma s\u00f3 vez consumiria uma quantidade massiva de mem\u00f3ria e poderia levar a falhas ou timeouts.</p> <pre><code>Ao dividir o trabalho em 100 lotes, o script Python pode processar um lote de cada vez, tornando o processo:\n\n- \u2705 Mais est\u00e1vel\n- \u2705 Mais gerenci\u00e1vel\n- \u2705 Pass\u00edvel de interrup\u00e7\u00e3o e retomada\n</code></pre>"},{"location":"arquitetura/fase1-preparacao.html#4-etapa-3-consolidacao-de-dados-cadastrais-e-de-contato","title":"4. Etapa 3: Consolida\u00e7\u00e3o de Dados Cadastrais e de Contato","text":""},{"location":"arquitetura/fase1-preparacao.html#41-mapeamento-da-primeira-venda","title":"4.1. Mapeamento da Primeira Venda","text":""},{"location":"arquitetura/fase1-preparacao.html#411-o-que-faz","title":"4.1.1. O que faz","text":"<p>Cria a tabela <code>temp_CGUSC.dbo.farmaciasInicioVendas</code> com a data da primeira venda de cada farm\u00e1cia.</p>"},{"location":"arquitetura/fase1-preparacao.html#412-como-funciona","title":"4.1.2. Como funciona","text":"<p>Utiliza <code>MIN(data_hora)</code> agrupado por CNPJ para encontrar a transa\u00e7\u00e3o mais antiga de cada estabelecimento.</p>"},{"location":"arquitetura/fase1-preparacao.html#413-importancia","title":"4.1.3. Import\u00e2ncia","text":"<p>Esta data serve como marco temporal importante, indicando o in\u00edcio das atividades da farm\u00e1cia dentro do programa.</p>"},{"location":"arquitetura/fase1-preparacao.html#42-consolidacao-dos-contatos","title":"4.2. Consolida\u00e7\u00e3o dos Contatos","text":""},{"location":"arquitetura/fase1-preparacao.html#421-o-que-faz","title":"4.2.1. O que faz","text":"<p>Gera a tabela <code>temp_CGUSC.dbo.contatoFarmacia</code> com dados de contato limpos e deduplicados.</p>"},{"location":"arquitetura/fase1-preparacao.html#422-como-funciona","title":"4.2.2. Como funciona","text":"<p>O script realiza uma opera\u00e7\u00e3o sofisticada de consolida\u00e7\u00e3o:</p> <ol> <li>Uni\u00e3o de Fontes: Combina dados de contato de m\u00faltiplas tabelas usando <code>UNION ALL</code></li> <li>Prioriza\u00e7\u00e3o: Usa <code>ROW_NUMBER()</code> para numerar registros, priorizando fontes mais recentes</li> <li>Deduplica\u00e7\u00e3o: Seleciona apenas o registro de maior prioridade para cada CNPJ</li> <li>Tratamento de Nulos: Usa <code>COALESCE</code> para substituir valores nulos</li> </ol>"},{"location":"arquitetura/fase1-preparacao.html#423-importancia","title":"4.2.3. Import\u00e2ncia","text":"<p>Garante que os relat\u00f3rios e poss\u00edveis comunica\u00e7\u00f5es utilizem as informa\u00e7\u00f5es de contato mais atualizadas e relevantes.</p>"},{"location":"arquitetura/fase1-preparacao.html#5-etapa-4-criacao-da-estrutura-de-tabelas-de-resultados","title":"5. Etapa 4: Cria\u00e7\u00e3o da Estrutura de Tabelas de Resultados","text":""},{"location":"arquitetura/fase1-preparacao.html#51-o-que-faz","title":"5.1. O que faz","text":"<p>Cria as tabelas que receber\u00e3o os resultados do processamento:</p> <ul> <li><code>processamentosFP</code></li> <li><code>dadosProcessamentosFP</code></li> <li><code>movimentacaoMensalCodigoBarraFP</code></li> </ul>"},{"location":"arquitetura/fase1-preparacao.html#52-como-funciona","title":"5.2. Como funciona","text":"<p>Utiliza comandos <code>CREATE TABLE</code> para definir:</p> <ul> <li>Estrutura de colunas e tipos de dados</li> <li>Chaves prim\u00e1rias e relacionamentos (FOREIGN KEY)</li> <li>\u00cdndices para otimiza\u00e7\u00e3o</li> </ul>"},{"location":"arquitetura/fase1-preparacao.html#53-importancia","title":"5.3. Import\u00e2ncia","text":"<p>Tabelas Vazias</p> <p>Neste momento, as tabelas s\u00e3o criadas vazias. Elas servem como o \"esqueleto\" que ser\u00e1 preenchido com os resultados detalhados gerados pelo script Python na Fase 2.</p> <pre><code>Definir a estrutura antecipadamente garante a **integridade dos dados** que ser\u00e3o inseridos posteriormente.\n</code></pre>"},{"location":"arquitetura/fase1-preparacao.html#6-etapa-5-enriquecimento-com-dados-de-socios-e-perfis","title":"6. Etapa 5: Enriquecimento com Dados de S\u00f3cios e Perfis","text":""},{"location":"arquitetura/fase1-preparacao.html#61-perfil-dos-socios-tb_sociosfp","title":"6.1. Perfil dos S\u00f3cios (tb_sociosFP)","text":""},{"location":"arquitetura/fase1-preparacao.html#611-o-que-faz","title":"6.1.1. O que faz","text":"<p>Cria um perfil detalhado dos s\u00f3cios de cada farm\u00e1cia.</p>"},{"location":"arquitetura/fase1-preparacao.html#612-como-funciona","title":"6.1.2. Como funciona","text":"<ol> <li>Cruza a <code>lista_cnpjs</code> com as bases da Receita Federal</li> <li>Busca dados de s\u00f3cios na tabela <code>db_CNPJ.dbo.socios</code></li> <li>Filtra apenas s\u00f3cios ativos e com participa\u00e7\u00e3o societ\u00e1ria</li> <li>Inclui apenas empresas com situa\u00e7\u00e3o cadastral ativa</li> </ol>"},{"location":"arquitetura/fase1-preparacao.html#613-filtros-aplicados","title":"6.1.3. Filtros Aplicados","text":"Filtro Condi\u00e7\u00e3o Motivo S\u00f3cio Ativo <code>dataExclusaoSociedade IS NULL</code> Excluir s\u00f3cios que sa\u00edram da sociedade Participa\u00e7\u00e3o <code>percentualQualificacao &gt; 0</code> Apenas s\u00f3cios com participa\u00e7\u00e3o efetiva Empresa Ativa <code>SituacaoCadastral = 2</code> Apenas empresas ativas na Receita"},{"location":"arquitetura/fase1-preparacao.html#614-importancia","title":"6.1.4. Import\u00e2ncia","text":"<p>Uso em Investiga\u00e7\u00f5es</p> <p>Esta tabela \u00e9 fundamental para identificar s\u00f3cios em comum entre farm\u00e1cias com comportamento suspeito, o que pode indicar a exist\u00eancia de redes ou fraudes organizadas.</p>"},{"location":"arquitetura/fase1-preparacao.html#62-perfil-da-farmacia-dadosfarmaciasfp","title":"6.2. Perfil da Farm\u00e1cia (dadosFarmaciasFP)","text":""},{"location":"arquitetura/fase1-preparacao.html#621-o-que-faz","title":"6.2.1. O que faz","text":"<p>Consolida todas as informa\u00e7\u00f5es cadastrais em uma \u00fanica tabela.</p>"},{"location":"arquitetura/fase1-preparacao.html#622-como-funciona","title":"6.2.2. Como funciona","text":"<p>O processo utiliza tabelas tempor\u00e1rias para construir gradualmente o perfil:</p> <ol> <li>Une dados de endere\u00e7o</li> <li>Adiciona natureza jur\u00eddica e situa\u00e7\u00e3o cadastral</li> <li>Inclui dados do respons\u00e1vel pela empresa</li> <li>Calcula o campo <code>outrasSociedades</code></li> </ol>"},{"location":"arquitetura/fase1-preparacao.html#623-campo-outrassociedades","title":"6.2.3. Campo outrasSociedades","text":"<p>Este campo \u00e9 calculado atrav\u00e9s de uma subconsulta complexa que verifica:</p> <ul> <li>Se algum dos s\u00f3cios da farm\u00e1cia em quest\u00e3o</li> <li>Possui participa\u00e7\u00e3o em outras farm\u00e1cias da <code>lista_cnpjs</code></li> </ul>"},{"location":"arquitetura/fase1-preparacao.html#624-importancia","title":"6.2.4. Import\u00e2ncia","text":"<p>Cria uma fonte de verdade \u00fanica e abrangente para os dados cadastrais, que ser\u00e1 usada extensivamente nos relat\u00f3rios e na tabela de an\u00e1lise final.</p>"},{"location":"arquitetura/fase1-preparacao.html#7-etapa-6-preparacao-para-geocodificacao","title":"7. Etapa 6: Prepara\u00e7\u00e3o para Geocodifica\u00e7\u00e3o","text":""},{"location":"arquitetura/fase1-preparacao.html#71-o-que-faz","title":"7.1. O que faz","text":"<p>Gera uma consulta que formata os endere\u00e7os das farm\u00e1cias para geocodifica\u00e7\u00e3o externa.</p>"},{"location":"arquitetura/fase1-preparacao.html#72-como-funciona","title":"7.2. Como funciona","text":"<ol> <li>Concatena os campos de endere\u00e7o em uma \u00fanica string</li> <li>Formata: logradouro, n\u00famero, bairro, munic\u00edpio, UF</li> <li>Resultado \u00e9 exportado para Excel</li> </ol>"},{"location":"arquitetura/fase1-preparacao.html#73-processo-externo","title":"7.3. Processo Externo","text":"<p>Etapa Manual</p> <p>O resultado desta consulta \u00e9 usado como entrada para um script externo (<code>Coordenadas.py</code>) que obt\u00e9m as coordenadas geogr\u00e1ficas de cada endere\u00e7o atrav\u00e9s de APIs de geocodifica\u00e7\u00e3o.</p>"},{"location":"arquitetura/fase1-preparacao.html#8-etapa-7-atualizacao-das-coordenadas-geograficas","title":"8. Etapa 7: Atualiza\u00e7\u00e3o das Coordenadas Geogr\u00e1ficas","text":""},{"location":"arquitetura/fase1-preparacao.html#81-o-que-faz","title":"8.1. O que faz","text":"<p>Atualiza a tabela <code>dadosFarmaciasFP</code> com os dados de latitude e longitude obtidos no processo de geocodifica\u00e7\u00e3o.</p>"},{"location":"arquitetura/fase1-preparacao.html#82-importancia","title":"8.2. Import\u00e2ncia","text":"<p>Permite an\u00e1lises espaciais, como:</p> <ul> <li>Visualiza\u00e7\u00e3o de farm\u00e1cias em mapas</li> <li>C\u00e1lculo de dist\u00e2ncia entre estabelecimentos</li> <li>Cruzamento com dados socioecon\u00f4micos georreferenciados</li> <li>Detec\u00e7\u00e3o de anomalias geogr\u00e1ficas (pacientes distantes)</li> </ul>"},{"location":"arquitetura/fase1-preparacao.html#9-etapa-8-calculo-do-estoque-inicial","title":"9. Etapa 8: C\u00e1lculo do Estoque Inicial","text":"<p>Esta \u00e9 a etapa mais complexa e metodologicamente mais importante de todo o script de prepara\u00e7\u00e3o. A precis\u00e3o da auditoria depende diretamente da qualidade desta estimativa.</p>"},{"location":"arquitetura/fase1-preparacao.html#91-o-que-faz","title":"9.1. O que faz","text":"<p>Estima o estoque inicial para cada medicamento em cada farm\u00e1cia.</p>"},{"location":"arquitetura/fase1-preparacao.html#92-por-que-e-necessario","title":"9.2. Por que \u00e9 necess\u00e1rio","text":"<p>Problema</p> <p>Sem uma estimativa de estoque inicial, as primeiras vendas de qualquer farm\u00e1cia seriam incorretamente sinalizadas como \"sem comprova\u00e7\u00e3o\", gerando muitos falsos positivos.</p>"},{"location":"arquitetura/fase1-preparacao.html#93-metodologia-passo-a-passo","title":"9.3. Metodologia: Passo a Passo","text":"<p>O c\u00e1lculo \u00e9 feito atrav\u00e9s de uma sequ\u00eancia de tabelas:</p>"},{"location":"arquitetura/fase1-preparacao.html#passo-1-farmacia_inicio_venda_gtin","title":"Passo 1: farmacia_inicio_venda_gtin","text":"<p>Identifica a data da primeira venda de cada produto (GTIN) em cada farm\u00e1cia.</p> <pre><code>Para cada combina\u00e7\u00e3o (CNPJ, GTIN):\n    \u2192 Encontra MIN(data_venda)\n</code></pre>"},{"location":"arquitetura/fase1-preparacao.html#passo-2-definicao-da-janela-de-busca","title":"Passo 2: Defini\u00e7\u00e3o da Janela de Busca","text":"<p>Com base na data encontrada, define uma janela de busca de 6 meses para tr\u00e1s:</p> <pre><code>Janela = [data_primeira_venda - 6 meses, data_primeira_venda]\n</code></pre>"},{"location":"arquitetura/fase1-preparacao.html#passo-3-busca-de-notas-fiscais","title":"Passo 3: Busca de Notas Fiscais","text":"<p>Procura todas as notas fiscais de aquisi\u00e7\u00e3o (tipoOperacao = 1) dentro da janela de 6 meses.</p>"},{"location":"arquitetura/fase1-preparacao.html#passo-4-ordenacao-das-notas","title":"Passo 4: Ordena\u00e7\u00e3o das Notas","text":"<p>As notas encontradas s\u00e3o classificadas da mais recente para a mais antiga usando <code>ROW_NUMBER()</code>:</p> <pre><code>ROW_NUMBER() OVER (\n    PARTITION BY cnpj, codigo_barra\n    ORDER BY data_aquisicao DESC\n)\n</code></pre>"},{"location":"arquitetura/fase1-preparacao.html#passo-5-calculo-do-estoque-inicial","title":"Passo 5: C\u00e1lculo do Estoque Inicial","text":"<p>O estoque inicial \u00e9 calculado como a soma das duas notas fiscais mais recentes:</p> \\[ \\text{Estoque Inicial} = \\sum_{i=1}^{2} \\text{Quantidade}_i \\quad \\text{onde } i \\text{ s\u00e3o as 2 NFs mais recentes} \\] <pre><code>WHERE row_num &lt; 3  -- Apenas as 2 primeiras\n</code></pre>"},{"location":"arquitetura/fase1-preparacao.html#passo-6-rastreabilidade","title":"Passo 6: Rastreabilidade","text":"<p>As notas fiscais exatas que foram usadas s\u00e3o salvas na tabela <code>notas_estoque_inicialFP</code> para total transpar\u00eancia.</p>"},{"location":"arquitetura/fase1-preparacao.html#94-criterio-oficial","title":"9.4. Crit\u00e9rio Oficial","text":"<p>Crit\u00e9rio de Estoque Inicial</p> <p>\"Soma das duas \u00faltimas aquisi\u00e7\u00f5es, considerando os 6 meses anteriores \u00e0 primeira venda.\"</p>"},{"location":"arquitetura/fase1-preparacao.html#95-justificativa-do-criterio","title":"9.5. Justificativa do Crit\u00e9rio","text":"Aspecto Justificativa Por que 2 NFs? Evita distor\u00e7\u00f5es de uma \u00fanica compra at\u00edpica; m\u00e9dia ponderada impl\u00edcita Por que 6 meses? Per\u00edodo razo\u00e1vel para farm\u00e1cia ter estoque; evita dados muito antigos Por que as mais recentes? Refletem melhor o estoque no momento da primeira venda"},{"location":"arquitetura/fase1-preparacao.html#96-tabelas-geradas","title":"9.6. Tabelas Geradas","text":"Tabela Conte\u00fado <code>farmacia_inicio_venda_gtin</code> Data da primeira venda por produto/farm\u00e1cia <code>estoque_inicialFP</code> Valor estimado do estoque inicial <code>notas_estoque_inicialFP</code> NFs usadas no c\u00e1lculo (rastreabilidade)"},{"location":"arquitetura/fase1-preparacao.html#97-importancia","title":"9.7. Import\u00e2ncia","text":"<p>Resultado</p> <p>Este m\u00e9todo cria uma linha de base justa e defens\u00e1vel, baseada no pr\u00f3prio hist\u00f3rico de compras da farm\u00e1cia, para iniciar a an\u00e1lise de fluxo de estoque.</p> <pre><code>A grava\u00e7\u00e3o das notas utilizadas garante a **rastreabilidade e auditabilidade** da pr\u00f3pria metodologia.\n</code></pre>"},{"location":"arquitetura/fase1-preparacao.html#10-parametros-que-devem-ser-ajustados","title":"10. Par\u00e2metros que Devem Ser Ajustados","text":"<p>Antes de executar o script de prepara\u00e7\u00e3o, ajuste os seguintes par\u00e2metros:</p> Linha Par\u00e2metro Descri\u00e7\u00e3o 9 <code>data_hora BETWEEN '2015-07-01' AND '2024-12-10'</code> Per\u00edodo para sele\u00e7\u00e3o de CNPJs 41 <code>data_hora BETWEEN '2015-07-01' AND '2024-12-10'</code> Per\u00edodo para primeira venda 288 <code>a.data_hora &gt;= '2015-07-01' and a.data_hora &lt;= '2024-12-10'</code> Per\u00edodo para estoque inicial <p>Pr\u00f3ximo Passo</p> <p>Veja a Fase 2: Processamento para entender como o Python executa a simula\u00e7\u00e3o de fluxo de estoque.</p>"},{"location":"arquitetura/fase2-processamento.html","title":"Fase 2: Processamento dos Dados","text":"<p>Nesta fase, os dados brutos, j\u00e1 limpos e estruturados pela Fase 1, s\u00e3o ativamente processados para identificar inconsist\u00eancias. O trabalho \u00e9 dividido entre SQL (prepara\u00e7\u00e3o do lote) e Python (l\u00f3gica de auditoria).</p>"},{"location":"arquitetura/fase2-processamento.html#1-visao-geral","title":"1. Vis\u00e3o Geral","text":""},{"location":"arquitetura/fase2-processamento.html#11-objetivo","title":"1.1. Objetivo","text":"<p>Executar a simula\u00e7\u00e3o de fluxo de estoque para cada farm\u00e1cia e identificar vendas sem comprova\u00e7\u00e3o de lastro em aquisi\u00e7\u00f5es.</p>"},{"location":"arquitetura/fase2-processamento.html#12-scripts-envolvidos","title":"1.2. Scripts Envolvidos","text":"Script Tipo Fun\u00e7\u00e3o <code>03 - procPreparaDados.sql</code> Stored Procedure Prepara o ambiente para cada lote <code>sentinelav8.py</code> Python Executa a l\u00f3gica de auditoria"},{"location":"arquitetura/fase2-processamento.html#13-diagrama-de-fluxo","title":"1.3. Diagrama de Fluxo","text":"flowchart TD     subgraph Loop[\"\ud83d\udd04 Loop por Lote (1-100)\"]         A[Chama procPreparaDados] --&gt; B[Cria tabela movimentacaoFPcom dados do lote]         B --&gt; C[Cria \u00edndices para performance]         C --&gt; D[Loop por CNPJ do lote]     end      subgraph CNPJ[\"\ud83c\udfe2 Para cada CNPJ\"]         D --&gt; E[Inicia processamentostatus = RUNNING]         E --&gt; F[Executa Query UnificadaVendas + Aquisi\u00e7\u00f5es]         F --&gt; G[Simula\u00e7\u00e3o de Fluxode Estoque]         G --&gt; H{Irregularidade?}         H --&gt;|Sim| I[Quantifica valores]         H --&gt;|N\u00e3o| J[Registra OK]         I --&gt; K[Salva mem\u00f3ria de c\u00e1lculo]         J --&gt; K         K --&gt; L[Grava movimenta\u00e7\u00e3o mensal]         L --&gt; M[Atualiza statusSUCCESS/NO_ISSUES]     end      M --&gt; N{Mais CNPJs?}     N --&gt;|Sim| D     N --&gt;|N\u00e3o| O{Mais Lotes?}     O --&gt;|Sim| A     O --&gt;|N\u00e3o| P[FIM]"},{"location":"arquitetura/fase2-processamento.html#2-parte-1-stored-procedure-procpreparadados","title":"2. Parte 1: Stored Procedure procPreparaDados","text":""},{"location":"arquitetura/fase2-processamento.html#21-papel-e-proposito","title":"2.1. Papel e Prop\u00f3sito","text":"<p>A Stored Procedure <code>procPreparaDados</code> atua como um \"preparador de ambiente\". Sua \u00fanica fun\u00e7\u00e3o \u00e9 criar um ambiente de dados pequeno, focado e otimizado para um lote espec\u00edfico de CNPJs.</p>"},{"location":"arquitetura/fase2-processamento.html#22-beneficios","title":"2.2. Benef\u00edcios","text":"Benef\u00edcio Descri\u00e7\u00e3o Foco Isola os dados de um \u00fanico lote para evitar consultas em tabelas massivas Performance Delega o trabalho pesado de filtragem ao banco de dados Recupera\u00e7\u00e3o Garante retomada limpa ap\u00f3s falhas"},{"location":"arquitetura/fase2-processamento.html#23-parametros","title":"2.3. Par\u00e2metros","text":"Par\u00e2metro Dire\u00e7\u00e3o Tipo Descri\u00e7\u00e3o <code>@classif</code> Entrada INT N\u00famero do lote a ser preparado (1-100) <code>@rowcount</code> Sa\u00edda INT N\u00famero de linhas inseridas na tabela de trabalho"},{"location":"arquitetura/fase2-processamento.html#24-logica-interna","title":"2.4. L\u00f3gica Interna","text":""},{"location":"arquitetura/fase2-processamento.html#241-limpeza-de-execucao-incompleta","title":"2.4.1. Limpeza de Execu\u00e7\u00e3o Incompleta","text":"<p>A procedure primeiro executa uma limpeza precisa e direcionada:</p> <ol> <li>Identifica o <code>id</code> do processamento mais recente</li> <li>Apaga registros \"filhos\" em cascata (<code>movimentacaoMensalCodigoBarraFP</code>)</li> <li>Apaga o registro \"pai\" (<code>processamentosFP</code>)</li> </ol> <p>Mecanismo de Recupera\u00e7\u00e3o</p> <p>Este mecanismo parte do princ\u00edpio de que se o script parou de forma inesperada, a \u00faltima entrada na tabela <code>processamentosFP</code> pode representar um CNPJ cujo processamento foi interrompido, deixando dados parciais e inconsistentes.</p> <pre><code>A limpeza garante que, antes de iniciar um novo bloco, os dados da \u00faltima tentativa sejam completamente removidos.\n</code></pre>"},{"location":"arquitetura/fase2-processamento.html#242-recriacao-da-tabela-de-classificacao","title":"2.4.2. Recria\u00e7\u00e3o da Tabela de Classifica\u00e7\u00e3o","text":"<p>A tabela <code>classif</code> \u00e9 recriada com um filtro importante:</p> <pre><code>WHERE cnpj NOT IN (SELECT cnpj FROM processamentosFP)\n</code></pre> <p>Funcionalidade de Retomada</p> <p>Esta l\u00f3gica recalcula os lotes usando apenas os CNPJs que ainda n\u00e3o foram processados. Se o script parar no lote 25, ao ser reiniciado, ele n\u00e3o refar\u00e1 os lotes 1 a 24 - ir\u00e1 direto para os CNPJs pendentes.</p>"},{"location":"arquitetura/fase2-processamento.html#243-criacao-do-workspace-movimentacaofp","title":"2.4.3. Cria\u00e7\u00e3o do Workspace (movimentacaoFP)","text":"<ol> <li>A tabela de trabalho <code>movimentacaoFP</code> \u00e9 recriada do zero</li> <li>\u00c9 populada apenas com transa\u00e7\u00f5es do lote atual</li> <li>\u00cdndices s\u00e3o criados nas colunas mais usadas</li> </ol> <p>Otimiza\u00e7\u00e3o Principal</p> <p>Em vez do Python fazer consultas em uma tabela com bilh\u00f5es de registros, ele faz consultas em uma tabela menor que cont\u00e9m apenas os dados relevantes para o lote atual.</p>"},{"location":"arquitetura/fase2-processamento.html#244-indexacao-dinamica","title":"2.4.4. Indexa\u00e7\u00e3o Din\u00e2mica","text":"<p>Ap\u00f3s popular a tabela, \u00edndices s\u00e3o criados nas colunas:</p> <ul> <li><code>codigo_barra</code></li> <li><code>cnpj</code></li> <li><code>data_hora</code></li> </ul> <p>\u00cdndices aceleram drasticamente as consultas subsequentes.</p>"},{"location":"arquitetura/fase2-processamento.html#3-parte-2-script-python-sentinelav8py","title":"3. Parte 2: Script Python (sentinelav8.py)","text":""},{"location":"arquitetura/fase2-processamento.html#31-papel-e-proposito","title":"3.1. Papel e Prop\u00f3sito","text":"<p>Com o ambiente preparado pela Stored Procedure, o script Python assume a l\u00f3gica de auditoria detalhada, CNPJ por CNPJ.</p> Responsabilidade Descri\u00e7\u00e3o Orquestra\u00e7\u00e3o Controla o fluxo geral, iterando sobre lotes e CNPJs L\u00f3gica de Neg\u00f3cio Aplica a simula\u00e7\u00e3o de fluxo de estoque linha a linha Persist\u00eancia Salva os resultados detalhados no banco Relat\u00f3rios Dispara a gera\u00e7\u00e3o dos arquivos Excel"},{"location":"arquitetura/fase2-processamento.html#32-inicializacao-e-cache-em-memoria","title":"3.2. Inicializa\u00e7\u00e3o e Cache em Mem\u00f3ria","text":"<p>Antes do loop principal, o script carrega tabelas de apoio em dicion\u00e1rios Python:</p> <ul> <li><code>dados_farmacias</code> - Cadastro das farm\u00e1cias</li> <li><code>dados_medicamentos</code> - Dicion\u00e1rio de medicamentos</li> <li><code>contato_farmacia</code> - Informa\u00e7\u00f5es de contato</li> <li><code>farmacia_inicio_venda</code> - Data de in\u00edcio de cada farm\u00e1cia</li> <li><code>tabela_codigo_barra_estoque_inicial</code> - Estoque inicial por produto</li> </ul> <p>Cache Local</p> <p>Ter esses dados em mem\u00f3ria evita milhares de pequenas consultas repetitivas ao banco, acelerando enormemente o processo.</p>"},{"location":"arquitetura/fase2-processamento.html#33-loop-externo-iteracao-por-bloco","title":"3.3. Loop Externo: Itera\u00e7\u00e3o por Bloco","text":"<p>O script itera sobre cada um dos 100 lotes:</p> <pre><code>for i in tqdm(classif_list, desc=\"Progresso Geral:\"):\n    # 1. Chama procPreparaDados para o lote i\n    # 2. Obt\u00e9m lista de CNPJs do lote\n    # 3. Processa cada CNPJ\n</code></pre> <p>A biblioteca <code>tqdm</code> exibe uma barra de progresso no terminal.</p>"},{"location":"arquitetura/fase2-processamento.html#34-loop-interno-iteracao-por-cnpj","title":"3.4. Loop Interno: Itera\u00e7\u00e3o por CNPJ","text":"<p>Para cada CNPJ do lote:</p> <pre><code>for cnpj in tqdm(lista_cnpjs, desc=f\"Bloco {i}:\"):\n    # 1. Verifica se j\u00e1 foi processado\n    # 2. Inicia registro com status RUNNING\n    # 3. Executa query unificada\n    # 4. Simula fluxo de estoque\n    # 5. Salva resultados\n    # 6. Finaliza com status SUCCESS\n</code></pre>"},{"location":"arquitetura/fase2-processamento.html#35-verificacao-de-processamento-previo","title":"3.5. Verifica\u00e7\u00e3o de Processamento Pr\u00e9vio","text":"<p>Antes de processar, o sistema verifica se o CNPJ j\u00e1 foi processado com sucesso:</p> <pre><code>if verificar_processamento_existente(cursor, cnpj):\n    continue  # Pula para o pr\u00f3ximo\n</code></pre> <p>Isso permite retomada eficiente em caso de interrup\u00e7\u00e3o.</p>"},{"location":"arquitetura/fase2-processamento.html#4-a-query-unificada","title":"4. A Query Unificada","text":""},{"location":"arquitetura/fase2-processamento.html#41-o-que-e","title":"4.1. O que \u00e9","text":"<p>Uma consulta SQL complexa que cria uma \"linha do tempo\" de todas as movimenta\u00e7\u00f5es de estoque de um CNPJ.</p>"},{"location":"arquitetura/fase2-processamento.html#42-estrutura","title":"4.2. Estrutura","text":"<p>A query combina dois conjuntos de dados usando <code>UNION ALL</code>:</p> Parte Fonte Tipo Descri\u00e7\u00e3o 1 movimentacaoFP 'V' (Venda) Vendas do Sistema Autorizador 2 aquisicoesFazenda 'C' (Compra) Aquisi\u00e7\u00f5es por NF-e"},{"location":"arquitetura/fase2-processamento.html#43-campos-retornados","title":"4.3. Campos Retornados","text":"Campo Descri\u00e7\u00e3o <code>numeroNFE</code> N\u00famero da NF (apenas para compras) <code>valor_pago</code> Valor da transa\u00e7\u00e3o <code>codigoBarra</code> GTIN do medicamento <code>data_movimentacao</code> Data da transa\u00e7\u00e3o <code>qnt_caixas</code> Quantidade em caixas (normalizada) <code>compra_venda</code> 'V' para venda, 'C' para compra <code>tipo_operacao</code> 1=compra, 0=transfer\u00eancia, -1=devolu\u00e7\u00e3o"},{"location":"arquitetura/fase2-processamento.html#44-ordenacao-critica","title":"4.4. Ordena\u00e7\u00e3o Cr\u00edtica","text":"<pre><code>ORDER BY codigoBarra, data_movimentacao ASC, compra_venda ASC\n</code></pre> <p>Esta ordena\u00e7\u00e3o garante:</p> <ol> <li>Agrupamento por produto - Todas as transa\u00e7\u00f5es de um GTIN juntas</li> <li>Ordem cronol\u00f3gica - Mais antigo primeiro</li> <li>Compras antes de vendas - 'C' vem antes de 'V' no mesmo dia</li> </ol> <p>Por que a ordem importa</p> <p>Se uma compra e uma venda ocorrem no mesmo dia, a compra deve ser processada primeiro. Isso reflete a realidade: a farm\u00e1cia primeiro recebe a mercadoria e depois vende.</p>"},{"location":"arquitetura/fase2-processamento.html#5-simulacao-de-fluxo-de-estoque","title":"5. Simula\u00e7\u00e3o de Fluxo de Estoque","text":""},{"location":"arquitetura/fase2-processamento.html#51-conceito","title":"5.1. Conceito","text":"<p>O script simula o estoque como se fosse um contador que aumenta com compras e diminui com vendas.</p>"},{"location":"arquitetura/fase2-processamento.html#52-variaveis-de-estado","title":"5.2. Vari\u00e1veis de Estado","text":"<p>O sistema mant\u00e9m vari\u00e1veis que rastreiam o estado atual:</p> Vari\u00e1vel Descri\u00e7\u00e3o <code>codigo_barra</code> GTIN sendo processado <code>estoque_inicial</code> Estoque no in\u00edcio do per\u00edodo <code>estoque_final</code> Estoque atual (atualizado a cada transa\u00e7\u00e3o) <code>vendas_periodo</code> Total vendido no per\u00edodo <code>vendas_sem_comprovacao</code> Quantidade sem lastro <code>valor_movimentado</code> Valor total das vendas <code>valor_sem_comprovacao</code> Valor das vendas sem lastro"},{"location":"arquitetura/fase2-processamento.html#53-algoritmo-principal","title":"5.3. Algoritmo Principal","text":"<pre><code>Para cada transa\u00e7\u00e3o na linha do tempo:\n\n    Se mudou de medicamento (GTIN):\n        \u2192 Salva resultados do medicamento anterior\n        \u2192 Inicializa vari\u00e1veis para o novo medicamento\n        \u2192 Carrega estoque inicial do novo GTIN\n\n    Se \u00e9 VENDA (compra_venda == 'V'):\n        \u2192 Subtrai quantidade do estoque_final\n        \u2192 Se estoque_final &lt; 0:\n            \u2192 IRREGULARIDADE DETECTADA!\n            \u2192 Quantifica a diferen\u00e7a\n            \u2192 Zera o estoque (n\u00e3o pode ser negativo)\n        \u2192 Acumula valores e quantidades\n\n    Se \u00e9 COMPRA (compra_venda == 'C'):\n        \u2192 Soma quantidade ao estoque_final\n        \u2192 Registra a aquisi\u00e7\u00e3o para rastreabilidade\n</code></pre>"},{"location":"arquitetura/fase2-processamento.html#54-o-momento-da-deteccao","title":"5.4. O Momento da Detec\u00e7\u00e3o","text":"<p>Detec\u00e7\u00e3o de Irregularidade</p> <p>A irregularidade \u00e9 detectada no exato momento em que o estoque fica negativo:</p> <pre><code>```\nSe estoque_final &lt; 0:\n    quantidade_irregular = abs(estoque_final)\n    valor_irregular = quantidade_irregular \u00d7 valor_unitario\n    estoque_final = 0  # Zera o estoque\n```\n</code></pre>"},{"location":"arquitetura/fase2-processamento.html#55-exemplo-ilustrado","title":"5.5. Exemplo Ilustrado","text":"timeline     title Simula\u00e7\u00e3o de Fluxo de Estoque - GTIN 7891234567890      section In\u00edcio         01/07/2023 : Estoque Inicial = 50 \u2705      section Opera\u00e7\u00f5es         10/07/2023 : Venda de 20                    : Estoque = 50 - 20 = 30 \u2705         15/07/2023 : Compra de 40 (NF 123)                    : Estoque = 30 + 40 = 70 \u2705         20/07/2023 : Venda de 50                    : Estoque = 70 - 50 = 20 \u2705         25/07/2023 : Venda de 35                    : Estoque = 20 - 35 = -15 \u274c                    : IRREGULARIDADE: 15 unidades!                    : Estoque zerado"},{"location":"arquitetura/fase2-processamento.html#6-persistencia-dos-resultados","title":"6. Persist\u00eancia dos Resultados","text":""},{"location":"arquitetura/fase2-processamento.html#61-registro-de-processamento","title":"6.1. Registro de Processamento","text":"<p>Ao iniciar um CNPJ, um registro \u00e9 criado em <code>processamentosFP</code> com:</p> <ul> <li>Status <code>RUNNING</code> (2)</li> <li>Data/hora de in\u00edcio</li> <li>Dados cadastrais da farm\u00e1cia</li> </ul>"},{"location":"arquitetura/fase2-processamento.html#62-movimentacao-mensal","title":"6.2. Movimenta\u00e7\u00e3o Mensal","text":"<p>Para cada CNPJ processado, a movimenta\u00e7\u00e3o mensal \u00e9 salva:</p> <pre><code>for codigo_barra, periodos in tabela_codigo_barra_datas_vendas.items():\n    for periodo, valores in periodos.items():\n        if valores['qnt_vendas_mes'] &gt; 0:\n            INSERT INTO movimentacaoMensalCodigoBarraFP (...)\n</code></pre>"},{"location":"arquitetura/fase2-processamento.html#63-memoria-de-calculo","title":"6.3. Mem\u00f3ria de C\u00e1lculo","text":"<p>A mem\u00f3ria de c\u00e1lculo completa \u00e9:</p> <ol> <li>Serializada para JSON</li> <li>Comprimida com Zlib (n\u00edvel 9)</li> <li>Salva como VARBINARY na tabela <code>memoria_calculo_consolidadaFP</code></li> </ol> <p>Compress\u00e3o</p> <p>A compress\u00e3o Zlib reduz o tamanho em aproximadamente 90%, economizando espa\u00e7o significativo no banco de dados.</p>"},{"location":"arquitetura/fase2-processamento.html#64-finalizacao","title":"6.4. Finaliza\u00e7\u00e3o","text":"<p>Ao final do processamento, o registro \u00e9 atualizado com:</p> <ul> <li>Status final (<code>SUCCESS</code> ou <code>NO_ISSUES</code>)</li> <li>Tempo de processamento</li> <li>Total de registros e medicamentos processados</li> </ul>"},{"location":"arquitetura/fase2-processamento.html#7-tratamento-de-erros","title":"7. Tratamento de Erros","text":""},{"location":"arquitetura/fase2-processamento.html#71-estrategia-geral","title":"7.1. Estrat\u00e9gia Geral","text":"<p>O sistema implementa tratamento de erros robusto:</p> <pre><code>try:\n    # Processamento do CNPJ\nexcept Exception as e:\n    # Registra falha\n    finalizar_processamento_erro(cursor, conn, id_proc, cnpj, tempo, e)\n</code></pre>"},{"location":"arquitetura/fase2-processamento.html#72-recuperacao-automatica","title":"7.2. Recupera\u00e7\u00e3o Autom\u00e1tica","text":"<p>Processamentos interrompidos s\u00e3o marcados como <code>FAILED</code> (3) automaticamente na pr\u00f3xima execu\u00e7\u00e3o, permitindo reprocessamento.</p>"},{"location":"arquitetura/fase2-processamento.html#8-logs-e-monitoramento","title":"8. Logs e Monitoramento","text":""},{"location":"arquitetura/fase2-processamento.html#81-arquivo-de-log","title":"8.1. Arquivo de Log","text":"<p>O sistema gera logs detalhados em:</p> <pre><code>\ud83d\udcc4 sentinela_processamento.log\n</code></pre>"},{"location":"arquitetura/fase2-processamento.html#82-metricas-de-performance","title":"8.2. M\u00e9tricas de Performance","text":"<p>Para cada CNPJ, s\u00e3o registrados:</p> M\u00e9trica Descri\u00e7\u00e3o <code>t_query_main</code> Tempo da query principal <code>t_query_aux</code> Tempo das queries auxiliares <code>t_logic</code> Tempo do processamento l\u00f3gico <code>t_db_write</code> Tempo de grava\u00e7\u00e3o no banco <code>t_excel</code> Tempo de gera\u00e7\u00e3o do Excel"},{"location":"arquitetura/fase2-processamento.html#83-exemplo-de-log","title":"8.3. Exemplo de Log","text":"<pre><code>2025-01-15 10:30:15 - INFO - CNPJ 12345678000199 FINALIZADO. Tempo Total: 45.32s\n2025-01-15 10:30:15 - INFO -    &gt; Query Principal: 12.15s\n2025-01-15 10:30:15 - INFO -    &gt; Queries Auxiliares: 2.34s\n2025-01-15 10:30:15 - INFO -    &gt; Processamento L\u00f3gico: 8.76s\n2025-01-15 10:30:15 - INFO -    &gt; Grava\u00e7\u00e3o Banco (Resumo): 5.12s\n2025-01-15 10:30:15 - INFO -    &gt; Gera\u00e7\u00e3o Excel: 16.95s\n</code></pre> <p>Pr\u00f3ximo Passo</p> <p>Veja a Fase 3: Relat\u00f3rios para entender como os dossi\u00eas Excel s\u00e3o gerados.</p>"},{"location":"arquitetura/fase3-relatorios.html","title":"Fase 3: Gera\u00e7\u00e3o de Relat\u00f3rios","text":"<p>Ap\u00f3s o t\u00e9rmino da an\u00e1lise de um CNPJ na Fase 2, o sistema aciona a Fase 3 para gerar a documenta\u00e7\u00e3o de sa\u00edda. O objetivo n\u00e3o \u00e9 apenas apresentar dados, mas contar a hist\u00f3ria da movimenta\u00e7\u00e3o de estoque de cada medicamento, destacando as inconsist\u00eancias de forma inequ\u00edvoca.</p>"},{"location":"arquitetura/fase3-relatorios.html#1-visao-geral","title":"1. Vis\u00e3o Geral","text":""},{"location":"arquitetura/fase3-relatorios.html#11-objetivo","title":"1.1. Objetivo","text":"<p>Transformar os dados processados em dossi\u00eas de auditoria formatados em Excel, prontos para an\u00e1lise humana e a\u00e7\u00f5es de controle.</p>"},{"location":"arquitetura/fase3-relatorios.html#12-scripts-envolvidos","title":"1.2. Scripts Envolvidos","text":"Script Fun\u00e7\u00e3o <code>gerar_relatorio_memoriav8.py</code> Gera relat\u00f3rios a partir da mem\u00f3ria de c\u00e1lculo salva <code>aba_crm.py</code> M\u00f3dulo especializado para a aba de an\u00e1lise de prescritores"},{"location":"arquitetura/fase3-relatorios.html#13-modos-de-execucao","title":"1.3. Modos de Execu\u00e7\u00e3o","text":"<p>O sistema pode gerar relat\u00f3rios de duas formas:</p> Durante o ProcessamentoSob Demanda <p>O relat\u00f3rio \u00e9 gerado automaticamente ao final do processamento de cada CNPJ na Fase 2.</p> <p>O script pode ser executado independentemente para regenerar relat\u00f3rios:</p> <pre><code>python gerar_relatorio_memoriav8.py &lt;CNPJ&gt; [tipo]\n</code></pre> <p>Onde <code>tipo</code> pode ser:</p> <ul> <li><code>1</code> = Relat\u00f3rio Completo</li> <li><code>2</code> = Relat\u00f3rio Resumido</li> </ul>"},{"location":"arquitetura/fase3-relatorios.html#2-o-motor-de-relatorios","title":"2. O Motor de Relat\u00f3rios","text":""},{"location":"arquitetura/fase3-relatorios.html#21-funcao-principal-gerarrelatoriomovimentacao","title":"2.1. Fun\u00e7\u00e3o Principal: gerarRelatorioMovimentacao","text":"<p>Esta fun\u00e7\u00e3o \u00e9 o n\u00facleo da gera\u00e7\u00e3o de relat\u00f3rios. Ela orquestra a transforma\u00e7\u00e3o dos dados em planilhas Excel formatadas.</p>"},{"location":"arquitetura/fase3-relatorios.html#22-tecnologias-utilizadas","title":"2.2. Tecnologias Utilizadas","text":"Biblioteca Uso <code>pandas</code> Manipula\u00e7\u00e3o de dados tabulares <code>xlsxwriter</code> Cria\u00e7\u00e3o de planilhas Excel com formata\u00e7\u00e3o avan\u00e7ada <code>zlib</code> Descompress\u00e3o da mem\u00f3ria de c\u00e1lculo <code>json</code> Deserializa\u00e7\u00e3o dos dados"},{"location":"arquitetura/fase3-relatorios.html#23-fluxo-de-geracao","title":"2.3. Fluxo de Gera\u00e7\u00e3o","text":"flowchart TD     A[Recupera Mem\u00f3riade C\u00e1lculo] --&gt; B[DescomprimeZlib]     B --&gt; C[DeserializaJSON]     C --&gt; D[Carrega DadosAuxiliares]     D --&gt; E[Cria WorkbookExcel]     E --&gt; F[Gera AbaMovimenta\u00e7\u00e3o]     F --&gt; G[Gera AbaEvolu\u00e7\u00e3o Financeira]     G --&gt; H[Gera AbaIndicadores]     H --&gt; I[Gera AbaAn\u00e1lise CRMs]     I --&gt; J[Salva Arquivo.xlsx]"},{"location":"arquitetura/fase3-relatorios.html#3-tipos-de-relatorio","title":"3. Tipos de Relat\u00f3rio","text":""},{"location":"arquitetura/fase3-relatorios.html#31-relatorio-completo-tipo-1","title":"3.1. Relat\u00f3rio Completo (Tipo 1)","text":"<p>Cont\u00e9m todo o hist\u00f3rico transacional da farm\u00e1cia no per\u00edodo analisado.</p> Caracter\u00edstica Descri\u00e7\u00e3o Conte\u00fado Todas as movimenta\u00e7\u00f5es, com e sem irregularidades Tamanho Maior (pode ter milhares de linhas) Uso Auditorias fiscais completas, investiga\u00e7\u00f5es profundas P\u00fablico Auditores especializados"},{"location":"arquitetura/fase3-relatorios.html#32-relatorio-resumido-tipo-2","title":"3.2. Relat\u00f3rio Resumido (Tipo 2)","text":"<p>Cont\u00e9m apenas as irregularidades detectadas.</p> Caracter\u00edstica Descri\u00e7\u00e3o Conte\u00fado Apenas per\u00edodos com vendas sem comprova\u00e7\u00e3o Tamanho Menor, focado Uso Triagem r\u00e1pida, prioriza\u00e7\u00e3o de casos P\u00fablico Gestores, equipes de an\u00e1lise inicial"},{"location":"arquitetura/fase3-relatorios.html#4-aba-1-movimentacao-de-estoque","title":"4. Aba 1: Movimenta\u00e7\u00e3o de Estoque","text":"<p>Esta \u00e9 a aba anal\u00edtica principal, contendo a prova material da auditoria.</p>"},{"location":"arquitetura/fase3-relatorios.html#41-estrutura-do-conteudo","title":"4.1. Estrutura do Conte\u00fado","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  CABE\u00c7ALHO DA FARM\u00c1CIA                                      \u2502\n\u2502  Raz\u00e3o Social: FARM\u00c1CIA EXEMPLO LTDA                        \u2502\n\u2502  CNPJ: 12.345.678/0001-99                                   \u2502\n\u2502  Munic\u00edpio/UF: FLORIAN\u00d3POLIS/SC                             \u2502\n\u2502  Contato: (48) 3333-3333 | email@farmacia.com               \u2502\n\u2502  Per\u00edodo Analisado: 01/07/2015 a 10/12/2024                 \u2502\n\u2502  Crit\u00e9rio Estoque Inicial: Soma das 2 \u00faltimas aquisi\u00e7\u00f5es    \u2502\n\u2502  (6 meses anteriores)                                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  MEDICAMENTO: LOSARTANA POTASSICA 50MG (GTIN: 789123456)    \u2502\n\u2502  Estoque Inicial: 50 caixas                                 \u2502\n\u2502  NFs Base: NF 123 (20/06/2015) 30cx | NF 456 (25/06/2015)   \u2502\n\u2502  20cx                                                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Per\u00edodo  \u2502 Est.Ini \u2502 Vendas \u2502 Est.Fin \u2502 S/Comprov \u2502 Notas  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Jul/2015 \u2502    50   \u2502   45   \u2502    5    \u2502     0     \u2502        \u2502\n\u2502  Ago/2015 \u2502     5   \u2502   30   \u2502    0    \u2502    25     \u2502   \u26a0\ufe0f   \u2502\n\u2502  ...      \u2502   ...   \u2502  ...   \u2502   ...   \u2502   ...     \u2502  ...   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"arquitetura/fase3-relatorios.html#42-colunas-principais","title":"4.2. Colunas Principais","text":"Coluna Descri\u00e7\u00e3o Per\u00edodo Data da movimenta\u00e7\u00e3o (m\u00eas/ano ou data espec\u00edfica) Estoque Inicial Quantidade em estoque no in\u00edcio do per\u00edodo Vendas Per\u00edodo Quantidade vendida no per\u00edodo Aquisi\u00e7\u00f5es Quantidade comprada (entrada de estoque) Estoque Final Estoque recalculado ao final do per\u00edodo Vendas Sem Comprova\u00e7\u00e3o Quantidade vendida sem lastro (irregularidade) Valor Sem Comprova\u00e7\u00e3o Valor monet\u00e1rio da irregularidade Notas NFs de aquisi\u00e7\u00e3o que deram lastro ao estoque"},{"location":"arquitetura/fase3-relatorios.html#43-a-coluna-notas-rastreabilidade","title":"4.3. A Coluna \"Notas\" - Rastreabilidade","text":"<p>Diferencial T\u00e9cnico</p> <p>Esta coluna \u00e9 o diferencial t\u00e9cnico do relat\u00f3rio. O script varre o hist\u00f3rico para tr\u00e1s e lista, em cada venda, exatamente quais Notas Fiscais deram lastro para aquele estoque.</p> <pre><code>**Exemplo:** `NF Aquisi\u00e7\u00e3o: 12345 - 29/09/2021 | Qtde: 50`\n\nSe a venda n\u00e3o tiver lastro, esta coluna evidencia a **falha de cobertura**.\n</code></pre>"},{"location":"arquitetura/fase3-relatorios.html#44-destaque-visual","title":"4.4. Destaque Visual","text":"Situa\u00e7\u00e3o Formata\u00e7\u00e3o Per\u00edodo normal Fundo branco Cabe\u00e7alho do produto Fundo cinza Linha com irregularidade Fundo vermelho claro, texto em vermelho Totais Fundo azul escuro, texto branco"},{"location":"arquitetura/fase3-relatorios.html#45-secoes-da-aba","title":"4.5. Se\u00e7\u00f5es da Aba","text":"<p>Para cada medicamento (GTIN):</p> <ol> <li>Header do Produto - Nome, princ\u00edpio ativo, estoque inicial, NFs base</li> <li>T\u00edtulos das Colunas - Cabe\u00e7alho da tabela</li> <li>Linhas de Movimenta\u00e7\u00e3o - Uma linha por per\u00edodo de venda</li> <li>Sum\u00e1rio do Produto - Totais do medicamento</li> </ol> <p>Ao final:</p> <ol> <li>Total Geral - Soma de todos os medicamentos da farm\u00e1cia</li> </ol>"},{"location":"arquitetura/fase3-relatorios.html#5-aba-2-evolucao-financeira","title":"5. Aba 2: Evolu\u00e7\u00e3o Financeira","text":"<p>Focada na vis\u00e3o gerencial, permitindo identificar quando a fraude come\u00e7ou e sua intensidade ao longo do tempo.</p>"},{"location":"arquitetura/fase3-relatorios.html#51-estrutura","title":"5.1. Estrutura","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  RESUMO FINANCEIRO                                          \u2502\n\u2502  Total de Vendas: R$ 1.500.000,00                          \u2502\n\u2502  Total Irregular: R$ 450.000,00 (30%)                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  TABELA SEMESTRAL                                           \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510           \u2502\n\u2502  \u2502Semestre \u2502   Regular  \u2502  Irregular \u2502    %    \u2502           \u2502\n\u2502  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524           \u2502\n\u2502  \u2502 2015-S2 \u2502  R$ 50.000 \u2502  R$  5.000 \u2502  10,0%  \u2502           \u2502\n\u2502  \u2502 2016-S1 \u2502  R$ 80.000 \u2502  R$ 15.000 \u2502  18,8%  \u2502           \u2502\n\u2502  \u2502 ...     \u2502    ...     \u2502    ...     \u2502   ...   \u2502           \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  GR\u00c1FICOS                                                   \u2502\n\u2502  [Gr\u00e1fico de Barras Empilhadas]                            \u2502\n\u2502  [Gr\u00e1fico de \u00c1rea - Tend\u00eancia de Irregularidades]          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"arquitetura/fase3-relatorios.html#52-conteudo","title":"5.2. Conte\u00fado","text":""},{"location":"arquitetura/fase3-relatorios.html#521-tabela-semestral","title":"5.2.1. Tabela Semestral","text":"<p>Agrega o volume financeiro por semestre:</p> Coluna Descri\u00e7\u00e3o Semestre Per\u00edodo (ex: 2023-S1) Vendas Regulares Valor das vendas com lastro Vendas Irregulares Valor das vendas sem comprova\u00e7\u00e3o % Irregularidade Percentual de irregularidade no semestre"},{"location":"arquitetura/fase3-relatorios.html#522-cards-de-resumo","title":"5.2.2. Cards de Resumo","text":"Card Conte\u00fado Total Irregular Acumulado Soma de todas as irregularidades % M\u00e9dia de Irregularidade Percentual m\u00e9dio no per\u00edodo Tend\u00eancia Crescente, est\u00e1vel ou decrescente"},{"location":"arquitetura/fase3-relatorios.html#523-graficos","title":"5.2.3. Gr\u00e1ficos","text":"Gr\u00e1fico Tipo Finalidade Barras Empilhadas Comparativo Visualizar propor\u00e7\u00e3o regular \u00d7 irregular \u00c1rea Tend\u00eancia Destacar evolu\u00e7\u00e3o das irregularidades"},{"location":"arquitetura/fase3-relatorios.html#6-aba-3-indicadores-de-risco-fraude","title":"6. Aba 3: Indicadores de Risco &amp; Fraude","text":"<p>Esta aba contextualiza a farm\u00e1cia auditada em rela\u00e7\u00e3o ao mercado, utilizando a Matriz de Risco.</p>"},{"location":"arquitetura/fase3-relatorios.html#61-estrutura","title":"6.1. Estrutura","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  PAINEL DE SCORE                                            \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502  SCORE DE RISCO: 7.8        CLASSIFICA\u00c7\u00c3O: CR\u00cdTICO  \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  RANKINGS                                                   \u2502\n\u2502  Nacional: 234\u00ba de 34.000 (Top 1%)                         \u2502\n\u2502  Estadual: 12\u00ba de 850 (Top 2%)                             \u2502\n\u2502  Municipal: 3\u00ba de 45 (Top 7%)                              \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  CONTEXTO DEMOGR\u00c1FICO                                       \u2502\n\u2502  Munic\u00edpio: FLORIAN\u00d3POLIS/SC                               \u2502\n\u2502  Popula\u00e7\u00e3o: 508.826 habitantes                             \u2502\n\u2502  Farm\u00e1cias no Munic\u00edpio: 45                                \u2502\n\u2502  Habitantes por Farm\u00e1cia: 11.307                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  TABELA DE INDICADORES (17 m\u00e9tricas)                       \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502   Indicador    \u2502 Farm\u00e1cia\u2502 M\u00e9dia UF\u2502 M\u00e9dia BR\u2502 Risco\u2502   \u2502\n\u2502  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2524   \u2502\n\u2502  \u2502 % Falecidos    \u2502   2,5%  \u2502   0,1%  \u2502   0,1%  \u2502 ALTO \u2502   \u2502\n\u2502  \u2502 Ticket M\u00e9dio   \u2502  R$ 180 \u2502  R$ 85  \u2502  R$ 90  \u2502 ALTO \u2502   \u2502\n\u2502  \u2502 ...            \u2502   ...   \u2502   ...   \u2502   ...   \u2502 ...  \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  TOP 15 MAIORES RISCOS NO MUNIC\u00cdPIO                        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"arquitetura/fase3-relatorios.html#62-painel-de-score","title":"6.2. Painel de Score","text":"Elemento Descri\u00e7\u00e3o Score de Risco Nota de 0 a 10+ baseada nos indicadores Classifica\u00e7\u00e3o CR\u00cdTICO, ALTO, M\u00c9DIO, BAIXO ou M\u00cdNIMO Barra Visual Gradiente de cor indicando o n\u00edvel"},{"location":"arquitetura/fase3-relatorios.html#63-rankings-comparativos","title":"6.3. Rankings Comparativos","text":"N\u00edvel Descri\u00e7\u00e3o Nacional Posi\u00e7\u00e3o entre todas as farm\u00e1cias do Brasil Estadual Posi\u00e7\u00e3o entre farm\u00e1cias da mesma UF Municipal Posi\u00e7\u00e3o entre farm\u00e1cias do mesmo munic\u00edpio"},{"location":"arquitetura/fase3-relatorios.html#64-grupos-de-indicadores","title":"6.4. Grupos de Indicadores","text":"<p>Os 17 indicadores s\u00e3o organizados em 5 grupos:</p> Grupo Indicadores Elegibilidade &amp; Cl\u00ednica Falecidos, Incompatibilidade Cl\u00ednica Padr\u00f5es de Quantidade Teto M\u00e1ximo, Polimedicamentos, M\u00e9dia de Itens Padr\u00f5es Financeiros Ticket M\u00e9dio, Per Capita, Alto Custo, Receita/Paciente Automa\u00e7\u00e3o &amp; Geografia Vendas R\u00e1pidas, Madrugada, Pico, Geogr\u00e1fico, Pacientes \u00danicos Integridade M\u00e9dica HHI, Exclusividade CRM, Irregularidade CRM"},{"location":"arquitetura/fase3-relatorios.html#65-explicacoes-metodologicas","title":"6.5. Explica\u00e7\u00f5es Metodol\u00f3gicas","text":"<p>Detalhamento</p> <p>Para cada indicador, uma c\u00e9lula de coment\u00e1rio explica a metodologia de c\u00e1lculo e a interpreta\u00e7\u00e3o do resultado. Isso garante que o auditor entenda o significado de cada m\u00e9trica.</p>"},{"location":"arquitetura/fase3-relatorios.html#7-aba-4-analise-de-prescritores-crms","title":"7. Aba 4: An\u00e1lise de Prescritores (CRMs)","text":"<p>Gerada pelo m\u00f3dulo especializado <code>aba_crm.py</code>, esta se\u00e7\u00e3o foca na \"ponta da caneta\" - os m\u00e9dicos vinculados \u00e0s vendas.</p>"},{"location":"arquitetura/fase3-relatorios.html#71-cards-de-anomalia","title":"7.1. Cards de Anomalia","text":"<p>Painel visual no topo da aba que alerta para situa\u00e7\u00f5es cr\u00edticas:</p> Card M\u00e9trica Alerta Concentra\u00e7\u00e3o Top 1 % vendas do principal m\u00e9dico &gt;50% = Alto Concentra\u00e7\u00e3o Top 5 % vendas dos 5 maiores &gt;80% = Alto Prescritores Rob\u00f4 M\u00e9dicos com &gt;30 prescri\u00e7\u00f5es/dia Qualquer = Cr\u00edtico CRMs Inv\u00e1lidos M\u00e9dicos n\u00e3o encontrados no CFM Qualquer = Cr\u00edtico Alerta Geogr\u00e1fico Prescritores a &gt;400km Qualquer = M\u00e9dio"},{"location":"arquitetura/fase3-relatorios.html#72-tabela-de-indicadores-de-risco","title":"7.2. Tabela de Indicadores de Risco","text":"<p>Compara m\u00e9tricas de CRM da farm\u00e1cia com m\u00e9dias estaduais e nacionais:</p> Indicador Farm\u00e1cia M\u00e9dia UF M\u00e9dia BR Risco Concentra\u00e7\u00e3o Top 1 35% 15% 12% ALTO \u00cdndice HHI 2845 890 750 ALTO % CRMs Inv\u00e1lidos 5% 0.5% 0.3% CR\u00cdTICO"},{"location":"arquitetura/fase3-relatorios.html#73-tabela-de-crms-de-interesse","title":"7.3. Tabela de CRMs de Interesse","text":"<p>Lista os principais prescritores ordenados por risco/volume:</p> Coluna Descri\u00e7\u00e3o Rank Posi\u00e7\u00e3o por volume de vendas CRM N\u00famero do registro m\u00e9dico Nome do M\u00e9dico Nome completo UF do CRM Estado de registro Data 1\u00aa Prescri\u00e7\u00e3o Primeira vez que prescreveu para esta farm\u00e1cia Data Registro CFM Data de inscri\u00e7\u00e3o no conselho N\u00ba Prescri\u00e7\u00f5es Total de prescri\u00e7\u00f5es Valor (R$) Valor total movimentado % Participa\u00e7\u00e3o Percentual das vendas da farm\u00e1cia Prescri\u00e7\u00f5es/Dia Aqui M\u00e9dia di\u00e1ria nesta farm\u00e1cia Prescri\u00e7\u00f5es/Dia BR M\u00e9dia di\u00e1ria em todas farm\u00e1cias N\u00ba Farm\u00e1cias Em quantas farm\u00e1cias atua Alertas Flags de risco"},{"location":"arquitetura/fase3-relatorios.html#74-flags-de-alerta","title":"7.4. Flags de Alerta","text":"Flag Crit\u00e9rio Cor CRM Inv\u00e1lido N\u00e3o encontrado no CFM \ud83d\udd34 Vermelho &gt;30/dia Aqui &gt;30 prescri\u00e7\u00f5es/dia nesta farm\u00e1cia \ud83d\udd34 Magenta &gt;30/dia Rede &gt;30 prescri\u00e7\u00f5es/dia em todas farm\u00e1cias \ud83d\udfe3 Roxo Multi-Farm\u00e1cia Atua em &gt;20 estabelecimentos \ud83d\udfe3 Roxo Tempo Concentrado Todas prescri\u00e7\u00f5es em per\u00edodo muito curto \ud83d\udfe0 Laranja Alerta Geogr\u00e1fico Prescritor a &gt;400km da farm\u00e1cia \ud83d\udd35 Azul Prescri\u00e7\u00e3o Retroativa Prescri\u00e7\u00e3o antes do registro no CFM \ud83d\udd34 Vermelho"},{"location":"arquitetura/fase3-relatorios.html#75-secao-de-alertas-identificados","title":"7.5. Se\u00e7\u00e3o de Alertas Identificados","text":"<p>Ao final da aba, uma se\u00e7\u00e3o consolida e descreve os alertas encontrados com texto explicativo:</p> <pre><code>ALERTAS IDENTIFICADOS:\n\n\u26a0\ufe0f CRM INV\u00c1LIDO: O m\u00e9dico CRM 123456/SP n\u00e3o foi localizado na base\n   do Conselho Federal de Medicina. Vendas vinculadas: R$ 45.000,00.\n\n\u26a0\ufe0f PRESCRITOR ROB\u00d4: O m\u00e9dico Dr. Jo\u00e3o Silva (CRM 789012/SC) apresentou\n   m\u00e9dia de 45 prescri\u00e7\u00f5es por dia nesta farm\u00e1cia, volume incompat\u00edvel\n   com a pr\u00e1tica m\u00e9dica regular.\n</code></pre>"},{"location":"arquitetura/fase3-relatorios.html#8-formatacao-profissional","title":"8. Formata\u00e7\u00e3o Profissional","text":""},{"location":"arquitetura/fase3-relatorios.html#81-recursos-do-xlsxwriter","title":"8.1. Recursos do xlsxwriter","text":"<p>O poder do xlsxwriter \u00e9 usado para dar acabamento profissional:</p> Recurso Aplica\u00e7\u00e3o Cores Paleta institucional, alertas por cor Fontes Calibri 11pt, negrito para t\u00edtulos Bordas Grid completo nas tabelas Largura de Colunas Ajuste autom\u00e1tico para evitar corte Mesclagem de C\u00e9lulas T\u00edtulos e cabe\u00e7alhos Congelamento de Pain\u00e9is Cabe\u00e7alhos fixos durante rolagem Gr\u00e1ficos Barras, \u00e1rea, pizza (aba Evolu\u00e7\u00e3o) Coment\u00e1rios Explica\u00e7\u00f5es metodol\u00f3gicas Formata\u00e7\u00e3o Condicional Cores baseadas em valores"},{"location":"arquitetura/fase3-relatorios.html#82-paleta-de-cores","title":"8.2. Paleta de Cores","text":"C\u00f3digo Uso <code>#1F4E78</code> Azul escuro - cabe\u00e7alhos principais <code>#E8F4FD</code> Azul claro - linhas alternadas <code>#FFCCCC</code> Vermelho claro - irregularidades <code>#D4EDDA</code> Verde claro - situa\u00e7\u00f5es normais <code>#FFF3CD</code> Amarelo - alertas moderados <code>#EEEEEE</code> Cinza - cabe\u00e7alhos de produto"},{"location":"arquitetura/fase3-relatorios.html#9-nomenclatura-dos-arquivos","title":"9. Nomenclatura dos Arquivos","text":""},{"location":"arquitetura/fase3-relatorios.html#91-padrao-de-nome","title":"9.1. Padr\u00e3o de Nome","text":"<pre><code>&lt;CNPJ&gt; (&lt;Tipo&gt;).xlsx\n</code></pre> <p>Exemplos:</p> <ul> <li><code>12345678000199 (Completo).xlsx</code></li> <li><code>12345678000199 (Resumido).xlsx</code></li> </ul>"},{"location":"arquitetura/fase3-relatorios.html#92-localizacao","title":"9.2. Localiza\u00e7\u00e3o","text":"<p>Os arquivos s\u00e3o salvos no mesmo diret\u00f3rio do script, ou em pasta configurada.</p> <p>Pr\u00f3ximo Passo</p> <p>Veja a Fase 4: An\u00e1lise Gerencial para entender como os indicadores de risco s\u00e3o calculados.</p>"},{"location":"arquitetura/fase4-analise.html","title":"Fase 4: An\u00e1lise Gerencial","text":"<p>O objetivo desta fase \u00e9 sair da vis\u00e3o micro (transa\u00e7\u00e3o a transa\u00e7\u00e3o, CNPJ por CNPJ) e chegar a uma vis\u00e3o macro e comparativa. Ela agrega os resultados e calcula m\u00e9tricas padronizadas que permitem classificar e comparar o comportamento de todas as farm\u00e1cias auditadas.</p>"},{"location":"arquitetura/fase4-analise.html#1-visao-geral","title":"1. Vis\u00e3o Geral","text":""},{"location":"arquitetura/fase4-analise.html#11-objetivo","title":"1.1. Objetivo","text":"<p>Consolidar os resultados da auditoria de fluxo de estoque e calcular os 17 indicadores de risco para cada farm\u00e1cia.</p>"},{"location":"arquitetura/fase4-analise.html#12-script-principal","title":"1.2. Script Principal","text":"<pre><code>\ud83d\udcc4 05 - pos_processamento.sql\n\ud83d\udcc1 Indicadores/ (22 scripts SQL)\n\ud83d\udcc4 Indicadores/matriz_risco_final.sql\n</code></pre>"},{"location":"arquitetura/fase4-analise.html#13-diagrama-de-fluxo","title":"1.3. Diagrama de Fluxo","text":"flowchart TD     A[Etapa 1Agrega\u00e7\u00e3o por CNPJ] --&gt; B[Etapa 2C\u00e1lculo dos Indicadores]     B --&gt; C[Etapa 3Enriquecimento com Contexto]     C --&gt; D[Etapa 4Matriz de Risco Final]     D --&gt; E[Tabela Consolidadaresultado_Sentinela]"},{"location":"arquitetura/fase4-analise.html#2-etapa-1-agregacao-dos-resultados-brutos-por-farmacia","title":"2. Etapa 1: Agrega\u00e7\u00e3o dos Resultados Brutos por Farm\u00e1cia","text":""},{"location":"arquitetura/fase4-analise.html#21-o-que-faz","title":"2.1. O que faz","text":"<p>Cria a tabela tempor\u00e1ria <code>#movimentacao_gerencial_temp</code> com os totais consolidados de cada farm\u00e1cia.</p>"},{"location":"arquitetura/fase4-analise.html#22-como-funciona","title":"2.2. Como funciona","text":"<p>Realiza agrega\u00e7\u00e3o (<code>SUM()</code>) sobre a tabela <code>movimentacaoMensalCodigoBarraFP</code>, que cont\u00e9m os totais mensais por produto.</p>"},{"location":"arquitetura/fase4-analise.html#23-campos-agregados","title":"2.3. Campos Agregados","text":"Campo Original Agrega\u00e7\u00e3o Campo Resultado <code>qnt_vendas</code> <code>SUM()</code> Total de vendas em unidades <code>qnt_vendas_sem_comprovacao</code> <code>SUM()</code> Total irregular em unidades <code>valor_vendas</code> <code>SUM()</code> Faturamento total <code>valor_sem_comprovacao</code> <code>SUM()</code> Valor total irregular"},{"location":"arquitetura/fase4-analise.html#24-resultado","title":"2.4. Resultado","text":"<p>Uma \u00fanica linha de resumo para cada farm\u00e1cia, contendo os totais gerais da auditoria.</p>"},{"location":"arquitetura/fase4-analise.html#3-etapa-2-calculo-dos-indicadores-de-risco","title":"3. Etapa 2: C\u00e1lculo dos Indicadores de Risco","text":"<p>Esta \u00e9 a etapa mais rica, onde diferentes comportamentos potencialmente fraudulentos s\u00e3o medidos e quantificados.</p>"},{"location":"arquitetura/fase4-analise.html#31-estrutura-dos-scripts","title":"3.1. Estrutura dos Scripts","text":"<p>Cada indicador possui um script SQL dedicado na pasta <code>Indicadores/</code>:</p> <pre><code>\ud83d\udcc1 Indicadores/\n\u251c\u2500\u2500 falecidos.sql\n\u251c\u2500\u2500 inconsistencia_clinica.sql\n\u251c\u2500\u2500 teto.sql\n\u251c\u2500\u2500 polimedicamento.sql\n\u251c\u2500\u2500 media_itens.sql\n\u251c\u2500\u2500 tickermedio.sql\n\u251c\u2500\u2500 receita_por_paciente.sql\n\u251c\u2500\u2500 venda_per_capita.sql\n\u251c\u2500\u2500 medicamentos_alto_custo.sql\n\u251c\u2500\u2500 vendas_consecutivas.sql\n\u251c\u2500\u2500 horario_atipico.sql\n\u251c\u2500\u2500 concentracao_dias_pico.sql\n\u251c\u2500\u2500 geografico.sql\n\u251c\u2500\u2500 pacientes_unicos.sql\n\u251c\u2500\u2500 crms.sql\n\u251c\u2500\u2500 exclusividade_crm.sql\n\u251c\u2500\u2500 crms_irregulares.sql\n\u2514\u2500\u2500 matriz_risco_final.sql\n</code></pre>"},{"location":"arquitetura/fase4-analise.html#32-visao-geral-dos-17-indicadores","title":"3.2. Vis\u00e3o Geral dos 17 Indicadores","text":"# Indicador Grupo Script 1 Vendas para Falecidos Elegibilidade <code>falecidos.sql</code> 2 Incompatibilidade Cl\u00ednica Elegibilidade <code>inconsistencia_clinica.sql</code> 3 Dispensa\u00e7\u00e3o em Teto Quantidade <code>teto.sql</code> 4 Polimedicamentos Quantidade <code>polimedicamento.sql</code> 5 M\u00e9dia de Itens Quantidade <code>media_itens.sql</code> 6 Ticket M\u00e9dio Financeiro <code>tickermedio.sql</code> 7 Receita por Paciente Financeiro <code>receita_por_paciente.sql</code> 8 Venda Per Capita Financeiro <code>venda_per_capita.sql</code> 9 Medicamentos Alto Custo Financeiro <code>medicamentos_alto_custo.sql</code> 10 Vendas R\u00e1pidas Automa\u00e7\u00e3o <code>vendas_consecutivas.sql</code> 11 Hor\u00e1rio At\u00edpico Automa\u00e7\u00e3o <code>horario_atipico.sql</code> 12 Concentra\u00e7\u00e3o em Pico Automa\u00e7\u00e3o <code>concentracao_dias_pico.sql</code> 13 Dispers\u00e3o Geogr\u00e1fica Automa\u00e7\u00e3o <code>geografico.sql</code> 14 Pacientes \u00danicos Automa\u00e7\u00e3o <code>pacientes_unicos.sql</code> 15 Concentra\u00e7\u00e3o HHI CRMs <code>crms.sql</code> 16 Exclusividade CRM CRMs <code>exclusividade_crm.sql</code> 17 Irregularidade CRM CRMs <code>crms_irregulares.sql</code>"},{"location":"arquitetura/fase4-analise.html#4-etapa-3-enriquecimento-com-contexto","title":"4. Etapa 3: Enriquecimento com Contexto","text":""},{"location":"arquitetura/fase4-analise.html#41-o-que-faz","title":"4.1. O que faz","text":"<p>Adiciona informa\u00e7\u00f5es contextuais que permitem interpretar os n\u00fameros absolutos.</p>"},{"location":"arquitetura/fase4-analise.html#42-metricas-de-contexto","title":"4.2. M\u00e9tricas de Contexto","text":"M\u00e9trica Descri\u00e7\u00e3o Uso <code>num_estabelecimentos_municipio</code> Farm\u00e1cias na mesma cidade Avaliar satura\u00e7\u00e3o <code>num_meses_movimentacao</code> Meses com atividade Avaliar consist\u00eancia <code>populacao_municipio</code> Popula\u00e7\u00e3o local (IBGE) Calcular per capita <code>porte_empresa</code> MEI, ME, EPP, etc. Contextualizar volume"},{"location":"arquitetura/fase4-analise.html#43-por-que-o-contexto-importa","title":"4.3. Por que o contexto importa","text":"<p>Exemplo</p> <p>Uma farm\u00e1cia com 50% de irregularidade em uma cidade com apenas 2 estabelecimentos pode ter um significado diferente de uma com o mesmo percentual em uma metr\u00f3pole com 500 farm\u00e1cias.</p> <pre><code>Um padr\u00e3o observado ao longo de 48 meses \u00e9 mais robusto do que um observado em apenas 3 meses.\n</code></pre>"},{"location":"arquitetura/fase4-analise.html#5-etapa-4-matriz-de-risco-final","title":"5. Etapa 4: Matriz de Risco Final","text":""},{"location":"arquitetura/fase4-analise.html#51-script-principal","title":"5.1. Script Principal","text":"<pre><code>\ud83d\udcc4 Indicadores/matriz_risco_final.sql\n</code></pre>"},{"location":"arquitetura/fase4-analise.html#52-consolidacao-dos-indicadores","title":"5.2. Consolida\u00e7\u00e3o dos Indicadores","text":"<p>Este script \u00e9 a etapa final que:</p> <ol> <li>Une todos os indicadores calculados individualmente</li> <li>Calcula o Score de Risco Final</li> <li>Gera a classifica\u00e7\u00e3o e os rankings</li> <li>Cria a tabela <code>Matriz_Risco_Final</code></li> </ol>"},{"location":"arquitetura/fase4-analise.html#53-calculo-do-score-de-risco","title":"5.3. C\u00e1lculo do Score de Risco","text":"<p>O Score \u00e9 calculado atrav\u00e9s da M\u00e9dia Aritm\u00e9tica dos Riscos Relativos:</p>"},{"location":"arquitetura/fase4-analise.html#passo-1-normalizacao-risco-relativo","title":"Passo 1: Normaliza\u00e7\u00e3o (Risco Relativo)","text":"<p>Para cada indicador, calcula-se o risco da farm\u00e1cia em rela\u00e7\u00e3o \u00e0 m\u00e9dia do seu estado:</p> \\[ RR_i = \\frac{\\text{Indicador da Farm\u00e1cia}_i}{\\text{M\u00e9dia do Indicador na UF}_i} \\] <p>Tratamento de Exce\u00e7\u00e3o</p> <p>Se a m\u00e9dia da UF for zero, utiliza-se um valor default para evitar divis\u00e3o por zero.</p>"},{"location":"arquitetura/fase4-analise.html#passo-2-calculo-do-score-geral","title":"Passo 2: C\u00e1lculo do Score Geral","text":"\\[ \\text{SCORE\\_FINAL} = \\frac{\\sum_{i=1}^{17} RR_i}{17} \\]"},{"location":"arquitetura/fase4-analise.html#54-classificacao-de-risco-percentil","title":"5.4. Classifica\u00e7\u00e3o de Risco (Percentil)","text":"<p>Ap\u00f3s calcular o Score para todas as farm\u00e1cias, aplica-se uma fun\u00e7\u00e3o de janelamento (<code>PERCENT_RANK()</code>) para distribuir os estabelecimentos em faixas:</p> Classifica\u00e7\u00e3o Percentil Descri\u00e7\u00e3o \ud83d\udd34 RISCO CR\u00cdTICO 99% - 100% Top 1% do ranking \ud83d\udfe0 RISCO ALTO 95% - 99% Top 5% do ranking \ud83d\udfe1 RISCO M\u00c9DIO 75% - 95% Quartil superior \ud83d\udfe2 RISCO BAIXO 25% - 75% Faixa intermedi\u00e1ria \ud83d\udfe2 RISCO M\u00cdNIMO 0% - 25% Quartil inferior"},{"location":"arquitetura/fase4-analise.html#55-rankings","title":"5.5. Rankings","text":"<p>S\u00e3o calculados tr\u00eas rankings:</p> Ranking Escopo Uso Nacional Todas as farm\u00e1cias do Brasil Prioriza\u00e7\u00e3o geral Estadual Farm\u00e1cias da mesma UF Compara\u00e7\u00e3o regional Municipal Farm\u00e1cias do mesmo munic\u00edpio An\u00e1lise local"},{"location":"arquitetura/fase4-analise.html#6-tabela-de-resultado-consolidado","title":"6. Tabela de Resultado Consolidado","text":""},{"location":"arquitetura/fase4-analise.html#61-tabela-final","title":"6.1. Tabela Final","text":"<pre><code>\ud83d\udcca temp_CGUSC.dbo.resultado_Sentinela_2015_2024\n</code></pre>"},{"location":"arquitetura/fase4-analise.html#62-o-que-contem","title":"6.2. O que cont\u00e9m","text":"<p>Esta \u00e9 a vis\u00e3o de 360 graus de cada farm\u00e1cia auditada:</p> Categoria Campos Identifica\u00e7\u00e3o CNPJ, Raz\u00e3o Social, Munic\u00edpio, UF Resultados Auditoria Valor total, Valor irregular, Quantidades Indicadores Todos os 17 indicadores individuais Contexto Porte, farm\u00e1cias no munic\u00edpio, meses de atividade Score e Ranking Score final, classifica\u00e7\u00e3o, rankings Demogr\u00e1fico Popula\u00e7\u00e3o, habitantes por farm\u00e1cia"},{"location":"arquitetura/fase4-analise.html#63-uso-da-tabela","title":"6.3. Uso da Tabela","text":"<p>Esta tabela permite perguntas complexas e multifatoriais:</p> <p>Exemplo de Consulta</p> <p>\"Quais s\u00e3o as farm\u00e1cias de pequeno porte, em munic\u00edpios com menos de 50.000 habitantes, que apresentam um percentual de vendas sem comprova\u00e7\u00e3o acima de 15% E um indicador de vendas para falecidos maior que zero?\"</p> <p>\u00c9 a partir desta tabela consolidada que s\u00e3o criados:</p> <ul> <li>Dashboards</li> <li>Relat\u00f3rios gerenciais</li> <li>Sele\u00e7\u00e3o de alvos para auditorias presenciais</li> </ul>"},{"location":"arquitetura/fase4-analise.html#7-integracao-com-o-painel-bi","title":"7. Integra\u00e7\u00e3o com o Painel BI","text":""},{"location":"arquitetura/fase4-analise.html#71-queries-do-painel","title":"7.1. Queries do Painel","text":"<pre><code>\ud83d\udcc4 06 - SQLs_Sentinela_BI.sql\n</code></pre> <p>Este arquivo cont\u00e9m as queries utilizadas para alimentar o painel Power BI.</p>"},{"location":"arquitetura/fase4-analise.html#72-bases-de-dados-utilizadas","title":"7.2. Bases de Dados Utilizadas","text":"<p>O painel integra dados de m\u00faltiplas fontes:</p> Base Uso no Painel <code>db_Cadunico</code> Dados de benefici\u00e1rios <code>db_CPF</code> Dados cadastrais de pessoas <code>db_CNPJ</code> Dados cadastrais de empresas <code>db_FarmaciaPopular</code> Transa\u00e7\u00f5es do programa <code>db_Dike_CNPJ</code> Dados enriquecidos <code>temp_CGUSC</code> Resultados da auditoria"},{"location":"arquitetura/fase4-analise.html#73-link-do-painel","title":"7.3. Link do Painel","text":"<p>\ud83d\udd17 https://paineis.cgu.gov.br/sentinela</p>"},{"location":"arquitetura/fase4-analise.html#8-tabelas-temporarias-do-processo","title":"8. Tabelas Tempor\u00e1rias do Processo","text":"<p>Durante a Fase 4, s\u00e3o criadas diversas tabelas tempor\u00e1rias:</p> Tabela Descri\u00e7\u00e3o <code>#movimentacao_gerencial_temp</code> Agrega\u00e7\u00e3o inicial por CNPJ <code>#movimentacao_gerencial_temp2</code> Com dados cadastrais <code>#movimentacao_gerencial_temp3</code> Com m\u00e9tricas de contexto <code>#vendas_falecidos</code> C\u00e1lculo do indicador de falecidos <code>#vendas_total</code> Denominador para percentuais <code>#indicadorTicketMedio</code> C\u00e1lculo do ticket m\u00e9dio <code>#indicadorMedicamentosporCupom</code> M\u00e9dia de itens ... (uma para cada indicador)"},{"location":"arquitetura/fase4-analise.html#9-fluxo-completo-de-execucao","title":"9. Fluxo Completo de Execu\u00e7\u00e3o","text":"sequenceDiagram     participant DBA as Analista     participant SQL as SQL Server     participant BI as Power BI      DBA-&gt;&gt;SQL: Executa 05 - pos_processamento.sql     SQL--&gt;&gt;SQL: Agrega resultados por CNPJ      loop Para cada indicador         DBA-&gt;&gt;SQL: Executa script do indicador         SQL--&gt;&gt;SQL: Calcula m\u00e9trica     end      DBA-&gt;&gt;SQL: Executa matriz_risco_final.sql     SQL--&gt;&gt;SQL: Calcula scores e rankings     SQL--&gt;&gt;SQL: Gera resultado_Sentinela      BI-&gt;&gt;SQL: Consulta dados     SQL--&gt;&gt;BI: Retorna resultados     BI--&gt;&gt;BI: Atualiza dashboards  <p>Pr\u00f3ximo Passo</p> <p>Explore os Indicadores de Risco para entender a metodologia detalhada de cada m\u00e9trica.</p>"},{"location":"arquitetura/fluxo-dados.html","title":"Fluxo de Dados","text":"<p>Este documento apresenta uma vis\u00e3o integrada de como os dados fluem atrav\u00e9s do Sentinela, desde a entrada at\u00e9 a gera\u00e7\u00e3o dos produtos finais.</p>"},{"location":"arquitetura/fluxo-dados.html#1-visao-geral-do-pipeline","title":"1. Vis\u00e3o Geral do Pipeline","text":"flowchart TB     subgraph entrada[\" \ud83d\udce5 ENTRADA\"]         direction LR         MS[(Minist\u00e9rio da Sa\u00fadeVendas PFPB)]         RFB[(Receita FederalNF-e)]         CFM[(CFMM\u00e9dicos)]         IBGE[(IBGEDemografia)]         SIM[(SIM/SIRC\u00d3bitos)]     end      subgraph etl[\" \u2699\ufe0f ETL - Prepara\u00e7\u00e3o\"]         direction TB         E1[Extra\u00e7\u00e3oSele\u00e7\u00e3o do per\u00edodo]         E2[Transforma\u00e7\u00e3oLimpeza e normaliza\u00e7\u00e3o]         E3[CargaTabelas de trabalho]     end      subgraph proc[\" \ud83d\udd04 PROCESSAMENTO\"]         direction TB         P1[Particionamento100 lotes]         P2[Simula\u00e7\u00e3oFluxo de estoque]         P3[Detec\u00e7\u00e3oIrregularidades]         P4[Indicadores17 m\u00e9tricas]     end      subgraph saida[\" \ud83d\udce4 SA\u00cdDA\"]         direction LR         S1[\ud83d\udcd1 Dossi\u00eas Excel]         S2[\ud83d\udcca Matriz de Risco]         S3[\ud83d\udcc8 Painel BI]         S4[\ud83d\udccb Tabela Consolidada]     end      entrada --&gt; etl     etl --&gt; proc     proc --&gt; saida"},{"location":"arquitetura/fluxo-dados.html#2-fluxo-detalhado-por-fase","title":"2. Fluxo Detalhado por Fase","text":""},{"location":"arquitetura/fluxo-dados.html#21-fase-1-preparacao-sql","title":"2.1. Fase 1: Prepara\u00e7\u00e3o (SQL)","text":"flowchart LR     subgraph Entrada         A1[relatorio_movimentacao2015_2024]         A2[aquisicoesFazenda2015_2025]     end      subgraph Processamento         B1[Filtro por per\u00edodo]         B2[Extra\u00e7\u00e3o de CNPJs \u00fanicos]         B3[Particionamento NTILE]         B4[Consolida\u00e7\u00e3o cadastral]         B5[C\u00e1lculo estoque inicial]     end      subgraph Saida         C1[lista_cnpjs]         C2[classif]         C3[dadosFarmaciasFP]         C4[estoque_inicialFP]     end      A1 --&gt; B1 --&gt; B2 --&gt; C1     C1 --&gt; B3 --&gt; C2     A1 --&gt; B4 --&gt; C3     A2 --&gt; B5 --&gt; C4"},{"location":"arquitetura/fluxo-dados.html#22-fase-2-processamento-python","title":"2.2. Fase 2: Processamento (Python)","text":"flowchart TB     subgraph Entrada         A1[classifLotes de CNPJs]         A2[procPreparaDadosStored Procedure]         A3[movimentacaoFPTrabalho]     end      subgraph Loop[\"Para cada CNPJ\"]         B1[Query UnificadaVendas + Aquisi\u00e7\u00f5es]         B2[Simula\u00e7\u00e3oLinha a linha]         B3[Detec\u00e7\u00e3oEstoque negativo]         B4[Persist\u00eanciaBanco de dados]     end      subgraph Saida         C1[processamentosFP]         C2[movimentacaoMensalFP]         C3[memoria_calculoFP]     end      A1 --&gt; A2 --&gt; A3     A3 --&gt; B1 --&gt; B2 --&gt; B3 --&gt; B4     B4 --&gt; C1     B4 --&gt; C2     B4 --&gt; C3"},{"location":"arquitetura/fluxo-dados.html#23-fase-3-relatorios-python","title":"2.3. Fase 3: Relat\u00f3rios (Python)","text":"flowchart LR     subgraph Entrada         A1[memoria_calculoFPJSON comprimido]         A2[Matriz_Risco_FinalIndicadores]         A3[indicadorCRMPrescritores]     end      subgraph Processamento         B1[Descompress\u00e3o]         B2[Formata\u00e7\u00e3o]         B3[Gera\u00e7\u00e3o abas]     end      subgraph Saida         C1[\ud83d\udcd1 Excel4 abas]     end      A1 --&gt; B1 --&gt; B2     A2 --&gt; B2     A3 --&gt; B2     B2 --&gt; B3 --&gt; C1"},{"location":"arquitetura/fluxo-dados.html#24-fase-4-analise-gerencial-sql","title":"2.4. Fase 4: An\u00e1lise Gerencial (SQL)","text":"flowchart TB     subgraph Entrada         A1[movimentacaoMensalFP]         A2[Tabelas auxiliares]     end      subgraph Indicadores         B1[Falecidos]         B2[Cl\u00ednico]         B3[Quantidade]         B4[Financeiro]         B5[Automa\u00e7\u00e3o]         B6[CRMs]     end      subgraph Consolidacao         C1[C\u00e1lculo RR]         C2[Score Final]         C3[Rankings]     end      subgraph Saida         D1[resultado_Sentinela]         D2[Matriz_Risco_Final]     end      A1 --&gt; B1 &amp; B2 &amp; B3 &amp; B4 &amp; B5 &amp; B6     A2 --&gt; B1 &amp; B2 &amp; B3 &amp; B4 &amp; B5 &amp; B6     B1 &amp; B2 &amp; B3 &amp; B4 &amp; B5 &amp; B6 --&gt; C1     C1 --&gt; C2 --&gt; C3     C3 --&gt; D1 &amp; D2"},{"location":"arquitetura/fluxo-dados.html#3-mapa-de-tabelas","title":"3. Mapa de Tabelas","text":""},{"location":"arquitetura/fluxo-dados.html#31-tabelas-de-entrada-leitura","title":"3.1. Tabelas de Entrada (Leitura)","text":"Tabela Base Tipo Linhas (est.) relatorio_movimentacao_2015_2024 db_farmaciapopular Transacional Bilh\u00f5es aquisicoesFazenda_2015_2025 db_farmaciapopular_nf Transacional Centenas de milh\u00f5es tb_obitos_unificada M\u00faltiplas Refer\u00eancia Milh\u00f5es CNPJ db_CNPJ Refer\u00eancia Milh\u00f5es CPF db_CPF Refer\u00eancia Centenas de milh\u00f5es"},{"location":"arquitetura/fluxo-dados.html#32-tabelas-de-trabalho-temporarias","title":"3.2. Tabelas de Trabalho (Tempor\u00e1rias)","text":"Tabela Fun\u00e7\u00e3o Vida \u00datil classif Particionamento de CNPJs Toda execu\u00e7\u00e3o movimentacaoFP Dados do lote atual Um lote #temp_* C\u00e1lculos intermedi\u00e1rios Uma query"},{"location":"arquitetura/fluxo-dados.html#33-tabelas-de-saida-persistencia","title":"3.3. Tabelas de Sa\u00edda (Persist\u00eancia)","text":"Tabela Fun\u00e7\u00e3o Atualiza\u00e7\u00e3o processamentosFP Status de cada CNPJ Por CNPJ movimentacaoMensalCodigoBarraFP Movimenta\u00e7\u00e3o mensal Por CNPJ memoria_calculo_consolidadaFP Mem\u00f3ria de c\u00e1lculo Por CNPJ resultado_Sentinela_2015_2024 Consolida\u00e7\u00e3o final Uma vez Matriz_Risco_Final Scores e rankings Uma vez"},{"location":"arquitetura/fluxo-dados.html#4-fluxo-de-dados-por-campo","title":"4. Fluxo de Dados por Campo","text":""},{"location":"arquitetura/fluxo-dados.html#41-rastreabilidade-de-um-cnpj","title":"4.1. Rastreabilidade de um CNPJ","text":"flowchart LR     A[CNPJ] --&gt; B[lista_cnpjs]     B --&gt; C[classif]     C --&gt; D[processamentosFP]     D --&gt; E[movimentacaoMensalFP]     D --&gt; F[memoria_calculoFP]     E --&gt; G[resultado_Sentinela]     G --&gt; H[Matriz_Risco_Final]"},{"location":"arquitetura/fluxo-dados.html#42-rastreabilidade-de-uma-venda","title":"4.2. Rastreabilidade de uma Venda","text":"flowchart LR     A[Venda Originalrelatorio_movimentacao] --&gt; B[movimentacaoFPLote]     B --&gt; C[Query UnificadaPython]     C --&gt; D[Simula\u00e7\u00e3oFluxo Estoque]     D --&gt; E{Irregular?}     E --&gt;|Sim| F[memoria_calculoTipo 'v']     E --&gt;|N\u00e3o| G[Apenas contagem]     F --&gt; H[movimentacaoMensalAgregado]     H --&gt; I[Relat\u00f3rio ExcelAba Movimenta\u00e7\u00e3o]"},{"location":"arquitetura/fluxo-dados.html#5-integracoes-externas","title":"5. Integra\u00e7\u00f5es Externas","text":""},{"location":"arquitetura/fluxo-dados.html#51-entrada-de-dados","title":"5.1. Entrada de Dados","text":"Fonte Frequ\u00eancia M\u00e9todo Minist\u00e9rio da Sa\u00fade Peri\u00f3dica Carga em base Receita Federal Peri\u00f3dica Carga em base CFM Sob demanda API/Arquivo IBGE Anual Carga em base Bases de \u00d3bitos Peri\u00f3dica Carga em base"},{"location":"arquitetura/fluxo-dados.html#52-saida-de-dados","title":"5.2. Sa\u00edda de Dados","text":"Destino Formato M\u00e9todo Arquivos Excel .xlsx Gera\u00e7\u00e3o local Painel BI Power BI Conex\u00e3o DirectQuery Auditorias Tabelas SQL Acesso direto"},{"location":"arquitetura/fluxo-dados.html#6-pontos-de-verificacao","title":"6. Pontos de Verifica\u00e7\u00e3o","text":""},{"location":"arquitetura/fluxo-dados.html#61-apos-fase-1","title":"6.1. Ap\u00f3s Fase 1","text":"<ul> <li> <code>lista_cnpjs</code> populada com CNPJs \u00fanicos</li> <li> <code>classif</code> com 100 lotes balanceados</li> <li> <code>estoque_inicialFP</code> calculado para cada produto/farm\u00e1cia</li> <li> Coordenadas geogr\u00e1ficas atualizadas</li> </ul>"},{"location":"arquitetura/fluxo-dados.html#62-apos-fase-2","title":"6.2. Ap\u00f3s Fase 2","text":"<ul> <li> Todos os CNPJs com status != RUNNING</li> <li> <code>movimentacaoMensalFP</code> populada</li> <li> <code>memoria_calculo</code> salva para CNPJs com irregularidades</li> <li> Relat\u00f3rios Excel gerados</li> </ul>"},{"location":"arquitetura/fluxo-dados.html#63-apos-fase-4","title":"6.3. Ap\u00f3s Fase 4","text":"<ul> <li> Todos os indicadores calculados</li> <li> <code>resultado_Sentinela</code> consolidado</li> <li> <code>Matriz_Risco_Final</code> com scores e rankings</li> <li> Painel BI atualizado</li> </ul> <p>Pr\u00f3ximo Passo</p> <p>Veja o Guia de Execu\u00e7\u00e3o para instru\u00e7\u00f5es detalhadas de como executar cada fase.</p>"},{"location":"arquitetura/fontes-dados.html","title":"Fontes de Dados Prim\u00e1rias","text":"<p>No centro de toda a an\u00e1lise do Sistema Sentinela est\u00e3o duas tabelas transacionais principais. Elas representam os dois lados da balan\u00e7a que a auditoria busca equilibrar: o que a farm\u00e1cia comprou e o que ela vendeu.</p>"},{"location":"arquitetura/fontes-dados.html#1-tabela-de-saidas-vendas-do-programa-farmacia-popular","title":"1. Tabela de Sa\u00eddas: Vendas do Programa Farm\u00e1cia Popular","text":""},{"location":"arquitetura/fontes-dados.html#11-identificacao","title":"1.1. Identifica\u00e7\u00e3o","text":"Atributo Valor Nome da Tabela <code>[dbo].[relatorio_movimentacao_2015_2024]</code> Base de Dados <code>db_farmaciapopular</code> Fonte Original Sistema Autorizador do Minist\u00e9rio da Sa\u00fade Tipo Transacional Granularidade Um registro por item vendido"},{"location":"arquitetura/fontes-dados.html#12-descricao","title":"1.2. Descri\u00e7\u00e3o","text":"<p>Esta tabela cont\u00e9m o registro de todas as vendas realizadas pelas farm\u00e1cias dentro do programa Farm\u00e1cia Popular. Cada linha representa um item vendido em uma transa\u00e7\u00e3o.</p> <p>Papel no Sistema</p> <p>Ela representa o fluxo de sa\u00edda (outflow) de medicamentos do estoque. \u00c9 o conjunto de dados que est\u00e1 sendo auditado. No processo de an\u00e1lise da Fase 2, os registros desta tabela s\u00e3o marcados como transa\u00e7\u00f5es do tipo 'V' (Venda).</p>"},{"location":"arquitetura/fontes-dados.html#13-campos-principais","title":"1.3. Campos Principais","text":"Campo Tipo Descri\u00e7\u00e3o <code>cnpj</code> VARCHAR(14) CNPJ da farm\u00e1cia que realizou a venda <code>data_hora</code> DATETIME Momento exato da transa\u00e7\u00e3o (data e hora) <code>codigo_barra</code> BIGINT C\u00f3digo GTIN do produto vendido <code>qnt_autorizada</code> INT Quantidade do produto vendida (geralmente em unidades/comprimidos) <code>valor_autorizado</code> DECIMAL(10,2) Valor da venda autorizada <code>valor_pago</code> DECIMAL(10,2) Valor efetivamente pago/ressarcido <code>num_autorizacao</code> BIGINT N\u00famero \u00fanico da autoriza\u00e7\u00e3o (cupom fiscal) <code>nu_cpf</code> VARCHAR(11) CPF do benefici\u00e1rio que recebeu o medicamento <code>id_medico</code> VARCHAR(20) CRM do m\u00e9dico prescritor"},{"location":"arquitetura/fontes-dados.html#14-volume-de-dados","title":"1.4. Volume de Dados","text":"<p>Aten\u00e7\u00e3o</p> <p>Esta tabela cont\u00e9m bilh\u00f5es de registros cobrindo quase uma d\u00e9cada de transa\u00e7\u00f5es. Consultas diretas sem filtros adequados podem impactar a performance do servidor.</p>"},{"location":"arquitetura/fontes-dados.html#15-como-e-utilizada","title":"1.5. Como \u00e9 Utilizada","text":"<ol> <li>Fase 1 (Prepara\u00e7\u00e3o): Define o universo de CNPJs a serem analisados</li> <li>Fase 2 (Processamento): Fornece os registros de venda para simula\u00e7\u00e3o de estoque</li> <li>Fase 4 (An\u00e1lise): Base para c\u00e1lculo de indicadores comportamentais</li> </ol>"},{"location":"arquitetura/fontes-dados.html#2-tabela-de-entradas-aquisicoes-por-nota-fiscal","title":"2. Tabela de Entradas: Aquisi\u00e7\u00f5es por Nota Fiscal","text":""},{"location":"arquitetura/fontes-dados.html#21-identificacao","title":"2.1. Identifica\u00e7\u00e3o","text":"Atributo Valor Nome da Tabela <code>[dbo].[aquisicoesFazenda_2015_2025]</code> Base de Dados <code>db_farmaciapopular_nf</code> Fonte Original Nota Fiscal Eletr\u00f4nica (SPED/Receita Federal) Tipo Transacional Granularidade Um registro por item da nota fiscal"},{"location":"arquitetura/fontes-dados.html#22-descricao","title":"2.2. Descri\u00e7\u00e3o","text":"<p>Esta tabela cont\u00e9m os dados extra\u00eddos das Notas Fiscais Eletr\u00f4nicas (NF-e) que registram a compra de medicamentos pelas farm\u00e1cias junto aos seus distribuidores.</p> <p>Papel no Sistema</p> <p>Ela representa o fluxo de entrada (inflow) de medicamentos no estoque e serve como a \"comprova\u00e7\u00e3o\" legal da aquisi\u00e7\u00e3o. \u00c9 contra esta base de dados que as vendas s\u00e3o comparadas. No processo de an\u00e1lise, os registros desta tabela s\u00e3o marcados como transa\u00e7\u00f5es do tipo 'C' (Compra).</p>"},{"location":"arquitetura/fontes-dados.html#23-campos-principais","title":"2.3. Campos Principais","text":"Campo Tipo Descri\u00e7\u00e3o <code>destinatarioNFE</code> VARCHAR(14) CNPJ da farm\u00e1cia que comprou o medicamento <code>dataEmissaoNFE</code> DATE Data de emiss\u00e3o da nota fiscal (data da compra) <code>codigoBarra</code> BIGINT C\u00f3digo GTIN do produto comprado <code>quantidade</code> INT Quantidade adquirida (geralmente em caixas) <code>numeroNFE</code> BIGINT N\u00famero da nota fiscal para rastreabilidade <code>tipoOperacao</code> INT Natureza da transa\u00e7\u00e3o fiscal <code>emitenteNFE</code> VARCHAR(14) CNPJ do fornecedor/distribuidor"},{"location":"arquitetura/fontes-dados.html#24-tipos-de-operacao","title":"2.4. Tipos de Opera\u00e7\u00e3o","text":"<p>O campo <code>tipoOperacao</code> \u00e9 crucial para diferenciar a natureza da transa\u00e7\u00e3o:</p> C\u00f3digo Opera\u00e7\u00e3o Efeito no Estoque Descri\u00e7\u00e3o 1 Compra \u2795 Entrada Aquisi\u00e7\u00e3o regular de mercadoria 0 Transfer\u00eancia \u2796 Sa\u00edda Transfer\u00eancia para outro estabelecimento -1 Devolu\u00e7\u00e3o \u2796 Sa\u00edda Devolu\u00e7\u00e3o ao fornecedor <p>Tratamento de Devolu\u00e7\u00f5es</p> <p>As transa\u00e7\u00f5es com <code>tipoOperacao = 0</code> e <code>tipoOperacao = -1</code> reduzem o estoque, pois representam sa\u00edda de mercadoria (devolu\u00e7\u00e3o ou transfer\u00eancia). O sistema trata essas transa\u00e7\u00f5es como tipo 'D' (Devolu\u00e7\u00e3o) na simula\u00e7\u00e3o de estoque.</p>"},{"location":"arquitetura/fontes-dados.html#25-filtros-aplicados","title":"2.5. Filtros Aplicados","text":"<p>Na query principal do sistema, apenas transa\u00e7\u00f5es com <code>tipoOperacao in (1, -1, 0)</code> s\u00e3o consideradas, excluindo opera\u00e7\u00f5es fiscais que n\u00e3o afetam estoque f\u00edsico.</p>"},{"location":"arquitetura/fontes-dados.html#3-cruzamento-das-bases","title":"3. Cruzamento das Bases","text":""},{"location":"arquitetura/fontes-dados.html#31-a-logica-do-cruzamento","title":"3.1. A L\u00f3gica do Cruzamento","text":"<p>O Sistema Sentinela cruza essas duas bases para responder \u00e0 pergunta fundamental:</p> <p>Pergunta Central</p> <p>Para cada venda registrada, existe uma aquisi\u00e7\u00e3o correspondente que comprove a exist\u00eancia do produto em estoque?</p>"},{"location":"arquitetura/fontes-dados.html#32-criacao-da-linha-do-tempo","title":"3.2. Cria\u00e7\u00e3o da Linha do Tempo","text":"<p>Na Fase 2, o sistema cria uma linha do tempo unificada combinando vendas e compras:</p> gantt     title Exemplo de Linha do Tempo - GTIN 7891234567890     dateFormat  YYYY-MM-DD     section Compras (C)     NF 123 - 50 caixas    :c1, 2023-01-05, 1d     NF 456 - 30 caixas    :c2, 2023-02-15, 1d     NF 789 - 40 caixas    :c3, 2023-03-20, 1d     section Vendas (V)     Venda 20 caixas       :v1, 2023-01-15, 1d     Venda 35 caixas       :v2, 2023-02-01, 1d     Venda 45 caixas       :v3, 2023-02-25, 1d     Venda 30 caixas       :v4, 2023-04-01, 1d"},{"location":"arquitetura/fontes-dados.html#33-ordenacao-critica","title":"3.3. Ordena\u00e7\u00e3o Cr\u00edtica","text":"<p>A query de cruzamento aplica ordena\u00e7\u00e3o espec\u00edfica:</p> <pre><code>ORDER BY codigoBarra, data_movimentacao ASC, compra_venda ASC\n</code></pre> <p>Esta ordena\u00e7\u00e3o garante que:</p> <ol> <li>Agrupamento por produto: Todas as transa\u00e7\u00f5es de um mesmo GTIN s\u00e3o processadas juntas</li> <li>Ordem cronol\u00f3gica: Transa\u00e7\u00f5es s\u00e3o processadas na ordem em que ocorreram</li> <li>Compras antes de vendas: Se houver compra e venda no mesmo dia, a compra \u00e9 processada primeiro</li> </ol> <p>Por que isso importa?</p> <p>A ordem de processamento \u00e9 fundamental para a precis\u00e3o da simula\u00e7\u00e3o. Se uma compra e uma venda ocorrem no mesmo dia, o comportamento natural \u00e9 que a farm\u00e1cia primeiro receba a mercadoria e depois a venda. Processar a venda antes poderia gerar um falso negativo de estoque.</p>"},{"location":"arquitetura/fontes-dados.html#4-consideracoes-tecnicas","title":"4. Considera\u00e7\u00f5es T\u00e9cnicas","text":""},{"location":"arquitetura/fontes-dados.html#41-unidades-de-medida","title":"4.1. Unidades de Medida","text":"<p>Aten\u00e7\u00e3o: Unidades Diferentes!</p> <p>As tabelas usam unidades de medida diferentes:</p> <pre><code>- **Vendas:** `qnt_autorizada` geralmente em **unidades/comprimidos**\n- **Aquisi\u00e7\u00f5es:** `quantidade` geralmente em **caixas**\n</code></pre> <p>O sistema utiliza a tabela <code>medicamentosPatologiaFP</code> para fazer a convers\u00e3o:</p> \\[ \\text{Quantidade em Caixas} = \\frac{\\text{qnt\\_autorizada}}{\\text{qnt\\_comprimidos\\_caixa}} \\]"},{"location":"arquitetura/fontes-dados.html#42-cobertura-temporal","title":"4.2. Cobertura Temporal","text":"Base Per\u00edodo Dispon\u00edvel Vendas PFPB Julho/2015 em diante NF-e Aquisi\u00e7\u00f5es 2015 em diante <p>Pr\u00f3ximo Passo</p> <p>Veja as Tabelas de Apoio para entender o dicion\u00e1rio de medicamentos e outras tabelas auxiliares.</p>"},{"location":"arquitetura/tabelas-apoio.html","title":"Tabelas de Apoio","text":"<p>Antes de iniciar a prepara\u00e7\u00e3o dos dados transacionais, \u00e9 crucial entender as tabelas de apoio que servem como base de conhecimento para todo o sistema.</p>"},{"location":"arquitetura/tabelas-apoio.html#1-dicionario-de-medicamentos","title":"1. Dicion\u00e1rio de Medicamentos","text":""},{"location":"arquitetura/tabelas-apoio.html#11-identificacao","title":"1.1. Identifica\u00e7\u00e3o","text":"Atributo Valor Nome da Tabela <code>temp_CGUSC.dbo.medicamentosPatologiaFP</code> Tipo Tabela de Refer\u00eancia (Lookup) Fun\u00e7\u00e3o Dicion\u00e1rio de medicamentos eleg\u00edveis ao PFPB"},{"location":"arquitetura/tabelas-apoio.html#12-descricao","title":"1.2. Descri\u00e7\u00e3o","text":"<p>Esta tabela funciona como o Dicion\u00e1rio de Medicamentos do sistema. Armazena informa\u00e7\u00f5es detalhadas para cada c\u00f3digo de barras (GTIN) eleg\u00edvel ao Programa Farm\u00e1cia Popular.</p> <p>Import\u00e2ncia Cr\u00edtica</p> <p>O campo <code>qnt_comprimidos_caixa</code> \u00e9 vital para a l\u00f3gica de neg\u00f3cio, pois permite ao sistema normalizar as vendas (muitas vezes registradas em unidades/comprimidos) para a unidade de controle de estoque (caixas).</p>"},{"location":"arquitetura/tabelas-apoio.html#13-estrutura-de-campos","title":"1.3. Estrutura de Campos","text":"Campo Tipo Descri\u00e7\u00e3o Exemplo <code>codigo_barra</code> BIGINT C\u00f3digo GTIN do medicamento (chave prim\u00e1ria) 7891234567890 <code>principio_ativo</code> VARCHAR(200) Princ\u00edpio ativo do medicamento Budesonida 50mcg <code>produto</code> VARCHAR(200) Nome comercial do medicamento Noex <code>descricao</code> VARCHAR(500) Descri\u00e7\u00e3o completa do medicamento Budesonida 50mcg spray nasal <code>laboratorio</code> VARCHAR(200) Laborat\u00f3rio fabricante Eurofarma Laborat\u00f3rios Ltda <code>qnt_comprimidos_caixa</code> INT Quantidade de unidades por caixa 60 <code>patologia</code> VARCHAR(100) Patologia para a qual \u00e9 indicado Rinite"},{"location":"arquitetura/tabelas-apoio.html#14-uso-no-sistema","title":"1.4. Uso no Sistema","text":"<p>A tabela \u00e9 utilizada em todas as fases do projeto:</p> Fase Uso Fase 1 Filtrar apenas medicamentos eleg\u00edveis Fase 2 Converter unidades para caixas na query principal Fase 3 Exibir nome do princ\u00edpio ativo nos relat\u00f3rios Fase 4 Classificar medicamentos por patologia nos indicadores"},{"location":"arquitetura/tabelas-apoio.html#15-formula-de-conversao","title":"1.5. F\u00f3rmula de Convers\u00e3o","text":"<p>A convers\u00e3o de unidades para caixas \u00e9 feita com a seguinte f\u00f3rmula:</p> \\[ \\text{Quantidade de Caixas} = \\frac{\\text{qnt\\_autorizada}}{\\text{qnt\\_comprimidos\\_caixa}} \\] <p>Exemplo de Convers\u00e3o</p> <p>Cen\u00e1rio: Venda de 120 comprimidos de um medicamento que vem em caixas de 30.</p> <pre><code>$$\n\\text{Caixas} = \\frac{120}{30} = 4 \\text{ caixas}\n$$\n</code></pre>"},{"location":"arquitetura/tabelas-apoio.html#16-geracao-da-tabela","title":"1.6. Gera\u00e7\u00e3o da Tabela","text":"<p>A tabela \u00e9 gerada pela execu\u00e7\u00e3o do script:</p> <pre><code>\ud83d\udcc4 01 - medicamentosPatologiaFP.sql\n</code></pre>"},{"location":"arquitetura/tabelas-apoio.html#2-outras-tabelas-de-apoio","title":"2. Outras Tabelas de Apoio","text":""},{"location":"arquitetura/tabelas-apoio.html#21-dados-cadastrais-das-farmacias","title":"2.1. Dados Cadastrais das Farm\u00e1cias","text":"Atributo Valor Nome da Tabela <code>temp_CGUSC.dbo.dadosFarmaciasFP</code> Fun\u00e7\u00e3o Consolidar informa\u00e7\u00f5es cadastrais de cada farm\u00e1cia"},{"location":"arquitetura/tabelas-apoio.html#campos-principais","title":"Campos Principais","text":"Campo Descri\u00e7\u00e3o <code>cnpj</code> CNPJ da farm\u00e1cia <code>razaoSocial</code> Raz\u00e3o social da empresa <code>nomeFantasia</code> Nome fantasia <code>municipio</code> Munic\u00edpio de localiza\u00e7\u00e3o <code>uf</code> Unidade da Federa\u00e7\u00e3o <code>logradouro</code>, <code>numero</code>, <code>bairro</code> Endere\u00e7o completo <code>latitude</code>, <code>longitude</code> Coordenadas geogr\u00e1ficas <code>situacaoCadastral</code> Status no cadastro da Receita Federal <code>naturezaJuridica</code> C\u00f3digo da natureza jur\u00eddica <code>porteEmpresa</code> Porte da empresa (MEI, ME, EPP, etc.) <code>outrasSociedades</code> Flag se s\u00f3cios t\u00eam outras farm\u00e1cias"},{"location":"arquitetura/tabelas-apoio.html#22-informacoes-de-contato","title":"2.2. Informa\u00e7\u00f5es de Contato","text":"Atributo Valor Nome da Tabela <code>temp_CGUSC.dbo.contatoFarmacia</code> Fun\u00e7\u00e3o Armazenar dados de contato consolidados"},{"location":"arquitetura/tabelas-apoio.html#campos-principais_1","title":"Campos Principais","text":"Campo Descri\u00e7\u00e3o <code>cnpj</code> CNPJ da farm\u00e1cia <code>telefone</code> Telefone de contato <code>email</code> E-mail de contato <code>responsavelTecnico</code> Nome do respons\u00e1vel t\u00e9cnico"},{"location":"arquitetura/tabelas-apoio.html#23-data-de-inicio-de-venda","title":"2.3. Data de In\u00edcio de Venda","text":"Atributo Valor Nome da Tabela <code>temp_CGUSC.dbo.farmacia_inicio_venda</code> Fun\u00e7\u00e3o Registrar a primeira venda de cada farm\u00e1cia"},{"location":"arquitetura/tabelas-apoio.html#campos-principais_2","title":"Campos Principais","text":"Campo Descri\u00e7\u00e3o <code>cnpj</code> CNPJ da farm\u00e1cia <code>datavendainicial</code> Data da primeira venda no programa <p>Uso</p> <p>Esta tabela \u00e9 utilizada para determinar o ponto de partida da an\u00e1lise de cada farm\u00e1cia. Farm\u00e1cias que iniciaram vendas ap\u00f3s a data de corte (01/07/2015) ter\u00e3o sua an\u00e1lise iniciada na data real de in\u00edcio.</p>"},{"location":"arquitetura/tabelas-apoio.html#24-data-de-inicio-por-produto","title":"2.4. Data de In\u00edcio por Produto","text":"Atributo Valor Nome da Tabela <code>temp_CGUSC.dbo.farmacia_inicio_venda_gtin</code> Fun\u00e7\u00e3o Registrar a primeira venda de cada produto em cada farm\u00e1cia"},{"location":"arquitetura/tabelas-apoio.html#campos-principais_3","title":"Campos Principais","text":"Campo Descri\u00e7\u00e3o <code>cnpj</code> CNPJ da farm\u00e1cia <code>codigo_barra</code> GTIN do medicamento <code>data_primeira_venda</code> Data da primeira venda deste produto <p>Uso</p> <p>Esta tabela \u00e9 fundamental para o c\u00e1lculo do estoque inicial por produto. O sistema busca aquisi\u00e7\u00f5es nos 6 meses anteriores a esta data para estimar o estoque inicial.</p>"},{"location":"arquitetura/tabelas-apoio.html#3-tabelas-de-referencia-externas","title":"3. Tabelas de Refer\u00eancia Externas","text":""},{"location":"arquitetura/tabelas-apoio.html#31-cadastro-de-cnpjs","title":"3.1. Cadastro de CNPJs","text":"Base Tabela Conte\u00fado <code>db_CNPJ</code> <code>dbo.CNPJ</code> Dados cadastrais completos da Receita Federal <code>db_CNPJ</code> <code>dbo.socios</code> Quadro societ\u00e1rio das empresas"},{"location":"arquitetura/tabelas-apoio.html#32-cadastro-de-cpfs","title":"3.2. Cadastro de CPFs","text":"Base Tabela Conte\u00fado <code>db_CPF</code> <code>dbo.CPF</code> Dados cadastrais de pessoas f\u00edsicas"},{"location":"arquitetura/tabelas-apoio.html#33-base-de-obitos","title":"3.3. Base de \u00d3bitos","text":"Base Tabela Conte\u00fado M\u00faltiplas <code>tb_obitos_unificada</code> Registro de \u00f3bitos de diversas fontes (SIM, SIRC, SISOBI)"},{"location":"arquitetura/tabelas-apoio.html#34-dados-demograficos","title":"3.4. Dados Demogr\u00e1ficos","text":"Base Tabela Conte\u00fado <code>sus</code> <code>tb_ibge</code> Popula\u00e7\u00e3o e dados demogr\u00e1ficos por munic\u00edpio"},{"location":"arquitetura/tabelas-apoio.html#35-base-de-medicos","title":"3.5. Base de M\u00e9dicos","text":"Base Tabela Conte\u00fado CFM Base de m\u00e9dicos Registro de m\u00e9dicos com data de inscri\u00e7\u00e3o e situa\u00e7\u00e3o"},{"location":"arquitetura/tabelas-apoio.html#4-relacionamento-entre-tabelas","title":"4. Relacionamento entre Tabelas","text":"erDiagram     medicamentosPatologiaFP ||--o{ VENDAS : \"classifica\"     medicamentosPatologiaFP ||--o{ AQUISICOES : \"classifica\"      dadosFarmaciasFP ||--o{ VENDAS : \"identifica\"     dadosFarmaciasFP ||--o{ AQUISICOES : \"identifica\"     dadosFarmaciasFP ||--|| contatoFarmacia : \"complementa\"     dadosFarmaciasFP ||--o{ tb_sociosFP : \"detalha\"      farmacia_inicio_venda ||--|| dadosFarmaciasFP : \"vincula\"     farmacia_inicio_venda_gtin ||--|| farmacia_inicio_venda : \"detalha\"      medicamentosPatologiaFP {         bigint codigo_barra PK         varchar principio_ativo         int qnt_comprimidos_caixa         varchar patologia     }      dadosFarmaciasFP {         varchar cnpj PK         varchar razaoSocial         varchar municipio         varchar uf     }      farmacia_inicio_venda {         varchar cnpj PK         date datavendainicial     }  <p>Pr\u00f3ximo Passo</p> <p>Veja a Estrutura de Tabelas para conhecer as tabelas de resultado criadas pelo sistema.</p>"},{"location":"execucao/index.html","title":"Execu\u00e7\u00e3o do Sistema","text":"<p>Esta se\u00e7\u00e3o cont\u00e9m as instru\u00e7\u00f5es para configurar o ambiente e executar o Sistema Sentinela.</p>"},{"location":"execucao/index.html#navegacao","title":"Navega\u00e7\u00e3o","text":"<ul> <li> Pr\u00e9-requisitos</li> </ul> <p>Software e dados necess\u00e1rios para executar o sistema.</p> <p> Ver pr\u00e9-requisitos</p> <ul> <li> Guia de Execu\u00e7\u00e3o</li> </ul> <p>Instru\u00e7\u00f5es passo a passo para executar cada fase.</p> <p> Ver guia</p>"},{"location":"execucao/index.html#visao-geral-do-processo","title":"Vis\u00e3o Geral do Processo","text":"flowchart LR     A[1. ConfigurarAmbiente] --&gt; B[2. PrepararBanco SQL]     B --&gt; C[3. ExecutarPython]     C --&gt; D[4. P\u00f3s-Processamento]     D --&gt; E[5. VerificarResultados]"},{"location":"execucao/index.html#tempo-estimado","title":"Tempo Estimado","text":"Fase Tempo Estimado Observa\u00e7\u00e3o Configura\u00e7\u00e3o do ambiente 30 min Uma \u00fanica vez Fase 1 (SQL) 2-4 horas Depende do volume Fase 2 (Python) V\u00e1rios dias ~34.000 CNPJs Fase 4 (SQL) 1-2 horas Ap\u00f3s Python terminar Verifica\u00e7\u00e3o 30 min Consultas de valida\u00e7\u00e3o"},{"location":"execucao/index.html#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ol> <li>Verifique os Pr\u00e9-requisitos</li> <li>Siga o Guia de Execu\u00e7\u00e3o</li> </ol>"},{"location":"execucao/guia-execucao.html","title":"Guia de Execu\u00e7\u00e3o Passo a Passo","text":"<p>Este guia detalha o processo completo para executar o Sistema Sentinela, desde a configura\u00e7\u00e3o at\u00e9 a gera\u00e7\u00e3o dos resultados.</p>"},{"location":"execucao/guia-execucao.html#1-visao-geral","title":"1. Vis\u00e3o Geral","text":"flowchart TD     A[PASSO 1Prepara\u00e7\u00e3o SQL] --&gt; B[PASSO 2Stored Procedure]     B --&gt; C[PASSO 3Ambiente Python]     C --&gt; D[PASSO 4Execu\u00e7\u00e3o Python]     D --&gt; E[PASSO 5P\u00f3s-Processamento]     E --&gt; F[PASSO 6Indicadores]     F --&gt; G[PASSO 7Verifica\u00e7\u00e3o]"},{"location":"execucao/guia-execucao.html#2-passo-1-preparacao-do-banco-de-dados","title":"2. PASSO 1: Prepara\u00e7\u00e3o do Banco de Dados","text":""},{"location":"execucao/guia-execucao.html#21-conectar-ao-banco","title":"2.1. Conectar ao Banco","text":"<ol> <li>Abra o SQL Server Management Studio (SSMS)</li> <li>Conecte-se \u00e0 inst\u00e2ncia do SQL Server (ex: <code>SDH-DIE-BD</code>)</li> <li>Defina o contexto para a base de trabalho:</li> </ol> <pre><code>USE [temp_CGUSC];\n</code></pre>"},{"location":"execucao/guia-execucao.html#22-abrir-script-de-preparacao","title":"2.2. Abrir Script de Prepara\u00e7\u00e3o","text":"<p>Abra o arquivo:</p> <pre><code>\ud83d\udcc4 01 - preparacao_dados.sql\n</code></pre>"},{"location":"execucao/guia-execucao.html#23-executar","title":"2.3. Executar","text":"<ol> <li>Pressione F5 ou clique em \"Execute\"</li> <li>Aguarde a conclus\u00e3o (pode levar algumas horas)</li> </ol>"},{"location":"execucao/guia-execucao.html#24-verificar","title":"2.4. Verificar","text":"<p>Ap\u00f3s a conclus\u00e3o, verifique se as tabelas foram criadas:</p> <pre><code>-- Verificar quantidade de CNPJs\nSELECT COUNT(*) AS total_cnpjs FROM temp_CGUSC.dbo.lista_cnpjs;\n\n-- Verificar estoque inicial\nSELECT COUNT(*) AS total_estoques FROM temp_CGUSC.dbo.estoque_inicialFP;\n\n-- Verificar particionamento\nSELECT classif, COUNT(*) AS qtd\nFROM temp_CGUSC.dbo.classif\nGROUP BY classif\nORDER BY classif;\n</code></pre> <p>!!! success \"Resultado Esperado\" - <code>lista_cnpjs</code>: ~34.000 registros - <code>estoque_inicialFP</code>: Varia (milh\u00f5es) - <code>classif</code>: 100 lotes balanceados</p>"},{"location":"execucao/guia-execucao.html#3-passo-2-criar-stored-procedure","title":"3. PASSO 2: Criar Stored Procedure","text":""},{"location":"execucao/guia-execucao.html#31-abrir-script","title":"3.1. Abrir Script","text":"<p>Abra o arquivo:</p> <pre><code>\ud83d\udcc4 03 - procPreparaDados.sql\n</code></pre>"},{"location":"execucao/guia-execucao.html#32-executar","title":"3.2. Executar","text":"<ol> <li>Execute o script inteiro</li> <li>Este script n\u00e3o insere dados - apenas cria o objeto reutiliz\u00e1vel</li> </ol>"},{"location":"execucao/guia-execucao.html#33-verificar","title":"3.3. Verificar","text":"<p>Confirme a cria\u00e7\u00e3o no Pesquisador de Objetos:</p> <pre><code>temp_CGUSC &gt; Programmability &gt; Stored Procedures &gt; dbo.procPreparaDados\n</code></pre>"},{"location":"execucao/guia-execucao.html#4-passo-3-configurar-ambiente-python","title":"4. PASSO 3: Configurar Ambiente Python","text":""},{"location":"execucao/guia-execucao.html#41-criar-ambiente-virtual","title":"4.1. Criar Ambiente Virtual","text":"<pre><code># Navegue at\u00e9 a pasta do projeto\ncd \"C:\\caminho\\para\\projeto\\sentinela\"\n\n# Crie o ambiente virtual\npython -m venv venv\n\n# Ative o ambiente\n.\\venv\\Scripts\\activate\n</code></pre>"},{"location":"execucao/guia-execucao.html#42-instalar-dependencias","title":"4.2. Instalar Depend\u00eancias","text":"<pre><code>pip install -r requirements.txt\n</code></pre> <p>Se n\u00e3o tiver o <code>requirements.txt</code>, instale manualmente:</p> <pre><code>pip install pyodbc==5.1.0 pandas==2.2.2 XlsxWriter==3.2.0 tqdm==4.66.4 art==6.1\n</code></pre>"},{"location":"execucao/guia-execucao.html#43-verificar-instalacao","title":"4.3. Verificar Instala\u00e7\u00e3o","text":"<pre><code>pip list\n</code></pre> <p>Deve mostrar todas as bibliotecas instaladas.</p>"},{"location":"execucao/guia-execucao.html#5-passo-4-executar-analise-python","title":"5. PASSO 4: Executar An\u00e1lise Python","text":""},{"location":"execucao/guia-execucao.html#51-abrir-script","title":"5.1. Abrir Script","text":"<p>Abra o arquivo:</p> <pre><code>\ud83d\udcc4 sentinelav8.py\n</code></pre>"},{"location":"execucao/guia-execucao.html#52-ajustar-parametros","title":"5.2. Ajustar Par\u00e2metros","text":"<p>Obrigat\u00f3rio</p> <p>Ajuste as datas para corresponder \u00e0s definidas no SQL:</p> <pre><code># Linhas 46-47 (aproximadamente)\nDATA_INICIAL_ANALISE = '2015-07-01'\nDATA_FINAL_ANALISE = datetime.strptime('2024-12-10', '%Y-%m-%d').date()\n</code></pre>"},{"location":"execucao/guia-execucao.html#53-executar","title":"5.3. Executar","text":"Via TerminalVia IDE <pre><code>python sentinelav8.py\n</code></pre> <ol> <li>Abra o script na IDE</li> <li>Configure o interpretador para usar o <code>venv</code></li> <li>Execute (F5 ou bot\u00e3o Run)</li> </ol>"},{"location":"execucao/guia-execucao.html#54-acompanhar-progresso","title":"5.4. Acompanhar Progresso","text":"<p>O terminal exibir\u00e1 duas barras de progresso:</p> <pre><code>Progresso Geral: |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591| 40/100 [4:23:15&lt;6:34:22]\nBloco 40:        |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2591\u2591\u2591\u2591\u2591\u2591| 280/350 [00:45:12&lt;00:11:23]\n</code></pre> <ul> <li>Barra superior: Progresso dos 100 lotes</li> <li>Barra inferior: Progresso dentro do lote atual</li> </ul>"},{"location":"execucao/guia-execucao.html#55-tempo-estimado","title":"5.5. Tempo Estimado","text":"<p>Longa Execu\u00e7\u00e3o</p> <p>O processamento de cada CNPJ leva 15 segundos.</p>"},{"location":"execucao/guia-execucao.html#6-passo-5-pos-processamento","title":"6. PASSO 5: P\u00f3s-Processamento","text":"<p>Ap\u00f3s a conclus\u00e3o do Python, execute o p\u00f3s-processamento para consolidar os resultados.</p>"},{"location":"execucao/guia-execucao.html#61-abrir-script","title":"6.1. Abrir Script","text":"<pre><code>\ud83d\udcc4 05 - pos_processamento.sql\n</code></pre>"},{"location":"execucao/guia-execucao.html#62-executar","title":"6.2. Executar","text":"<ol> <li>Retorne ao SSMS</li> <li>Execute o script inteiro</li> </ol>"},{"location":"execucao/guia-execucao.html#63-verificar","title":"6.3. Verificar","text":"<pre><code>-- Verificar tabela consolidada\nSELECT TOP 100 *\nFROM temp_CGUSC.dbo.resultado_Sentinela_2015_2024\nORDER BY valor_sem_comprovacao DESC;\n</code></pre>"},{"location":"execucao/guia-execucao.html#7-passo-6-calcular-indicadores","title":"7. PASSO 6: Calcular Indicadores","text":"<p>Execute os scripts de indicadores na pasta <code>Indicadores/</code>:</p>"},{"location":"execucao/guia-execucao.html#71-ordem-de-execucao-sugerida","title":"7.1. Ordem de Execu\u00e7\u00e3o (Sugerida)","text":"<ol> <li> <p>Scripts de c\u00e1lculo individual (em qualquer ordem):</p> </li> <li> <p><code>falecidos.sql</code></p> </li> <li><code>inconsistencia_clinica.sql</code></li> <li><code>teto.sql</code></li> <li> <p>... (demais indicadores)</p> </li> <li> <p>Por \u00faltimo, execute:</p> </li> <li><code>matriz_risco_final.sql</code></li> </ol>"},{"location":"execucao/guia-execucao.html#72-verificar","title":"7.2. Verificar","text":"<pre><code>-- Verificar matriz de risco\nSELECT TOP 100 *, CLASSIFICACAO_RISCO\nFROM temp_CGUSC.dbo.Matriz_Risco_Final\nORDER BY SCORE_RISCO_FINAL DESC;\n</code></pre>"},{"location":"execucao/guia-execucao.html#8-passo-7-verificacao-final","title":"8. PASSO 7: Verifica\u00e7\u00e3o Final","text":""},{"location":"execucao/guia-execucao.html#81-checklist-de-validacao","title":"8.1. Checklist de Valida\u00e7\u00e3o","text":"<ul> <li> Todos os CNPJs processados (status != 2 RUNNING)</li> <li> Tabela <code>resultado_Sentinela</code> populada</li> <li> Matriz de Risco com classifica\u00e7\u00f5es</li> <li> Rankings calculados</li> <li> Relat\u00f3rios Excel gerados</li> </ul>"},{"location":"execucao/guia-execucao.html#82-consultas-de-verificacao","title":"8.2. Consultas de Verifica\u00e7\u00e3o","text":"<pre><code>-- Status dos processamentos\nSELECT situacao, COUNT(*) as qtd\nFROM temp_CGUSC.dbo.processamentosFP\nGROUP BY situacao;\n\n-- Distribui\u00e7\u00e3o de risco\nSELECT CLASSIFICACAO_RISCO, COUNT(*) as qtd\nFROM temp_CGUSC.dbo.Matriz_Risco_Final\nGROUP BY CLASSIFICACAO_RISCO\nORDER BY qtd DESC;\n\n-- Top 10 irregulares\nSELECT TOP 10 cnpj, razaoSocial, valor_sem_comprovacao\nFROM temp_CGUSC.dbo.resultado_Sentinela_2015_2024\nORDER BY valor_sem_comprovacao DESC;\n</code></pre>"},{"location":"execucao/guia-execucao.html#9-retomada-de-execucao","title":"9. Retomada de Execu\u00e7\u00e3o","text":""},{"location":"execucao/guia-execucao.html#91-se-o-python-parar","title":"9.1. Se o Python Parar","text":"<p>O sistema possui mecanismo de retomada autom\u00e1tica:</p> <ol> <li>Os CNPJs j\u00e1 processados (status SUCCESS) s\u00e3o pulados</li> <li>O \u00faltimo CNPJ incompleto (status RUNNING) \u00e9 limpo e reprocessado</li> <li>Basta executar <code>sentinelav8.py</code> novamente</li> </ol>"},{"location":"execucao/guia-execucao.html#92-se-o-sql-falhar","title":"9.2. Se o SQL Falhar","text":"<p>Se o script SQL falhar:</p> <ol> <li>Identifique o ponto de falha no log de erros</li> <li>Execute apenas as etapas pendentes</li> <li>Alguns scripts podem ser re-executados sem problemas (s\u00e3o idempotentes)</li> </ol>"},{"location":"execucao/guia-execucao.html#10-geracao-de-relatorios-sob-demanda","title":"10. Gera\u00e7\u00e3o de Relat\u00f3rios Sob Demanda","text":"<p>Para gerar relat\u00f3rio de um CNPJ espec\u00edfico ap\u00f3s o processamento:</p> <pre><code>python gerar_relatorio_memoriav8.py 12345678000199 1\n</code></pre> <p>Onde:</p> <ul> <li><code>12345678000199</code> = CNPJ a gerar</li> <li><code>1</code> = Tipo (1=Completo, 2=Resumido)</li> </ul>"},{"location":"execucao/pre-requisitos.html","title":"Pr\u00e9-requisitos","text":"<p>Esta p\u00e1gina lista todos os componentes de software e dados necess\u00e1rios para executar o Sistema Sentinela.</p>"},{"location":"execucao/pre-requisitos.html#1-software","title":"1. Software","text":""},{"location":"execucao/pre-requisitos.html#11-banco-de-dados","title":"1.1. Banco de Dados","text":"Software Vers\u00e3o M\u00ednima Uso Microsoft SQL Server 2016+ Armazenamento e processamento SQL Server Management Studio (SSMS) 18+ Interface para execu\u00e7\u00e3o de scripts"},{"location":"execucao/pre-requisitos.html#12-python","title":"1.2. Python","text":"Software Vers\u00e3o Uso Python 3.8+ Processamento e gera\u00e7\u00e3o de relat\u00f3rios IDE (recomendado) PyCharm ou VS Code Desenvolvimento e execu\u00e7\u00e3o"},{"location":"execucao/pre-requisitos.html#13-drivers","title":"1.3. Drivers","text":"Driver Obrigat\u00f3rio Uso Microsoft ODBC Driver 17 for SQL Server \u2705 Sim Conex\u00e3o Python \u2192 SQL Server <p>Driver ODBC</p> <p>O driver ODBC deve ser instalado separadamente do Python. Baixe em: https://docs.microsoft.com/sql/connect/odbc/download-odbc-driver-for-sql-server</p>"},{"location":"execucao/pre-requisitos.html#2-bibliotecas-python","title":"2. Bibliotecas Python","text":""},{"location":"execucao/pre-requisitos.html#21-arquivo-requirementstxt","title":"2.1. Arquivo requirements.txt","text":"<p>Crie um arquivo <code>requirements.txt</code> na pasta do projeto com o seguinte conte\u00fado:</p> <pre><code>pyodbc==5.1.0\npandas==2.2.2\nXlsxWriter==3.2.0\ntqdm==4.66.4\nart==6.1\n</code></pre>"},{"location":"execucao/pre-requisitos.html#22-instalacao","title":"2.2. Instala\u00e7\u00e3o","text":"Windows (PowerShell)Linux/Mac <pre><code># Criar ambiente virtual\npython -m venv venv\n\n# Ativar ambiente\n.\\venv\\Scripts\\activate\n\n# Instalar depend\u00eancias\npip install -r requirements.txt\n</code></pre> <pre><code># Criar ambiente virtual\npython3 -m venv venv\n\n# Ativar ambiente\nsource venv/bin/activate\n\n# Instalar depend\u00eancias\npip install -r requirements.txt\n</code></pre>"},{"location":"execucao/pre-requisitos.html#23-detalhamento-das-bibliotecas","title":"2.3. Detalhamento das Bibliotecas","text":"Biblioteca Vers\u00e3o Fun\u00e7\u00e3o <code>pyodbc</code> 5.1.0 Conex\u00e3o com SQL Server via ODBC <code>pandas</code> 2.2.2 Manipula\u00e7\u00e3o de dados tabulares <code>XlsxWriter</code> 3.2.0 Gera\u00e7\u00e3o de planilhas Excel formatadas <code>tqdm</code> 4.66.4 Barras de progresso no terminal <code>art</code> 6.1 Arte ASCII para interface do terminal"},{"location":"execucao/pre-requisitos.html#3-bases-de-dados","title":"3. Bases de Dados","text":""},{"location":"execucao/pre-requisitos.html#31-bases-primarias-obrigatorias","title":"3.1. Bases Prim\u00e1rias (Obrigat\u00f3rias)","text":"Base Conte\u00fado Acesso Necess\u00e1rio <code>db_farmaciapopular</code> Vendas do programa Leitura <code>db_farmaciapopular_nf</code> Notas Fiscais de aquisi\u00e7\u00e3o Leitura <code>db_CNPJ</code> Cadastro de empresas Leitura <code>db_CPF</code> Cadastro de pessoas Leitura <code>temp_CGUSC</code> Base de trabalho Leitura e Escrita"},{"location":"execucao/pre-requisitos.html#32-bases-complementares","title":"3.2. Bases Complementares","text":"Base Conte\u00fado Uso <code>db_Cadunico</code> Cadastro \u00danico Indicadores <code>db_CFM</code> Registro de m\u00e9dicos Valida\u00e7\u00e3o de CRMs <code>tb_obitos_unificada</code> \u00d3bitos Indicador de falecidos <code>tb_ibge</code> Demografia Indicadores per capita"},{"location":"execucao/pre-requisitos.html#4-permissoes","title":"4. Permiss\u00f5es","text":""},{"location":"execucao/pre-requisitos.html#41-sql-server","title":"4.1. SQL Server","text":"Base Permiss\u00e3o Necess\u00e1ria <code>db_farmaciapopular</code> SELECT <code>db_farmaciapopular_nf</code> SELECT <code>db_CNPJ</code> SELECT <code>db_CPF</code> SELECT <code>temp_CGUSC</code> SELECT, INSERT, UPDATE, DELETE, CREATE TABLE, EXECUTE"},{"location":"execucao/pre-requisitos.html#42-sistema-de-arquivos","title":"4.2. Sistema de Arquivos","text":"<ul> <li>Permiss\u00e3o de escrita na pasta onde ser\u00e3o salvos os relat\u00f3rios Excel</li> <li>Permiss\u00e3o de escrita para o arquivo de log</li> </ul>"},{"location":"execucao/pre-requisitos.html#5-configuracao-do-ambiente","title":"5. Configura\u00e7\u00e3o do Ambiente","text":""},{"location":"execucao/pre-requisitos.html#51-conexao-com-banco-de-dados","title":"5.1. Conex\u00e3o com Banco de Dados","text":"<p>O script Python usa autentica\u00e7\u00e3o Windows (Trusted Connection). Verifique se seu usu\u00e1rio Windows tem acesso ao SQL Server:</p> <pre><code># Configura\u00e7\u00e3o no sentinelav8.py\nconn_str = (\n    'Driver={ODBC Driver 17 for SQL Server};'\n    'Server=SDH-DIE-BD;'\n    'Database=temp_CGUSC;'\n    'Trusted_Connection=yes;'\n)\n</code></pre>"},{"location":"execucao/pre-requisitos.html#52-ajuste-de-parametros","title":"5.2. Ajuste de Par\u00e2metros","text":"<p>Antes de executar, ajuste os par\u00e2metros de data nos scripts:</p> Script Linha Par\u00e2metro <code>01 - preparacao_dados.sql</code> 9, 41, 288 Datas do per\u00edodo <code>sentinelav8.py</code> 46-47 <code>DATA_INICIAL_ANALISE</code>, <code>DATA_FINAL_ANALISE</code>"},{"location":"execucao/pre-requisitos.html#6-checklist-de-pre-requisitos","title":"6. Checklist de Pr\u00e9-requisitos","text":""},{"location":"execucao/pre-requisitos.html#61-software","title":"6.1. Software","text":"<ul> <li> SQL Server Management Studio instalado</li> <li> Acesso ao servidor SQL Server</li> <li> Python 3.8+ instalado</li> <li> ODBC Driver 17 instalado</li> <li> IDE Python configurada (opcional)</li> </ul>"},{"location":"execucao/pre-requisitos.html#62-dados","title":"6.2. Dados","text":"<ul> <li> Acesso a db_farmaciapopular</li> <li> Acesso a db_farmaciapopular_nf</li> <li> Acesso a db_CNPJ</li> <li> Acesso a temp_CGUSC (leitura e escrita)</li> </ul>"},{"location":"execucao/pre-requisitos.html#63-ambiente-python","title":"6.3. Ambiente Python","text":"<ul> <li> Ambiente virtual criado</li> <li> Depend\u00eancias instaladas</li> <li> Conex\u00e3o com banco testada</li> </ul>"},{"location":"execucao/pre-requisitos.html#64-parametros","title":"6.4. Par\u00e2metros","text":"<ul> <li> Datas de an\u00e1lise definidas</li> <li> Pasta de sa\u00edda configurada</li> </ul> <p>Pr\u00f3ximo Passo</p> <p>Ap\u00f3s verificar todos os pr\u00e9-requisitos, siga o Guia de Execu\u00e7\u00e3o.</p>"},{"location":"guia/index.html","title":"Vis\u00e3o Geral","text":"<p>Esta se\u00e7\u00e3o apresenta uma vis\u00e3o completa do Projeto Sentinela, incluindo seu contexto, objetivos e resultados alcan\u00e7ados.</p>"},{"location":"guia/index.html#navegacao","title":"Navega\u00e7\u00e3o","text":"<ul> <li> Resumo do Projeto</li> </ul> <p>Informa\u00e7\u00f5es gerais, equipe respons\u00e1vel, per\u00edodo de an\u00e1lise e produtos gerados.</p> <p> Ver resumo</p> <ul> <li> Contexto e Objetivos</li> </ul> <p>Descri\u00e7\u00e3o do Programa Farm\u00e1cia Popular, problema identificado e objetivos da auditoria.</p> <p> Ver contexto</p> <ul> <li> Resultados Alcan\u00e7ados</li> </ul> <p>N\u00fameros consolidados das rodadas de an\u00e1lise e impacto das descobertas.</p> <p> Ver resultados</p>"},{"location":"guia/contexto.html","title":"\ud83d\udcd6 Contexto e Objetivos","text":""},{"location":"guia/contexto.html#i-1-o-programa-farmacia-popular-do-brasil","title":"\u2139\ufe0f 1. O Programa Farm\u00e1cia Popular do Brasil","text":""},{"location":"guia/contexto.html#11-descricao-do-programa","title":"1.1. Descri\u00e7\u00e3o do Programa","text":"<p>O Programa Farm\u00e1cia Popular do Brasil (PFPB), institu\u00eddo pela Lei n\u00ba 10.858/2004, \u00e9 uma das maiores pol\u00edticas p\u00fablicas de acesso a medicamentos do pa\u00eds. O programa visa ampliar o acesso da popula\u00e7\u00e3o a medicamentos essenciais, oferecendo-os a pre\u00e7os subsidiados ou gratuitamente.</p>"},{"location":"guia/contexto.html#12-modalidade-aqui-tem-farmacia-popular","title":"1.2. Modalidade \"Aqui Tem Farm\u00e1cia Popular\"","text":"<p>O Projeto Sentinela foca na modalidade \"Aqui Tem Farm\u00e1cia Popular\", onde:</p> <ul> <li>O governo federal firma conv\u00eanio com farm\u00e1cias privadas em todo o territ\u00f3rio nacional</li> <li>Os estabelecimentos vendem medicamentos a pre\u00e7os subsidiados ou gratuitos</li> <li>O governo ressarce as farm\u00e1cias pelo valor do subs\u00eddio concedido</li> <li>O ressarcimento \u00e9 feito com base nos registros do Sistema Autorizador de Vendas</li> </ul>"},{"location":"guia/contexto.html#13-patologias-cobertas","title":"1.3. Patologias Cobertas","text":"<p>O programa cobre medicamentos para tratamento das seguintes condi\u00e7\u00f5es cr\u00f4nicas:</p> Patologia Medicamentos Inclu\u00eddos Hipertens\u00e3o Anti-hipertensivos diversos Diabetes Insulinas e antidiab\u00e9ticos orais Asma Broncodilatadores e corticoides inalat\u00f3rios Rinite Corticoides nasais Parkinson Levodopa, pramipexol, entacapona Osteoporose Alendronato, risedronato Glaucoma Col\u00edrios espec\u00edficos"},{"location":"guia/contexto.html#14-numeros-do-programa","title":"1.4. N\u00fameros do Programa","text":"<p>!!! info \"Dimens\u00e3o do Programa\" - 34.000+ farm\u00e1cias credenciadas em todo o Brasil - Bilh\u00f5es de reais em ressarcimentos anuais - Milh\u00f5es de benefici\u00e1rios atendidos - Cobertura em todos os munic\u00edpios brasileiros</p>"},{"location":"guia/contexto.html#2-o-problema-identificado","title":"\ud83d\udeab 2. O Problema Identificado","text":""},{"location":"guia/contexto.html#21-vulnerabilidades-do-sistema","title":"2.1. Vulnerabilidades do Sistema","text":"<p>O modelo de ressarcimento do PFPB apresenta vulnerabilidades que podem ser exploradas por estabelecimentos mal-intencionados:</p> flowchart TD     A[\"Farm\u00e1cia Solicita Ressarcimento\"] --&gt; B{\"Verifica\u00e7\u00e3o do MS\"}     B --&gt;|Aprovado| C[\"Governo Paga\"]     B --&gt;|Negado| D[\"Ressarcimento Bloqueado\"]      C --&gt; E[\"\u274c Problema: Verifica\u00e7\u00e3o Limitada\"]     E --&gt; F[\"N\u00e3o h\u00e1 cruzamentocom compras reais\"]"},{"location":"guia/contexto.html#22-tipos-de-irregularidades-detectadas","title":"2.2. Tipos de Irregularidades Detectadas","text":"<p>A an\u00e1lise preliminar dos dados identificou padr\u00f5es recorrentes de irregularidades:</p>"},{"location":"guia/contexto.html#221-vendas-sem-lastro-em-estoque","title":"2.2.1. Vendas sem Lastro em Estoque","text":"<p>A irregularidade mais comum ocorre quando uma farm\u00e1cia registra mais vendas do que medicamentos adquiriu:</p> <p>Exemplo de Irregularidade</p> <p>Situa\u00e7\u00e3o: Farm\u00e1cia comprou 100 caixas de medicamento X no per\u00edodo.</p> <pre><code>**Problema:** Registrou a venda de 500 caixas no mesmo per\u00edodo.\n\n**Resultado:** 400 caixas vendidas SEM COMPROVA\u00c7\u00c3O de aquisi\u00e7\u00e3o.\n</code></pre>"},{"location":"guia/contexto.html#222-padroes-atipicos-de-prescricao","title":"2.2.2. Padr\u00f5es At\u00edpicos de Prescri\u00e7\u00e3o","text":"<ul> <li>Concentra\u00e7\u00e3o excessiva de vendas em poucos m\u00e9dicos prescritores</li> <li>M\u00e9dicos com volume de prescri\u00e7\u00f5es fora do comum (&gt;30/dia)</li> <li>Uso de CRMs inexistentes ou cancelados</li> <li>Prescri\u00e7\u00f5es emitidas antes da data de registro do m\u00e9dico no CFM</li> </ul>"},{"location":"guia/contexto.html#223-anomalias-cadastrais","title":"2.2.3. Anomalias Cadastrais","text":"<ul> <li>Vendas para benefici\u00e1rios j\u00e1 falecidos</li> <li>Dispensa\u00e7\u00f5es incompat\u00edveis com o perfil cl\u00ednico do paciente</li> <li>Pacientes de outras unidades da federa\u00e7\u00e3o sem justificativa</li> </ul>"},{"location":"guia/contexto.html#224-padroes-operacionais-suspeitos","title":"2.2.4. Padr\u00f5es Operacionais Suspeitos","text":"<ul> <li>Vendas consecutivas em menos de 60 segundos (indicativo de automa\u00e7\u00e3o)</li> <li>Concentra\u00e7\u00e3o de vendas na madrugada (00h-06h)</li> <li>Ticket m\u00e9dio muito acima da m\u00e9dia do mercado</li> <li>Dispensa\u00e7\u00e3o sempre no teto m\u00e1ximo permitido</li> </ul>"},{"location":"guia/contexto.html#3-a-premissa-fundamental","title":"\ud83c\udfaf 3. A Premissa Fundamental","text":""},{"location":"guia/contexto.html#31-o-principio-central","title":"3.1. O Princ\u00edpio Central","text":"<p>Premissa da Auditoria</p> <p>\"Um estabelecimento n\u00e3o pode vender aquilo que n\u00e3o comprou.\"</p> <pre><code>Esta premissa simples, por\u00e9m poderosa, fundamenta toda a l\u00f3gica de auditoria do Sistema Sentinela.\n</code></pre>"},{"location":"guia/contexto.html#32-base-legal-e-documental","title":"3.2. Base Legal e Documental","text":"<p>A verifica\u00e7\u00e3o se sustenta em duas bases de dados oficiais:</p> flowchart LR     subgraph S1[\"farm\u00e1cia VENDEU\"]         A[\"Sistema AutorizadorMinist\u00e9rio da Sa\u00fade\"]     end      subgraph S2[\"farm\u00e1cia COMPROU\"]         B[\"Notas Fiscais Eletr\u00f4nicasReceita Federal\"]     end        A &lt;--&gt;|Cruzamento| C{\"SENTINELA\"}     B &lt;--&gt;|Cruzamento| C      C --&gt;|Consistente| D[\"\u2705 Venda Regular\"]     C --&gt;|Inconsistente| E[\"\u274c Venda Sem Comprova\u00e7\u00e3o\"]"},{"location":"guia/contexto.html#33-por-que-essa-abordagem-funciona","title":"3.3. Por que essa abordagem funciona?","text":"<p>A metodologia \u00e9 s\u00f3lida porque:</p> <ol> <li>Dados oficiais: Utiliza bases governamentais</li> <li>Rastreabilidade: Cada venda \u00e9 vinculada a notas fiscais espec\u00edficas</li> <li>Objetividade: O c\u00e1lculo \u00e9 matem\u00e1tico, n\u00e3o subjetivo</li> <li>Auditabilidade: Todas as etapas s\u00e3o documentadas e reproduz\u00edveis</li> </ol>"},{"location":"guia/contexto.html#4-objetivos-do-projeto","title":"\ud83d\ude80 4. Objetivos do Projeto","text":""},{"location":"guia/contexto.html#41-objetivo-geral","title":"4.1. Objetivo Geral","text":"<p>Objetivo Principal</p> <p>Desenvolver e operacionalizar um sistema automatizado de auditoria capaz de identificar, quantificar e documentar irregularidades nas dispensa\u00e7\u00f5es do Programa Farm\u00e1cia Popular do Brasil.</p>"},{"location":"guia/contexto.html#42-objetivos-especificos","title":"4.2. Objetivos Espec\u00edficos","text":""},{"location":"guia/contexto.html#421-analise-de-fluxo-de-estoque","title":"4.2.1. An\u00e1lise de Fluxo de Estoque","text":"<ul> <li>Construir simula\u00e7\u00e3o de fluxo de estoque para cada farm\u00e1cia credenciada</li> <li>Processar todas as transa\u00e7\u00f5es de entrada (compras) e sa\u00edda (vendas)</li> <li>Identificar per\u00edodos de saldo negativo (vendas sem lastro)</li> <li>Quantificar o valor financeiro das irregularidades</li> </ul>"},{"location":"guia/contexto.html#422-matriz-de-risco","title":"4.2.2. Matriz de Risco","text":"<ul> <li>Desenvolver 17 indicadores independentes de risco e fraude</li> <li>Calcular Risco Relativo comparando cada farm\u00e1cia com a m\u00e9dia do mercado</li> <li>Gerar classifica\u00e7\u00e3o de risco (Cr\u00edtico, Alto, M\u00e9dio, Baixo, M\u00ednimo)</li> <li>Criar rankings nacional, estadual e municipal</li> </ul>"},{"location":"guia/contexto.html#423-analise-de-prescritores","title":"4.2.3. An\u00e1lise de Prescritores","text":"<ul> <li>Identificar padr\u00f5es an\u00f4malos de prescri\u00e7\u00e3o m\u00e9dica</li> <li>Validar regularidade dos CRMs junto ao Conselho Federal de Medicina</li> <li>Detectar concentra\u00e7\u00e3o em poucos prescritores</li> <li>Flagrar m\u00e9dicos com comportamento de \"rob\u00f4\" (volume imposs\u00edvel)</li> </ul>"},{"location":"guia/contexto.html#424-relatorios-e-documentacao","title":"4.2.4. Relat\u00f3rios e Documenta\u00e7\u00e3o","text":"<ul> <li>Gerar dossi\u00eas individualizados para cada farm\u00e1cia</li> <li>Incluir mem\u00f3ria de c\u00e1lculo completa (rastreabilidade)</li> <li>Disponibilizar vers\u00e3o resumida para triagem r\u00e1pida</li> <li>Alimentar painel gerencial para prioriza\u00e7\u00e3o de casos</li> </ul>"},{"location":"guia/contexto.html#5-justificativa","title":"\u2696\ufe0f 5. Justificativa","text":""},{"location":"guia/contexto.html#51-impacto-financeiro","title":"5.1. Impacto Financeiro","text":"<p>O Programa Farm\u00e1cia Popular movimenta bilh\u00f5es de reais anualmente. Mesmo pequenos percentuais de irregularidade representam:</p> <ul> <li>Preju\u00edzo significativo aos cofres p\u00fablicos</li> <li>Recursos desviados que poderiam atender mais benefici\u00e1rios leg\u00edtimos</li> <li>Enriquecimento il\u00edcito de estabelecimentos fraudulentos</li> </ul>"},{"location":"guia/contexto.html#52-impossibilidade-de-auditoria-manual","title":"5.2. Impossibilidade de Auditoria Manual","text":"<p>Com mais de 34.000 farm\u00e1cias e milh\u00f5es de transa\u00e7\u00f5es por m\u00eas, \u00e9 imposs\u00edvel realizar auditoria individual de forma manual. O sistema automatizado permite:</p> <ul> <li>Processar 100% das farm\u00e1cias credenciadas</li> <li>Analisar todo o per\u00edodo hist\u00f3rico dispon\u00edvel</li> <li>Aplicar crit\u00e9rios uniformes de an\u00e1lise</li> <li>Identificar irregularidades em escala nacional</li> </ul>"},{"location":"guia/contexto.html#53-suporte-a-acoes-de-controle","title":"5.3. Suporte a A\u00e7\u00f5es de Controle","text":"<p>Os resultados do Sentinela subsidiam diversas a\u00e7\u00f5es:</p> A\u00e7\u00e3o \u00d3rg\u00e3o Tipo de Uso Auditorias presenciais CGU Sele\u00e7\u00e3o de alvos priorit\u00e1rios Descredenciamento MS/SCTIE Farm\u00e1cias de alto risco Investiga\u00e7\u00f5es PF/MPF Provas t\u00e9cnicas de irregularidade Recupera\u00e7\u00e3o de valores AGU C\u00e1lculo de dano ao er\u00e1rio"},{"location":"guia/contexto.html#6-beneficios-esperados","title":"\ud83c\udf1f 6. Benef\u00edcios Esperados","text":""},{"location":"guia/contexto.html#61-para-o-controle","title":"6.1. Para o Controle","text":"<ul> <li>\u2705 Aumento da cobertura de fiscaliza\u00e7\u00e3o</li> <li>\u2705 Redu\u00e7\u00e3o de custos de auditoria</li> <li>\u2705 Prioriza\u00e7\u00e3o de casos de maior risco</li> <li>\u2705 Padroniza\u00e7\u00e3o de crit\u00e9rios de an\u00e1lise</li> </ul>"},{"location":"guia/contexto.html#62-para-o-programa","title":"6.2. Para o Programa","text":"<ul> <li>\u2705 Inibi\u00e7\u00e3o de fraudes pelo efeito dissuas\u00f3rio</li> <li>\u2705 Saneamento do rol de credenciados</li> <li>\u2705 Melhoria da qualidade dos dados</li> <li>\u2705 Economia de recursos p\u00fablicos</li> </ul>"},{"location":"guia/contexto.html#63-para-os-beneficiarios","title":"6.3. Para os Benefici\u00e1rios","text":"<ul> <li>\u2705 Garantia de acesso a medicamentos reais</li> <li>\u2705 Seguran\u00e7a nas dispensa\u00e7\u00f5es</li> <li>\u2705 Confian\u00e7a no programa</li> </ul>"},{"location":"guia/resultados.html","title":"Resultados Alcan\u00e7ados","text":""},{"location":"guia/resultados.html#1-visao-geral-dos-resultados","title":"1. Vis\u00e3o Geral dos Resultados","text":"<p>O Projeto Sentinela foi executado em duas rodadas principais, cobrindo o per\u00edodo de julho de 2015 a dezembro de 2024.</p> <p>Impacto do Projeto</p> <p>O sistema processou mais de 34.000 farm\u00e1cias e identificou irregularidades significativas que representam bilh\u00f5es de reais em vendas sem comprova\u00e7\u00e3o de lastro em estoque.</p>"},{"location":"guia/resultados.html#2-rodada-1-2015-2020","title":"2. Rodada 1: 2015-2020","text":""},{"location":"guia/resultados.html#21-escopo-da-analise","title":"2.1. Escopo da An\u00e1lise","text":"Aspecto Informa\u00e7\u00e3o Per\u00edodo Analisado Julho/2015 a Dezembro/2020 Farm\u00e1cias Processadas ~34.000 estabelecimentos Ano de Execu\u00e7\u00e3o 2020 Medicamentos Analisados Todos os GTINs eleg\u00edveis ao PFPB"},{"location":"guia/resultados.html#22-produtos-gerados","title":"2.2. Produtos Gerados","text":"<ul> <li>\u2705 Relat\u00f3rios individualizados para cada farm\u00e1cia com irregularidades</li> <li>\u2705 Tabela consolidada de resultados (<code>resultado_Sentinela_2015_2020</code>)</li> <li>\u2705 Ranking de farm\u00e1cias por valor de irregularidade</li> <li>\u2705 Base de dados para alimenta\u00e7\u00e3o do painel gerencial</li> </ul>"},{"location":"guia/resultados.html#23-disponibilidade","title":"2.3. Disponibilidade","text":"<p>Os resultados da primeira rodada est\u00e3o dispon\u00edveis na pasta compartilhada:</p> <pre><code>\ud83d\udcc1 Resultados 2015-2020/\n\u251c\u2500\u2500 \ud83d\udcca Relat\u00f3rios Completos/\n\u251c\u2500\u2500 \ud83d\udcca Relat\u00f3rios Resumidos/\n\u251c\u2500\u2500 \ud83d\udcc8 An\u00e1lise Consolidada/\n\u2514\u2500\u2500 \ud83d\udccb Tabelas de Resultado/\n</code></pre>"},{"location":"guia/resultados.html#3-rodada-2-2015-2024","title":"3. Rodada 2: 2015-2024","text":""},{"location":"guia/resultados.html#31-escopo-da-analise","title":"3.1. Escopo da An\u00e1lise","text":"Aspecto Informa\u00e7\u00e3o Per\u00edodo Analisado Janeiro/2015 a Dezembro/2024 Farm\u00e1cias Processadas ~34.000 estabelecimentos Ano de Execu\u00e7\u00e3o 2015-2024 Novidades Matriz de Risco + An\u00e1lise de CRMs"},{"location":"guia/resultados.html#32-evolucao-do-sistema","title":"3.2. Evolu\u00e7\u00e3o do Sistema","text":"<p>A segunda rodada incorporou melhorias significativas:</p> Matriz de RiscoAn\u00e1lise de CRMsRelat\u00f3rios Aprimorados <ul> <li>17 indicadores independentes de fraude</li> <li>C\u00e1lculo de Risco Relativo (compara\u00e7\u00e3o com m\u00e9dia UF/BR)</li> <li>Classifica\u00e7\u00e3o autom\u00e1tica de risco (Cr\u00edtico a M\u00ednimo)</li> <li>Rankings nacional, estadual e municipal</li> </ul> <ul> <li>Valida\u00e7\u00e3o de regularidade dos CRMs no CFM</li> <li>Detec\u00e7\u00e3o de m\u00e9dicos-rob\u00f4 (&gt;30 prescri\u00e7\u00f5es/dia)</li> <li>An\u00e1lise de concentra\u00e7\u00e3o de prescritores</li> <li>Alertas de dist\u00e2ncia geogr\u00e1fica (&gt;400km)</li> </ul> <ul> <li>Nova aba de Evolu\u00e7\u00e3o Financeira com gr\u00e1ficos</li> <li>Nova aba de Indicadores de Risco comparativos</li> <li>Nova aba de An\u00e1lise de CRMs detalhada</li> <li>Mem\u00f3ria de c\u00e1lculo comprimida para otimiza\u00e7\u00e3o</li> </ul>"},{"location":"guia/resultados.html#33-produtos-gerados","title":"3.3. Produtos Gerados","text":"<ul> <li>\u2705 Relat\u00f3rios individualizados com 4 abas completas</li> <li>\u2705 Tabela consolidada com indicadores (<code>resultado_Sentinela_2021_2024</code>)</li> <li>\u2705 Matriz de Risco Final (<code>Matriz_Risco_Final</code>)</li> <li>\u2705 An\u00e1lise de prescritores (<code>indicadorCRM_Completo</code>)</li> <li>\u2705 Rankings em m\u00faltiplos n\u00edveis (BR, UF, Munic\u00edpio)</li> </ul>"},{"location":"guia/resultados.html#34-disponibilidade","title":"3.4. Disponibilidade","text":"<p>Os resultados da segunda rodada est\u00e3o dispon\u00edveis na pasta compartilhada:</p> <pre><code>\ud83d\udcc1 Resultados 2015-2024/\n\u251c\u2500\u2500 \ud83d\udcca Relat\u00f3rios Completos/\n\u251c\u2500\u2500 \ud83d\udcca Relat\u00f3rios Resumidos/\n\u251c\u2500\u2500 \ud83d\udcc8 Matriz de Risco/\n\u251c\u2500\u2500 \ud83d\udc68\u200d\u2695\ufe0f An\u00e1lise de CRMs/\n\u2514\u2500\u2500 \ud83d\udccb Tabelas de Resultado/\n</code></pre>"},{"location":"guia/resultados.html#4-metricas-de-processamento","title":"4. M\u00e9tricas de Processamento","text":""},{"location":"guia/resultados.html#41-performance-do-sistema","title":"4.1. Performance do Sistema","text":"<p>O sistema registra m\u00e9tricas detalhadas de performance para cada CNPJ processado:</p> M\u00e9trica Descri\u00e7\u00e3o <code>tempo_processamento_segundos</code> Tempo total de processamento do CNPJ <code>total_registros_processados</code> Quantidade de transa\u00e7\u00f5es analisadas <code>total_medicamentos</code> Quantidade de GTINs distintos <code>situacao</code> Status final (sucesso, falha, sem dados)"},{"location":"guia/resultados.html#42-estatisticas-de-status","title":"4.2. Estat\u00edsticas de Status","text":"<p>A tabela <code>processamentosFP</code> mant\u00e9m o status de cada farm\u00e1cia:</p> C\u00f3digo Status Significado 1 <code>SIT_SUCCESS</code> Processado com irregularidades detectadas 2 <code>SIT_RUNNING</code> Processamento em andamento 3 <code>SIT_FAILED</code> Falha durante execu\u00e7\u00e3o 4 <code>SIT_NO_DATA</code> Sem dados para o per\u00edodo 5 <code>SIT_NO_SALES</code> Sem vendas no per\u00edodo 6 <code>SIT_NO_ISSUES</code> Processado sem irregularidades"},{"location":"guia/resultados.html#5-utilizacao-dos-resultados","title":"5. Utiliza\u00e7\u00e3o dos Resultados","text":""},{"location":"guia/resultados.html#51-painel-gerencial","title":"5.1. Painel Gerencial","text":"<p>Os resultados alimentam o Painel Sentinela, dispon\u00edvel em:</p> <p>\ud83d\udd17 https://paineis.cgu.gov.br/sentinela</p> <p>O painel permite:</p> <ul> <li>Visualiza\u00e7\u00e3o de rankings por UF e munic\u00edpio</li> <li>Filtros por indicadores de risco</li> <li>Detalhamento de farm\u00e1cias espec\u00edficas</li> <li>Exporta\u00e7\u00e3o de dados para an\u00e1lise</li> </ul>"},{"location":"guia/resultados.html#52-selecao-de-alvos-para-auditoria","title":"5.2. Sele\u00e7\u00e3o de Alvos para Auditoria","text":"<p>Os resultados s\u00e3o utilizados para priorizar auditorias presenciais:</p> flowchart LR     A[Matriz de Risco] --&gt; B{Score &gt; Limiar}     B --&gt;|Sim| C[Lista de Prioridade]     B --&gt;|N\u00e3o| D[Monitoramento]     C --&gt; E[Auditoria Presencial]     E --&gt; F[Relat\u00f3rio de Auditoria]"},{"location":"guia/resultados.html#6-proximas-etapas","title":"6. Pr\u00f3ximas Etapas","text":""},{"location":"guia/resultados.html#61-manutencao-e-atualizacoes","title":"6.1. Manuten\u00e7\u00e3o e Atualiza\u00e7\u00f5es","text":"<ul> <li>Atualiza\u00e7\u00e3o peri\u00f3dica das bases de dados</li> <li>Refinamento dos indicadores de risco</li> <li>Inclus\u00e3o de novos alertas conforme padr\u00f5es emergentes</li> <li>Documenta\u00e7\u00e3o cont\u00ednua de metodologias</li> </ul> <p>Acesso aos Resultados</p> <p>Para acesso aos resultados detalhados, entre em contato com a equipe do NEP/SC atrav\u00e9s dos canais oficiais.</p>"},{"location":"guia/resumo.html","title":"Resumo do Projeto","text":""},{"location":"guia/resumo.html#1-informacoes-gerais","title":"1. Informa\u00e7\u00f5es Gerais","text":"Campo Informa\u00e7\u00e3o Nome do Projeto Sentinela \u00d3rg\u00e3o Respons\u00e1vel Controladoria-Geral da Uni\u00e3o (CGU) Unidade Executora N\u00facleo de Estudos e Pesquisas (NEP) - CGU Santa Catarina Data de In\u00edcio 31 de mar\u00e7o de 2020 Status Projeto em Andamento Pasta de Trabalho 001 - Farm\u00e1cia_Popular Vers\u00e3o Atual 8.0 (sentinelav8.py)"},{"location":"guia/resumo.html#2-equipe-responsavel","title":"2. Equipe Respons\u00e1vel","text":""},{"location":"guia/resumo.html#desenvolvedores-principais","title":"Desenvolvedores Principais","text":"Nome E-mail Fun\u00e7\u00e3o Guilherme Martins Willemann guilherme.willemann@cgu.gov.br An\u00e1lise e desenvolvimento Tatiana Popia Corr\u00eaa tatiana.correa@cgu.gov.br An\u00e1lise e desenvolvimento Fernando Rodrigues Jo\u00e3o Junior fernando.joao-junior@cgu.gov.br An\u00e1lise"},{"location":"guia/resumo.html#chefias-envolvidas","title":"Chefias Envolvidas","text":"Nome Cargo E-mail Tatiana Popia Corr\u00eaa Chefe do NEP tatiana.correa@cgu.gov.br"},{"location":"guia/resumo.html#3-produtos-resultantes","title":"3. Produtos Resultantes","text":"<p>O projeto gera os seguintes produtos para cada farm\u00e1cia analisada:</p>"},{"location":"guia/resumo.html#31-relatorios-individualizados","title":"3.1. Relat\u00f3rios Individualizados","text":"<p>Cada farm\u00e1cia credenciada recebe dois tipos de relat\u00f3rio em formato Excel (.xlsx):</p> Relat\u00f3rio CompletoRelat\u00f3rio Resumido <p>Cont\u00e9m todo o hist\u00f3rico transacional da farm\u00e1cia no per\u00edodo analisado:</p> <ul> <li>Todas as movimenta\u00e7\u00f5es de entrada (compras) e sa\u00edda (vendas)</li> <li>Fluxo cronol\u00f3gico de estoque para cada medicamento (GTIN)</li> <li>Indicadores de risco comparados com m\u00e9dias estaduais e nacionais</li> <li>An\u00e1lise detalhada dos prescritores (CRMs)</li> </ul> <p>Uso: Auditorias fiscais completas e investiga\u00e7\u00f5es profundas.</p> <p>Cont\u00e9m apenas as irregularidades detectadas:</p> <ul> <li>Per\u00edodos onde houve vendas sem comprova\u00e7\u00e3o de estoque</li> <li>Medicamentos com saldo negativo no fluxo de estoque</li> <li>Indicadores de risco com desvios significativos</li> <li>Prescritores com alertas ativos</li> </ul> <p>Uso: Triagem r\u00e1pida e prioriza\u00e7\u00e3o de casos.</p>"},{"location":"guia/resumo.html#32-estrutura-do-dossie-excel","title":"3.2. Estrutura do Dossi\u00ea Excel","text":"<p>Cada relat\u00f3rio \u00e9 composto por 4 abas:</p> Aba Conte\u00fado Finalidade Movimenta\u00e7\u00e3o Fluxo cronol\u00f3gico de estoque por GTIN Prova documental da irregularidade Evolu\u00e7\u00e3o Financeira Gr\u00e1ficos semestrais de valores Identificar quando a fraude come\u00e7ou Indicadores 17 m\u00e9tricas de risco comparativas Contextualizar o comportamento An\u00e1lise de CRMs Detalhamento dos prescritores Investigar a \"ponta da caneta\""},{"location":"guia/resumo.html#4-rodadas-de-analise","title":"4. Rodadas de An\u00e1lise","text":"<p>O projeto foi executado em duas rodadas principais:</p>"},{"location":"guia/resumo.html#rodada-1-2015-2020","title":"Rodada 1: 2015-2020","text":"Aspecto Informa\u00e7\u00e3o Per\u00edodo Julho/2015 a Dezembro/2020 Farm\u00e1cias Analisadas ~34.000 estabelecimentos Ano de Execu\u00e7\u00e3o 2020 Status \u2705 Conclu\u00edda Resultados Dispon\u00edveis na pasta \"Resultados 2015-2020\""},{"location":"guia/resumo.html#rodada-2-2021-2024","title":"Rodada 2: 2021-2024","text":"Aspecto Informa\u00e7\u00e3o Per\u00edodo Janeiro/2021 a Dezembro/2024 Farm\u00e1cias Analisadas ~34.000 estabelecimentos Ano de Execu\u00e7\u00e3o 2015-2024 Status \u2705 Conclu\u00edda Resultados Dispon\u00edveis na pasta \"Resultados 2015-2024\""},{"location":"guia/resumo.html#5-bases-de-dados-utilizadas","title":"5. Bases de Dados Utilizadas","text":"<p>O sistema integra m\u00faltiplas bases de dados governamentais:</p> Base de Dados Fonte Conte\u00fado Principal <code>db_farmaciapopular</code> Minist\u00e9rio da Sa\u00fade Registros de dispensa\u00e7\u00f5es (vendas) do PFPB <code>db_farmaciapopular_nf</code> Receita Federal Notas Fiscais Eletr\u00f4nicas de aquisi\u00e7\u00e3o de medicamentos <code>db_CNPJ</code> Receita Federal Cadastro Nacional de Pessoas Jur\u00eddicas <code>db_CPF</code> Receita Federal Cadastro de Pessoas F\u00edsicas <code>db_Cadunico</code> MDS Cadastro \u00danico para Programas Sociais <code>temp_CGUSC</code> CGU/SC Base de trabalho e resultados da auditoria"},{"location":"guia/resumo.html#6-tecnologias-utilizadas","title":"6. Tecnologias Utilizadas","text":""},{"location":"guia/resumo.html#stack-de-desenvolvimento","title":"Stack de Desenvolvimento","text":"graph LR     subgraph Backend         A[SQL Server] --&gt; B[Python 3.8+]     end      subgraph Frontend         B --&gt; C[Excel/xlsxwriter]         B --&gt; D[Power BI]     end      subgraph Bibliotecas         E[pyodbc]         F[pandas]         G[tqdm]         H[art]     end"},{"location":"guia/resumo.html#detalhamento","title":"Detalhamento","text":"Camada Tecnologia Vers\u00e3o Fun\u00e7\u00e3o Banco de Dados Microsoft SQL Server 2019+ Armazenamento e prepara\u00e7\u00e3o de dados Processamento Python 3.8+ L\u00f3gica de auditoria e gera\u00e7\u00e3o de relat\u00f3rios Conex\u00e3o pyodbc 5.1.0 Driver ODBC para SQL Server Manipula\u00e7\u00e3o de Dados pandas 2.2.2 DataFrames e an\u00e1lise Gera\u00e7\u00e3o de Excel XlsxWriter 3.2.0 Cria\u00e7\u00e3o de planilhas formatadas Interface tqdm 4.66.4 Barras de progresso no terminal Visual art 6.1 Arte ASCII no cabe\u00e7alho Visualiza\u00e7\u00e3o Power BI - Painel gerencial online"},{"location":"guia/resumo.html#7-arquivos-do-projeto","title":"7. Arquivos do Projeto","text":""},{"location":"guia/resumo.html#scripts-python-principais","title":"Scripts Python Principais","text":"Arquivo Linhas Descri\u00e7\u00e3o <code>sentinelav8.py</code> ~858 Motor principal de processamento - Simula\u00e7\u00e3o de fluxo de estoque <code>gerar_relatorio_memoriav8.py</code> ~1571 Gerador de relat\u00f3rios Excel completos"},{"location":"guia/resumo.html#scripts-sql","title":"Scripts SQL","text":"Pasta Arquivos Descri\u00e7\u00e3o <code>/</code> 01 a 06 Scripts de prepara\u00e7\u00e3o, processamento e an\u00e1lise gerencial <code>Indicadores/</code> 22 arquivos Scripts para c\u00e1lculo de cada indicador de risco"},{"location":"guia/resumo.html#scripts-sql-da-pasta-indicadores","title":"Scripts SQL da Pasta Indicadores","text":"Arquivo Indicador <code>falecidos.sql</code> Vendas para benefici\u00e1rios falecidos <code>inconsistencia_clinica.sql</code> Incompatibilidade patol\u00f3gica (idade/sexo) <code>teto.sql</code> Dispensa\u00e7\u00e3o em teto m\u00e1ximo <code>polimedicamento.sql</code> Cupons com 4+ itens <code>media_itens.sql</code> M\u00e9dia de itens por autoriza\u00e7\u00e3o <code>tickermedio.sql</code> Valor do ticket m\u00e9dio <code>receita_por_paciente.sql</code> Faturamento por cliente <code>venda_per_capita.sql</code> Venda per capita municipal <code>medicamentos_alto_custo.sql</code> Concentra\u00e7\u00e3o em medicamentos caros <code>vendas_consecutivas.sql</code> Vendas r\u00e1pidas (&lt;60 segundos) <code>horario_atipico.sql</code> Vendas na madrugada <code>concentracao_dias_pico.sql</code> Concentra\u00e7\u00e3o em dias de pico <code>geografico.sql</code> Dispers\u00e3o geogr\u00e1fica <code>pacientes_unicos.sql</code> Pacientes com compra \u00fanica <code>crms.sql</code> Concentra\u00e7\u00e3o de prescritores (HHI) <code>exclusividade_crm.sql</code> CRMs exclusivos da farm\u00e1cia <code>crms_irregulares.sql</code> CRMs inv\u00e1lidos ou retroativos <code>matriz_risco_final.sql</code> Consolida\u00e7\u00e3o do score de risco <code>gerador_dados_para_indicador_crms.sql</code> Prepara\u00e7\u00e3o de dados de CRMs"},{"location":"guia/resumo.html#8-links-oficiais","title":"8. Links Oficiais","text":"Recurso URL Painel Sentinela https://paineis.cgu.gov.br/sentinela Resultados 2015-2020 [Pasta compartilhada interna] Resultados 2015-2024 [Pasta compartilhada interna] <p>Sobre esta documenta\u00e7\u00e3o</p> <p>Esta documenta\u00e7\u00e3o reflete a vers\u00e3o 8.0 do sistema Sentinela, que inclui a Matriz de Risco completa com 17 indicadores e o m\u00f3dulo de an\u00e1lise de prescritores (CRMs).</p>"},{"location":"indicadores/index.html","title":"Indicadores de Risco e Fraude","text":"<p>Esta se\u00e7\u00e3o detalha os 17 indicadores utilizados pelo Sistema Sentinela para identificar comportamentos an\u00f4malos e potencialmente fraudulentos.</p>"},{"location":"indicadores/index.html#estrutura-dos-indicadores","title":"Estrutura dos Indicadores","text":"<p>Os indicadores s\u00e3o organizados em 5 grupos tem\u00e1ticos:</p> <ul> <li> Grupo 1: Elegibilidade &amp; Cl\u00ednica</li> </ul> <p>Indicadores que verificam a validade dos benefici\u00e1rios e compatibilidade cl\u00ednica.</p> <p> Ver indicadores</p> <ul> <li> Grupo 2: Padr\u00f5es de Quantidade</li> </ul> <p>Indicadores que analisam padr\u00f5es de dispensa\u00e7\u00e3o e volumes por cupom.</p> <p> Ver indicadores</p> <ul> <li> Grupo 3: Padr\u00f5es Financeiros</li> </ul> <p>Indicadores que analisam valores, tickets e concentra\u00e7\u00e3o de medicamentos.</p> <p> Ver indicadores</p> <ul> <li> Grupo 4: Automa\u00e7\u00e3o &amp; Geografia</li> </ul> <p>Indicadores que detectam automa\u00e7\u00e3o e anomalias geogr\u00e1ficas/temporais.</p> <p> Ver indicadores</p> <ul> <li> Grupo 5: Integridade M\u00e9dica (CRMs)</li> </ul> <p>Indicadores focados nos padr\u00f5es de prescri\u00e7\u00e3o m\u00e9dica.</p> <p> Ver indicadores</p>"},{"location":"indicadores/index.html#matriz-de-risco","title":"Matriz de Risco","text":"<ul> <li> Score de Risco Final</li> </ul> <p>Entenda como os indicadores s\u00e3o combinados para gerar um score \u00fanico e classifica\u00e7\u00e3o de risco.</p> <p> Ver metodologia</p> <ul> <li> An\u00e1lise de Prescritores</li> </ul> <p>Detalhamento especial da an\u00e1lise de CRMs e m\u00e9dicos prescritores.</p> <p> Ver an\u00e1lise</p>"},{"location":"indicadores/index.html#visao-geral-dos-17-indicadores","title":"Vis\u00e3o Geral dos 17 Indicadores","text":"# Indicador Grupo O que mede 1 Vendas para Falecidos Elegibilidade % de vendas para benefici\u00e1rios ap\u00f3s \u00f3bito 2 Incompatibilidade Cl\u00ednica Elegibilidade % de vendas com perfil idade/sexo incompat\u00edvel 3 Dispensa\u00e7\u00e3o em Teto Quantidade % de vendas no limite m\u00e1ximo permitido 4 Polimedicamentos Quantidade % de cupons com 4+ medicamentos 5 M\u00e9dia de Itens Quantidade M\u00e9dia de itens por autoriza\u00e7\u00e3o 6 Ticket M\u00e9dio Financeiro Valor m\u00e9dio por autoriza\u00e7\u00e3o 7 Receita por Paciente Financeiro Faturamento m\u00e9dio por CPF 8 Venda Per Capita Financeiro Faturamento / popula\u00e7\u00e3o do munic\u00edpio 9 Medicamentos Alto Custo Financeiro % de vendas de medicamentos caros 10 Vendas R\u00e1pidas Automa\u00e7\u00e3o % de vendas consecutivas &lt;60 segundos 11 Hor\u00e1rio At\u00edpico Automa\u00e7\u00e3o % de vendas na madrugada (00h-06h) 12 Concentra\u00e7\u00e3o em Pico Automa\u00e7\u00e3o % de vendas nos 3 dias de maior movimento 13 Dispers\u00e3o Geogr\u00e1fica Automa\u00e7\u00e3o % de pacientes de outras UFs 14 Pacientes \u00danicos Automa\u00e7\u00e3o % de CPFs com apenas uma compra 15 Concentra\u00e7\u00e3o HHI CRMs \u00cdndice de concentra\u00e7\u00e3o de prescritores 16 Exclusividade CRM CRMs % de CRMs exclusivos da farm\u00e1cia 17 Irregularidade CRM CRMs % de CRMs inv\u00e1lidos ou retroativos"},{"location":"indicadores/index.html#conceito-de-risco-relativo-rr","title":"Conceito de Risco Relativo (RR)","text":"<p>Todos os indicadores s\u00e3o normalizados atrav\u00e9s do conceito de Risco Relativo:</p> \\[ RR = \\frac{\\text{Valor do Indicador na Farm\u00e1cia}}{\\text{M\u00e9dia do Indicador na UF}} \\]"},{"location":"indicadores/index.html#interpretacao-do-rr","title":"Interpreta\u00e7\u00e3o do RR","text":"Valor RR Interpreta\u00e7\u00e3o N\u00edvel de Alerta &lt; 1.0 Abaixo da m\u00e9dia \ud83d\udfe2 Normal \u2248 1.0 Na m\u00e9dia \ud83d\udfe2 Normal 1.5 - 2.0 Levemente acima \ud83d\udfe1 Aten\u00e7\u00e3o 2.0 - 5.0 Significativamente acima \ud83d\udfe0 Alerta &gt; 5.0 Muito acima \ud83d\udd34 Cr\u00edtico"},{"location":"indicadores/index.html#fontes-de-dados-para-indicadores","title":"Fontes de Dados para Indicadores","text":"Indicador Fontes Utilizadas Falecidos <code>movimentacaoFP</code> + <code>tb_obitos_unificada</code> Incompatibilidade <code>movimentacaoFP</code> + <code>medicamentosPatologiaFP</code> + <code>db_CPF</code> Quantidade <code>movimentacaoFP</code> Financeiros <code>movimentacaoFP</code> + <code>tb_ibge</code> Automa\u00e7\u00e3o <code>movimentacaoFP</code> (timestamps) CRMs <code>movimentacaoFP</code> + Base CFM <p>Como usar esta se\u00e7\u00e3o</p> <p>Clique em cada grupo para ver a metodologia detalhada de c\u00e1lculo de cada indicador, incluindo:</p> <pre><code>- L\u00f3gica de sele\u00e7\u00e3o de dados\n- F\u00f3rmula de c\u00e1lculo\n- Interpreta\u00e7\u00e3o dos resultados\n- Casos de borda e exce\u00e7\u00f5es\n</code></pre>"},{"location":"indicadores/analise-prescritores.html","title":"An\u00e1lise de Prescritores","text":"<p>O m\u00f3dulo de an\u00e1lise de prescritores, implementado em <code>aba_crm.py</code>, foca na \"ponta da caneta\" - os m\u00e9dicos que assinam as receitas vinculadas \u00e0s vendas do Programa Farm\u00e1cia Popular.</p>"},{"location":"indicadores/analise-prescritores.html#1-objetivo","title":"1. Objetivo","text":"<p>Identificar padr\u00f5es an\u00f4malos de prescri\u00e7\u00e3o que podem indicar:</p> <ul> <li>M\u00e9dicos fict\u00edcios ou com CRM inv\u00e1lido</li> <li>Esquemas de direcionamento de pacientes</li> <li>Volumes de prescri\u00e7\u00e3o muito acima da m\u00e9dia</li> <li>Concentra\u00e7\u00e3o suspeita de vendas em poucos CRMs</li> </ul>"},{"location":"indicadores/analise-prescritores.html#2-fontes-de-dados","title":"2. Fontes de Dados","text":"Tabela Conte\u00fado Uso <code>indicadorCRM_Completo</code> Dados consolidados de prescritores M\u00e9tricas agregadas <code>top20CRMsPorFarmacia</code> Top 20 prescritores por farm\u00e1cia Detalhamento Base CFM Registro de m\u00e9dicos Valida\u00e7\u00e3o"},{"location":"indicadores/analise-prescritores.html#3-metricas-calculadas","title":"3. M\u00e9tricas Calculadas","text":""},{"location":"indicadores/analise-prescritores.html#31-por-farmacia-agregado","title":"3.1. Por Farm\u00e1cia (Agregado)","text":"M\u00e9trica Descri\u00e7\u00e3o <code>concentracao_top1</code> % das vendas do principal CRM <code>concentracao_top5</code> % das vendas dos 5 maiores CRMs <code>hhi_prescritores</code> \u00cdndice de concentra\u00e7\u00e3o HHI <code>qtd_crms_invalidos</code> N\u00famero de CRMs n\u00e3o encontrados no CFM <code>qtd_crms_robo</code> CRMs com &gt;30 prescri\u00e7\u00f5es/dia <code>media_prescricoes_dia</code> M\u00e9dia de prescri\u00e7\u00f5es por dia por CRM <code>qtd_alertas_geograficos</code> M\u00e9dicos a &gt;400km de dist\u00e2ncia"},{"location":"indicadores/analise-prescritores.html#32-por-crm-individual","title":"3.2. Por CRM (Individual)","text":"M\u00e9trica Descri\u00e7\u00e3o <code>crm</code> N\u00famero do registro m\u00e9dico <code>nome_medico</code> Nome completo <code>uf_crm</code> Estado de registro <code>data_primeira_prescricao</code> Primeira vez que prescreveu para a farm\u00e1cia <code>data_registro_cfm</code> Data de inscri\u00e7\u00e3o no conselho <code>num_prescricoes</code> Total de prescri\u00e7\u00f5es <code>valor_total</code> Valor movimentado <code>participacao_pct</code> % do faturamento da farm\u00e1cia <code>prescricoes_dia_local</code> M\u00e9dia di\u00e1ria nesta farm\u00e1cia <code>prescricoes_dia_brasil</code> M\u00e9dia di\u00e1ria em todas farm\u00e1cias do pa\u00eds <code>num_farmacias</code> Em quantas farm\u00e1cias atua <code>distancia_km</code> Dist\u00e2ncia entre m\u00e9dico e farm\u00e1cia"},{"location":"indicadores/analise-prescritores.html#4-alertas-implementados","title":"4. Alertas Implementados","text":""},{"location":"indicadores/analise-prescritores.html#41-tipos-de-alerta","title":"4.1. Tipos de Alerta","text":"Alerta Crit\u00e9rio Cor Gravidade CRM Inv\u00e1lido N\u00e3o encontrado no CFM \ud83d\udd34 Vermelho Cr\u00edtica &gt;30/dia Aqui &gt;30 prescri\u00e7\u00f5es/dia nesta farm\u00e1cia \ud83d\udd34 Magenta Cr\u00edtica &gt;30/dia Rede &gt;30 prescri\u00e7\u00f5es/dia em todo Brasil \ud83d\udfe3 Roxo Alta Multi-Farm\u00e1cia Atua em &gt;20 estabelecimentos \ud83d\udfe3 Roxo Alta Tempo Concentrado Todas prescri\u00e7\u00f5es em per\u00edodo muito curto \ud83d\udfe0 Laranja M\u00e9dia Alerta Geogr\u00e1fico M\u00e9dico a &gt;400km da farm\u00e1cia \ud83d\udd35 Azul M\u00e9dia Prescri\u00e7\u00e3o Retroativa Prescri\u00e7\u00e3o antes do registro no CFM \ud83d\udd34 Vermelho Cr\u00edtica"},{"location":"indicadores/analise-prescritores.html#42-constantes-de-alerta","title":"4.2. Constantes de Alerta","text":"<p>Definidas no c\u00f3digo <code>aba_crm.py</code>:</p> Constante Valor Descri\u00e7\u00e3o <code>LIMITE_ROBO_DIA</code> 30 Prescri\u00e7\u00f5es/dia para considerar \"rob\u00f4\" <code>LIMITE_MULTI_FARMACIA</code> 20 Farm\u00e1cias para considerar \"multi-farm\u00e1cia\" <code>LIMITE_DISTANCIA_KM</code> 400 Dist\u00e2ncia para alerta geogr\u00e1fico"},{"location":"indicadores/analise-prescritores.html#5-prescritor-robo","title":"5. Prescritor \"Rob\u00f4\"","text":""},{"location":"indicadores/analise-prescritores.html#51-conceito","title":"5.1. Conceito","text":"<p>Um CRM que emite mais de 30 prescri\u00e7\u00f5es por dia est\u00e1 com comportamento compat\u00edvel com \"rob\u00f4\" - uma taxa dif\u00edcil de manter de forma consistente.</p>"},{"location":"indicadores/analise-prescritores.html#52-calculo","title":"5.2. C\u00e1lculo","text":"\\[ \\text{Prescri\u00e7\u00f5es/Dia} = \\frac{\\text{Total de Prescri\u00e7\u00f5es}}{\\text{Dias com Atividade}} \\] <p>Onde \"Dias com Atividade\" \u00e9 o n\u00famero de dias distintos em que o m\u00e9dico emitiu ao menos uma prescri\u00e7\u00e3o.</p>"},{"location":"indicadores/analise-prescritores.html#53-contexto","title":"5.3. Contexto","text":"<p>Um m\u00e9dico em consult\u00f3rio normal atende:</p> <ul> <li>15-25 pacientes/dia \u00e9 um volume alto mas vi\u00e1vel</li> <li>30+ pacientes/dia \u00e9 extremamente improv\u00e1vel</li> <li>50+ pacientes/dia \u00e9 fisicamente imposs\u00edvel</li> </ul>"},{"location":"indicadores/analise-prescritores.html#54-dois-niveis-de-analise","title":"5.4. Dois N\u00edveis de An\u00e1lise","text":"N\u00edvel Verifica\u00e7\u00e3o Interpreta\u00e7\u00e3o Local Prescri\u00e7\u00f5es/dia nesta farm\u00e1cia &gt;30 = suspeito Nacional Prescri\u00e7\u00f5es/dia em todo Brasil &gt;30 = muito suspeito <p>Se um m\u00e9dico tem &gt;30 prescri\u00e7\u00f5es/dia considerando todas as farm\u00e1cias do pa\u00eds, \u00e9 praticamente certo que h\u00e1 algo errado.</p>"},{"location":"indicadores/analise-prescritores.html#6-analise-geografica","title":"6. An\u00e1lise Geogr\u00e1fica","text":""},{"location":"indicadores/analise-prescritores.html#61-distancia-medico-farmacia","title":"6.1. Dist\u00e2ncia M\u00e9dico-Farm\u00e1cia","text":"<p>O sistema calcula a dist\u00e2ncia entre:</p> <ul> <li>Localiza\u00e7\u00e3o do consult\u00f3rio do m\u00e9dico (endere\u00e7o do CRM)</li> <li>Localiza\u00e7\u00e3o da farm\u00e1cia</li> </ul>"},{"location":"indicadores/analise-prescritores.html#62-alerta-de-distancia","title":"6.2. Alerta de Dist\u00e2ncia","text":"Dist\u00e2ncia Interpreta\u00e7\u00e3o &lt; 50km Normal 50-200km Pode ser leg\u00edtimo (cidade-polo) 200-400km Suspeito &gt; 400km Cr\u00edtico - m\u00e9dico de outra regi\u00e3o"},{"location":"indicadores/analise-prescritores.html#63-cenarios-legitimos","title":"6.3. Cen\u00e1rios Leg\u00edtimos","text":"<ul> <li>M\u00e9dico atendendo em cidade vizinha</li> <li>Pacientes que viajam para especialistas</li> <li>Cidade-polo que atrai pacientes regionais</li> </ul>"},{"location":"indicadores/analise-prescritores.html#64-cenarios-suspeitos","title":"6.4. Cen\u00e1rios Suspeitos","text":"<ul> <li>M\u00e9dico de S\u00e3o Paulo prescrevendo regularmente em farm\u00e1cia do Rio Grande do Sul</li> <li>M\u00faltiplos m\u00e9dicos de outras regi\u00f5es na mesma farm\u00e1cia</li> <li>Padr\u00e3o sistem\u00e1tico de prescri\u00e7\u00f5es distantes</li> </ul>"},{"location":"indicadores/analise-prescritores.html#7-prescricao-retroativa","title":"7. Prescri\u00e7\u00e3o Retroativa","text":""},{"location":"indicadores/analise-prescritores.html#71-conceito","title":"7.1. Conceito","text":"<p>Uma prescri\u00e7\u00e3o n\u00e3o pode existir antes do m\u00e9dico ter CRM v\u00e1lido. Se a data da primeira prescri\u00e7\u00e3o \u00e9 anterior \u00e0 data de registro no CFM, h\u00e1 fraude documental.</p>"},{"location":"indicadores/analise-prescritores.html#72-calculo","title":"7.2. C\u00e1lculo","text":"<pre><code>SE data_primeira_prescricao &lt; data_registro_cfm ENT\u00c3O\n    ALERTA: Prescri\u00e7\u00e3o Retroativa\n</code></pre>"},{"location":"indicadores/analise-prescritores.html#73-causas","title":"7.3. Causas","text":"<ul> <li>Uso de CRM de m\u00e9dico rec\u00e9m-formado antes do registro ser efetivado</li> <li>Falsifica\u00e7\u00e3o de datas nas receitas</li> <li>Uso de CRM de terceiros</li> </ul>"},{"location":"indicadores/analise-prescritores.html#8-estrutura-da-aba-no-relatorio","title":"8. Estrutura da Aba no Relat\u00f3rio","text":""},{"location":"indicadores/analise-prescritores.html#81-secoes","title":"8.1. Se\u00e7\u00f5es","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  CABE\u00c7ALHO                                                  \u2502\n\u2502  CNPJ: XX.XXX.XXX/0001-XX | Raz\u00e3o Social | Munic\u00edpio/UF     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  CARDS DE RESUMO                                            \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502Top 1:  \u2502 \u2502Top 5:  \u2502 \u2502Rob\u00f4s:  \u2502 \u2502Inv\u00e1lidos\u2502 \u2502Geogr\u00e1f.\u2502    \u2502\n\u2502  \u2502  35%   \u2502 \u2502  72%   \u2502 \u2502   3    \u2502 \u2502   2    \u2502 \u2502   1    \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  TABELA DE INDICADORES VS M\u00c9DIAS                           \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u2502\n\u2502  \u2502 Indicador          \u2502 Farm\u00e1cia \u2502 M\u00e9dia UF\u2502 M\u00e9dia BR\u2502     \u2502\n\u2502  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524     \u2502\n\u2502  \u2502 Concentra\u00e7\u00e3o Top 1 \u2502   35%    \u2502   15%   \u2502   12%   \u2502     \u2502\n\u2502  \u2502 HHI                \u2502  2845    \u2502   890   \u2502   750   \u2502     \u2502\n\u2502  \u2502 ...                \u2502   ...    \u2502   ...   \u2502   ...   \u2502     \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  TABELA DE CRMs DE INTERESSE                               \u2502\n\u2502  (Top 20 + CRMs com alertas, ordenados por risco/volume)   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  ALERTAS IDENTIFICADOS                                     \u2502\n\u2502  Descri\u00e7\u00f5es textuais de cada alerta encontrado             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"indicadores/analise-prescritores.html#82-formatacao-visual","title":"8.2. Formata\u00e7\u00e3o Visual","text":"Situa\u00e7\u00e3o Formata\u00e7\u00e3o CRM normal Fundo branco CRM inv\u00e1lido Fundo vermelho, texto branco Rob\u00f4 local Fundo magenta Rob\u00f4 nacional Fundo roxo Multi-farm\u00e1cia Fundo roxo Alerta geogr\u00e1fico Fundo azul Prescri\u00e7\u00e3o retroativa Fundo vermelho"},{"location":"indicadores/analise-prescritores.html#9-investigacao-de-crms","title":"9. Investiga\u00e7\u00e3o de CRMs","text":""},{"location":"indicadores/analise-prescritores.html#91-sinais-de-alerta-combinados","title":"9.1. Sinais de Alerta Combinados","text":"Combina\u00e7\u00e3o Interpreta\u00e7\u00e3o CRM inv\u00e1lido + Alto volume Fraude estruturada Rob\u00f4 + Multi-farm\u00e1cia Esquema organizado Retroativo + Concentra\u00e7\u00e3o alta CRM forjado Geogr\u00e1fico + Exclusividade CRM forjado <p>Pr\u00f3ximo Passo</p> <p>Veja as Abas do Relat\u00f3rio para entender como esses dados s\u00e3o apresentados no dossi\u00ea Excel.</p>"},{"location":"indicadores/grupo1-elegibilidade.html","title":"Grupo 1: Indicadores de Elegibilidade &amp; Cl\u00ednica","text":"<p>Este grupo cont\u00e9m indicadores que verificam a validade dos benefici\u00e1rios e a compatibilidade cl\u00ednica das dispensa\u00e7\u00f5es.</p>"},{"location":"indicadores/grupo1-elegibilidade.html#1-vendas-para-falecidos","title":"1. Vendas para Falecidos","text":""},{"location":"indicadores/grupo1-elegibilidade.html#11-definicao","title":"1.1. Defini\u00e7\u00e3o","text":"<p>Mede a ocorr\u00eancia de vendas para benefici\u00e1rios ap\u00f3s a data de seu \u00f3bito.</p> <p>Gravidade</p> <p>Este \u00e9 um dos indicadores mais fortes de fraude, pois representa uma transa\u00e7\u00e3o factualmente imposs\u00edvel. Uma pessoa falecida n\u00e3o pode ir a uma farm\u00e1cia retirar medicamentos.</p>"},{"location":"indicadores/grupo1-elegibilidade.html#12-script","title":"1.2. Script","text":"<pre><code>\ud83d\udcc4 Indicadores/falecidos.sql\n</code></pre>"},{"location":"indicadores/grupo1-elegibilidade.html#13-logica-de-calculo","title":"1.3. L\u00f3gica de C\u00e1lculo","text":""},{"location":"indicadores/grupo1-elegibilidade.html#fontes-de-dados","title":"Fontes de Dados","text":"Tabela Uso <code>movimentacaoFP</code> Registros de vendas <code>tb_obitos_unificada</code> Base de \u00f3bitos (SIM, SIRC, SISOBI)"},{"location":"indicadores/grupo1-elegibilidade.html#algoritmo","title":"Algoritmo","text":"<ol> <li>Cruzamento: Junta as vendas com a base de \u00f3bitos usando o CPF do benefici\u00e1rio como chave</li> <li>Filtro: Seleciona apenas vendas onde <code>data_hora &gt; dt_obito</code></li> <li>Agrega\u00e7\u00e3o: Soma os valores das vendas filtradas por CNPJ</li> <li>C\u00e1lculo do Percentual: Divide pelo faturamento total da farm\u00e1cia</li> </ol>"},{"location":"indicadores/grupo1-elegibilidade.html#14-formula","title":"1.4. F\u00f3rmula","text":"\\[ \\% \\text{Falecidos} = \\frac{\\sum \\text{Valor das Vendas ap\u00f3s \u00d3bito}}{\\sum \\text{Faturamento Total}} \\times 100 \\]"},{"location":"indicadores/grupo1-elegibilidade.html#15-interpretacao","title":"1.5. Interpreta\u00e7\u00e3o","text":"Valor Interpreta\u00e7\u00e3o 0% Normal (ideal) &gt; 0.1% Alerta - investigar"},{"location":"indicadores/grupo1-elegibilidade.html#16-consideracoes","title":"1.6. Considera\u00e7\u00f5es","text":"<p>Fontes de Dados</p> <p>A base de \u00f3bitos \u00e9 composta por m\u00faltiplas fontes:</p> <pre><code>- **SIM:** Sistema de Informa\u00e7\u00f5es sobre Mortalidade\n- **SIRC:** Sistema de Informa\u00e7\u00f5es do Registro Civil\n- **SISOBI:** Sistema de Controle de \u00d3bitos\n</code></pre>"},{"location":"indicadores/grupo1-elegibilidade.html#2-incompatibilidade-patologica-clinica","title":"2. Incompatibilidade Patol\u00f3gica (Cl\u00ednica)","text":""},{"location":"indicadores/grupo1-elegibilidade.html#21-definicao","title":"2.1. Defini\u00e7\u00e3o","text":"<p>Identifica vendas de medicamentos para benefici\u00e1rios com perfil demogr\u00e1fico incompat\u00edvel com a indica\u00e7\u00e3o terap\u00eautica.</p>"},{"location":"indicadores/grupo1-elegibilidade.html#22-script","title":"2.2. Script","text":"<pre><code>\ud83d\udcc4 Indicadores/inconsistencia_clinica.sql\n</code></pre>"},{"location":"indicadores/grupo1-elegibilidade.html#23-logica-de-calculo","title":"2.3. L\u00f3gica de C\u00e1lculo","text":""},{"location":"indicadores/grupo1-elegibilidade.html#fontes-de-dados_1","title":"Fontes de Dados","text":"Tabela Uso <code>movimentacaoFP</code> Registros de vendas <code>medicamentosPatologiaFP</code> Indica\u00e7\u00e3o terap\u00eautica de cada medicamento <code>db_CPF</code> Dados do benefici\u00e1rio (idade, sexo)"},{"location":"indicadores/grupo1-elegibilidade.html#regras-de-incompatibilidade","title":"Regras de Incompatibilidade","text":"Patologia Crit\u00e9rio de Incompatibilidade Justificativa Osteoporose Paciente do sexo masculino Preval\u00eancia &gt;90% em mulheres Parkinson Paciente com idade &lt; 50 anos Raramente diagnosticado antes dessa idade Hipertens\u00e3o Paciente com idade &lt; 20 anos Crian\u00e7as/adolescentes raramente t\u00eam HAS Diabetes Tipo 2 Paciente com idade &lt; 20 anos DM2 \u00e9 t\u00edpica de adultos"},{"location":"indicadores/grupo1-elegibilidade.html#algoritmo_1","title":"Algoritmo","text":"<ol> <li>Cruzamento: Junta vendas com dados do medicamento e do paciente</li> <li>Aplica\u00e7\u00e3o de Regras: Verifica cada regra de incompatibilidade</li> <li>Flag: Marca transa\u00e7\u00f5es que violam as regras</li> <li>Agrega\u00e7\u00e3o: Soma valores das transa\u00e7\u00f5es flagradas</li> </ol>"},{"location":"indicadores/grupo1-elegibilidade.html#24-formula","title":"2.4. F\u00f3rmula","text":"\\[ \\% \\text{Incompatibilidade} = \\frac{\\sum \\text{Valor das Vendas Incompat\u00edveis}}{\\sum \\text{Faturamento Total}} \\times 100 \\]"},{"location":"indicadores/grupo1-elegibilidade.html#25-interpretacao","title":"2.5. Interpreta\u00e7\u00e3o","text":"Valor Interpreta\u00e7\u00e3o 0% - 0.3% Normal (poss\u00edveis exce\u00e7\u00f5es m\u00e9dicas v\u00e1lidas) &gt; 0.3% Elevado - necessita justificativa"},{"location":"indicadores/grupo1-elegibilidade.html#26-consideracoes","title":"2.6. Considera\u00e7\u00f5es","text":"<p>Exce\u00e7\u00f5es M\u00e9dicas</p> <p>Existem casos leg\u00edtimos de prescri\u00e7\u00e3o fora do perfil t\u00edpico:</p> <pre><code>- Osteoporose secund\u00e1ria em homens (ex: uso de corticoides)\n- Parkinson juvenil (raro, mas existe)\n- Hipertens\u00e3o secund\u00e1ria em jovens\n\nO indicador deve ser usado como **triagem**, n\u00e3o como prova definitiva.\n</code></pre>"},{"location":"indicadores/grupo1-elegibilidade.html#3-resumo-do-grupo","title":"3. Resumo do Grupo","text":"Indicador M\u00e9trica Alerta Vendas para Falecidos % do faturamento &gt; 0.1% Incompatibilidade Cl\u00ednica % do faturamento &gt; 0.3% <p>Pr\u00f3ximo Grupo</p> <p>Veja o Grupo 2: Padr\u00f5es de Quantidade para indicadores relacionados a volumes de dispensa\u00e7\u00e3o.</p>"},{"location":"indicadores/grupo2-quantidade.html","title":"Grupo 2: Indicadores de Padr\u00f5es de Quantidade","text":"<p>Este grupo cont\u00e9m indicadores que analisam os padr\u00f5es de dispensa\u00e7\u00e3o e os volumes por transa\u00e7\u00e3o.</p>"},{"location":"indicadores/grupo2-quantidade.html#1-dispensacao-em-teto-maximo","title":"1. Dispensa\u00e7\u00e3o em Teto M\u00e1ximo","text":""},{"location":"indicadores/grupo2-quantidade.html#11-definicao","title":"1.1. Defini\u00e7\u00e3o","text":"<p>Mede a propor\u00e7\u00e3o de vendas onde a quantidade dispensada atinge exatamente o limite m\u00e1ximo permitido por medicamento.</p>"},{"location":"indicadores/grupo2-quantidade.html#12-script","title":"1.2. Script","text":"<pre><code>\ud83d\udcc4 Indicadores/teto.sql\n</code></pre>"},{"location":"indicadores/grupo2-quantidade.html#13-contexto","title":"1.3. Contexto","text":"<p>O Programa Farm\u00e1cia Popular define limites mensais de dispensa\u00e7\u00e3o para cada medicamento, visando evitar:</p> <ul> <li>Ac\u00famulo indevido de medicamentos</li> <li>Revenda ilegal</li> <li>Desperd\u00edcio</li> </ul>"},{"location":"indicadores/grupo2-quantidade.html#14-logica-de-calculo","title":"1.4. L\u00f3gica de C\u00e1lculo","text":""},{"location":"indicadores/grupo2-quantidade.html#fontes-de-dados","title":"Fontes de Dados","text":"Tabela Uso <code>movimentacaoFP</code> Registros de vendas <code>medicamentosPatologiaFP</code> Limite m\u00e1ximo de cada medicamento"},{"location":"indicadores/grupo2-quantidade.html#algoritmo","title":"Algoritmo","text":"<ol> <li>Cruzamento: Junta vendas com os limites de cada medicamento</li> <li>Compara\u00e7\u00e3o: Verifica se <code>qnt_autorizada == qnt_limite_mensal</code></li> <li>Contagem: Conta quantas vendas atingem exatamente o teto</li> <li>Percentual: Divide pelo total de vendas</li> </ol>"},{"location":"indicadores/grupo2-quantidade.html#15-formula","title":"1.5. F\u00f3rmula","text":"\\[ \\% \\text{Teto} = \\frac{\\text{N\u00ba de Vendas no Teto}}{\\text{N\u00ba Total de Vendas}} \\times 100 \\]"},{"location":"indicadores/grupo2-quantidade.html#16-interpretacao","title":"1.6. Interpreta\u00e7\u00e3o","text":"Valor Interpreta\u00e7\u00e3o 0% - 65% Normal &gt;65% Elevado - investigar"},{"location":"indicadores/grupo2-quantidade.html#17-comportamento-suspeito","title":"1.7. Comportamento Suspeito","text":"<p>Padr\u00e3o de Fraude</p> <p>Farm\u00e1cias fraudulentas tendem a maximizar cada transa\u00e7\u00e3o fict\u00edcia:</p> <pre><code>- Sempre dispensam a quantidade m\u00e1xima permitida\n- Padr\u00e3o sistem\u00e1tico em m\u00faltiplos medicamentos\n- Mesmo CPF sempre retira no teto\n\nFarm\u00e1cias leg\u00edtimas apresentam varia\u00e7\u00e3o natural nas quantidades.\n</code></pre>"},{"location":"indicadores/grupo2-quantidade.html#2-polimedicamentos-4-itens-por-cupom","title":"2. Polimedicamentos (4+ Itens por Cupom)","text":""},{"location":"indicadores/grupo2-quantidade.html#21-definicao","title":"2.1. Defini\u00e7\u00e3o","text":"<p>Mede a propor\u00e7\u00e3o de cupons fiscais que cont\u00eam 4 ou mais medicamentos distintos no mesmo ato.</p>"},{"location":"indicadores/grupo2-quantidade.html#22-script","title":"2.2. Script","text":"<pre><code>\ud83d\udcc4 Indicadores/polimedicamento.sql\n</code></pre>"},{"location":"indicadores/grupo2-quantidade.html#23-contexto","title":"2.3. Contexto","text":"<p>Embora pacientes com m\u00faltiplas condi\u00e7\u00f5es cr\u00f4nicas possam legitimamente usar v\u00e1rios medicamentos, um excesso de itens por cupom pode indicar:</p> <ul> <li>Fracionamento de vendas: Uma venda grande dividida em v\u00e1rias</li> <li>Vendas fict\u00edcias: Maximiza\u00e7\u00e3o de valor por transa\u00e7\u00e3o</li> <li>Uso indevido de CPFs: Mesmo CPF usado para m\u00faltiplas fam\u00edlias</li> </ul>"},{"location":"indicadores/grupo2-quantidade.html#24-logica-de-calculo","title":"2.4. L\u00f3gica de C\u00e1lculo","text":""},{"location":"indicadores/grupo2-quantidade.html#algoritmo_1","title":"Algoritmo","text":"<ol> <li>Agrupamento: Agrupa vendas por <code>nu_autorizacao</code> (cupom fiscal)</li> <li>Contagem: Conta itens distintos (<code>COUNT(DISTINCT codigo_barra)</code>)</li> <li>Filtro: Seleciona cupons com 4 ou mais itens</li> <li>Percentual: Divide pelo total de cupons</li> </ol>"},{"location":"indicadores/grupo2-quantidade.html#25-formula","title":"2.5. F\u00f3rmula","text":"\\[ \\% \\text{Polimedicamentos} = \\frac{\\text{N\u00ba de Cupons com } \\geq 4 \\text{ itens}}{\\text{N\u00ba Total de Cupons}} \\times 100 \\]"},{"location":"indicadores/grupo2-quantidade.html#26-interpretacao","title":"2.6. Interpreta\u00e7\u00e3o","text":"Valor Interpreta\u00e7\u00e3o 0% - 10% Normal &gt;10% Elevado - investigar"},{"location":"indicadores/grupo2-quantidade.html#3-media-de-itens-por-cupom","title":"3. M\u00e9dia de Itens por Cupom","text":""},{"location":"indicadores/grupo2-quantidade.html#31-definicao","title":"3.1. Defini\u00e7\u00e3o","text":"<p>Calcula a m\u00e9dia de medicamentos dispensados por autoriza\u00e7\u00e3o (cupom fiscal).</p>"},{"location":"indicadores/grupo2-quantidade.html#32-script","title":"3.2. Script","text":"<pre><code>\ud83d\udcc4 Indicadores/media_itens.sql\n</code></pre>"},{"location":"indicadores/grupo2-quantidade.html#33-logica-de-calculo","title":"3.3. L\u00f3gica de C\u00e1lculo","text":""},{"location":"indicadores/grupo2-quantidade.html#algoritmo_2","title":"Algoritmo","text":"<ol> <li>Contagem Total: Conta todas as linhas de venda</li> <li>Contagem de Cupons: Conta autoriza\u00e7\u00f5es \u00fanicas</li> <li>Divis\u00e3o: Calcula a m\u00e9dia</li> </ol>"},{"location":"indicadores/grupo2-quantidade.html#34-formula","title":"3.4. F\u00f3rmula","text":"\\[ \\text{M\u00e9dia de Itens} = \\frac{\\text{Total de Linhas de Venda}}{\\text{Total de Autoriza\u00e7\u00f5es \u00danicas}} \\]"},{"location":"indicadores/grupo2-quantidade.html#35-interpretacao","title":"3.5. Interpreta\u00e7\u00e3o","text":"Valor Interpreta\u00e7\u00e3o 1.0 - 2.5 Normal (a maioria dos pacientes leva 1-2 medicamentos) &gt;2.5 Elevado - investigar"},{"location":"indicadores/grupo2-quantidade.html#4-resumo-do-grupo","title":"4. Resumo do Grupo","text":"Indicador M\u00e9trica F\u00f3rmula Alerta Dispensa\u00e7\u00e3o em Teto % vendas Vendas no teto / Total vendas &gt; 65% Polimedicamentos % cupons Cupons \u22654 itens / Total cupons &gt; 10% M\u00e9dia de Itens M\u00e9dia Total linhas / Total cupons &gt; 2.5 <p>Pr\u00f3ximo Grupo</p> <p>Veja o Grupo 3: Padr\u00f5es Financeiros para indicadores relacionados a valores e tickets.</p>"},{"location":"indicadores/grupo3-financeiro.html","title":"Grupo 3: Indicadores de Padr\u00f5es Financeiros","text":"<p>Este grupo cont\u00e9m indicadores que analisam os padr\u00f5es financeiros das vendas, incluindo valores m\u00e9dios, faturamento per capita e concentra\u00e7\u00e3o em medicamentos de alto custo.</p>"},{"location":"indicadores/grupo3-financeiro.html#1-ticket-medio","title":"1. Ticket M\u00e9dio","text":""},{"location":"indicadores/grupo3-financeiro.html#11-definicao","title":"1.1. Defini\u00e7\u00e3o","text":"<p>Calcula o valor m\u00e9dio de cada transa\u00e7\u00e3o (autoriza\u00e7\u00e3o/cupom fiscal).</p>"},{"location":"indicadores/grupo3-financeiro.html#12-script","title":"1.2. Script","text":"<pre><code>\ud83d\udcc4 Indicadores/tickermedio.sql\n</code></pre>"},{"location":"indicadores/grupo3-financeiro.html#13-logica-de-calculo","title":"1.3. L\u00f3gica de C\u00e1lculo","text":""},{"location":"indicadores/grupo3-financeiro.html#algoritmo","title":"Algoritmo","text":"<ol> <li>Soma: Agrega o valor total de todas as vendas</li> <li>Contagem: Conta o n\u00famero de autoriza\u00e7\u00f5es \u00fanicas</li> <li>Divis\u00e3o: Calcula a m\u00e9dia</li> </ol>"},{"location":"indicadores/grupo3-financeiro.html#14-formula","title":"1.4. F\u00f3rmula","text":"\\[ \\text{Ticket M\u00e9dio} = \\frac{\\sum \\text{Valor Autorizado}}{\\text{COUNT(DISTINCT nu\\_autorizacao)}} \\]"},{"location":"indicadores/grupo3-financeiro.html#15-interpretacao","title":"1.5. Interpreta\u00e7\u00e3o","text":"<p>O ticket m\u00e9dio varia significativamente por regi\u00e3o e tipo de clientela. A an\u00e1lise deve ser feita comparativamente:</p> Situa\u00e7\u00e3o Interpreta\u00e7\u00e3o Ticket \u2248 M\u00e9dia UF Normal Ticket &gt; 2x M\u00e9dia UF Elevado - verificar"},{"location":"indicadores/grupo3-financeiro.html#16-fatores-que-influenciam","title":"1.6. Fatores que Influenciam","text":"Fator Efeito no Ticket Especializa\u00e7\u00e3o em medicamentos caros \u2b06\ufe0f Aumenta Clientela de baixa renda \u2b07\ufe0f Reduz Proximidade de unidades de sa\u00fade \u2b07\ufe0f Reduz (mais copagamento) Fraude (maximiza\u00e7\u00e3o de valores) \u2b06\ufe0f Aumenta"},{"location":"indicadores/grupo3-financeiro.html#2-receita-media-por-paciente","title":"2. Receita M\u00e9dia por Paciente","text":""},{"location":"indicadores/grupo3-financeiro.html#21-definicao","title":"2.1. Defini\u00e7\u00e3o","text":"<p>Calcula o faturamento m\u00e9dio por CPF distinto atendido.</p>"},{"location":"indicadores/grupo3-financeiro.html#22-script","title":"2.2. Script","text":"<pre><code>\ud83d\udcc4 Indicadores/receita_por_paciente.sql\n</code></pre>"},{"location":"indicadores/grupo3-financeiro.html#23-logica-de-calculo","title":"2.3. L\u00f3gica de C\u00e1lculo","text":""},{"location":"indicadores/grupo3-financeiro.html#algoritmo_1","title":"Algoritmo","text":"<ol> <li>Soma: Agrega o faturamento total</li> <li>Contagem: Conta CPFs \u00fanicos atendidos</li> <li>Divis\u00e3o: Calcula a m\u00e9dia</li> </ol>"},{"location":"indicadores/grupo3-financeiro.html#24-formula","title":"2.4. F\u00f3rmula","text":"\\[ \\text{Receita por Paciente} = \\frac{\\sum \\text{Faturamento Total}}{\\text{COUNT(DISTINCT cpf)}} \\]"},{"location":"indicadores/grupo3-financeiro.html#25-interpretacao","title":"2.5. Interpreta\u00e7\u00e3o","text":"Situa\u00e7\u00e3o Poss\u00edvel Causa Valor muito baixo Muitos pacientes espor\u00e1dicos Valor na m\u00e9dia Normal Valor muito alto Poucos pacientes com muitas compras (concentra\u00e7\u00e3o) Valor extremamente alto Poss\u00edvel uso de CPFs fict\u00edcios"},{"location":"indicadores/grupo3-financeiro.html#26-analise-combinada","title":"2.6. An\u00e1lise Combinada","text":"<p>Cruzamento \u00datil</p> <p>Combine este indicador com o n\u00famero de pacientes \u00fanicos para uma an\u00e1lise mais completa:</p> <pre><code>- **Alta receita + Poucos pacientes:** Concentra\u00e7\u00e3o suspeita\n- **Alta receita + Muitos pacientes:** Perfil de clientela de alto consumo\n</code></pre>"},{"location":"indicadores/grupo3-financeiro.html#3-venda-per-capita-municipal","title":"3. Venda Per Capita Municipal","text":""},{"location":"indicadores/grupo3-financeiro.html#31-definicao","title":"3.1. Defini\u00e7\u00e3o","text":"<p>Calcula o faturamento da farm\u00e1cia dividido pela popula\u00e7\u00e3o do munic\u00edpio.</p>"},{"location":"indicadores/grupo3-financeiro.html#32-script","title":"3.2. Script","text":"<pre><code>\ud83d\udcc4 Indicadores/venda_per_capita.sql\n</code></pre>"},{"location":"indicadores/grupo3-financeiro.html#33-contexto","title":"3.3. Contexto","text":"<p>Este indicador contextualiza o faturamento em rela\u00e7\u00e3o ao tamanho do mercado potencial. Uma farm\u00e1cia em uma cidade pequena com faturamento muito alto pode estar atendendo pacientes de outras regi\u00f5es ou fabricando vendas.</p>"},{"location":"indicadores/grupo3-financeiro.html#34-logica-de-calculo","title":"3.4. L\u00f3gica de C\u00e1lculo","text":""},{"location":"indicadores/grupo3-financeiro.html#fontes-de-dados","title":"Fontes de Dados","text":"Tabela Uso <code>movimentacaoFP</code> ou <code>resultado_Sentinela</code> Faturamento da farm\u00e1cia <code>tb_ibge</code> ou <code>dadosFarmaciasFP</code> Popula\u00e7\u00e3o do munic\u00edpio"},{"location":"indicadores/grupo3-financeiro.html#algoritmo_2","title":"Algoritmo","text":"<ol> <li>Soma: Obt\u00e9m o faturamento total da farm\u00e1cia</li> <li>Busca: Obt\u00e9m a popula\u00e7\u00e3o do munic\u00edpio</li> <li>Divis\u00e3o: Calcula o per capita</li> </ol>"},{"location":"indicadores/grupo3-financeiro.html#35-formula","title":"3.5. F\u00f3rmula","text":"\\[ \\text{Per Capita} = \\frac{\\text{Faturamento Total da Farm\u00e1cia}}{\\text{Popula\u00e7\u00e3o do Munic\u00edpio}} \\]"},{"location":"indicadores/grupo3-financeiro.html#36-interpretacao","title":"3.6. Interpreta\u00e7\u00e3o","text":"<p>A interpreta\u00e7\u00e3o deve considerar:</p> <ul> <li>N\u00famero de farm\u00e1cias no munic\u00edpio</li> <li>M\u00e9dia estadual do indicador</li> <li>Posi\u00e7\u00e3o geogr\u00e1fica (cidade-polo atrai pacientes de outras cidades)</li> </ul> Situa\u00e7\u00e3o Interpreta\u00e7\u00e3o Per capita \u2248 M\u00e9dia UF Normal Per capita &gt; 2x M\u00e9dia UF Elevado"},{"location":"indicadores/grupo3-financeiro.html#4-medicamentos-de-alto-custo","title":"4. Medicamentos de Alto Custo","text":""},{"location":"indicadores/grupo3-financeiro.html#41-definicao","title":"4.1. Defini\u00e7\u00e3o","text":"<p>Mede a propor\u00e7\u00e3o do faturamento proveniente de medicamentos de alto custo (percentil 90 de pre\u00e7o).</p>"},{"location":"indicadores/grupo3-financeiro.html#42-script","title":"4.2. Script","text":"<pre><code>\ud83d\udcc4 Indicadores/medicamentos_alto_custo.sql\n</code></pre>"},{"location":"indicadores/grupo3-financeiro.html#43-contexto","title":"4.3. Contexto","text":"<p>Medicamentos mais caros oferecem maiores margens para fraude, pois:</p> <ul> <li>Maximizam o valor de vendas fict\u00edcias</li> <li>Geram maior ressarcimento com menos transa\u00e7\u00f5es</li> <li>S\u00e3o mais dif\u00edceis de auditar individualmente</li> </ul>"},{"location":"indicadores/grupo3-financeiro.html#44-logica-de-calculo","title":"4.4. L\u00f3gica de C\u00e1lculo","text":""},{"location":"indicadores/grupo3-financeiro.html#classificacao-de-alto-custo","title":"Classifica\u00e7\u00e3o de Alto Custo","text":"<p>Medicamentos s\u00e3o classificados como \"alto custo\" se seu pre\u00e7o unit\u00e1rio estiver no percentil 90 ou superior da tabela de medicamentos.</p>"},{"location":"indicadores/grupo3-financeiro.html#algoritmo_3","title":"Algoritmo","text":"<ol> <li>Classifica\u00e7\u00e3o: Marca medicamentos de alto custo (<code>flag_alto_custo = 1</code>)</li> <li>Soma: Agrega valor das vendas de medicamentos de alto custo</li> <li>Percentual: Divide pelo faturamento total</li> </ol>"},{"location":"indicadores/grupo3-financeiro.html#45-formula","title":"4.5. F\u00f3rmula","text":"\\[ \\% \\text{Alto Custo} = \\frac{\\sum \\text{Vendas de Medicamentos Alto Custo}}{\\sum \\text{Faturamento Total}} \\times 100 \\]"},{"location":"indicadores/grupo3-financeiro.html#46-interpretacao","title":"4.6. Interpreta\u00e7\u00e3o","text":"Valor Interpreta\u00e7\u00e3o 0% - 40% Normal ** &gt;40% ** Elevado - investigar"},{"location":"indicadores/grupo3-financeiro.html#5-resumo-do-grupo","title":"5. Resumo do Grupo","text":"Indicador M\u00e9trica Unidade Alerta Ticket M\u00e9dio M\u00e9dia de valor por cupom R$ &gt; 2x m\u00e9dia UF Receita por Paciente Faturamento por CPF R$ &gt; 2x m\u00e9dia UF Venda Per Capita Faturamento / popula\u00e7\u00e3o R$ &gt; 2x m\u00e9dia UF Medicamentos Alto Custo % do faturamento % &gt; 40%"},{"location":"indicadores/grupo3-financeiro.html#6-analise-integrada","title":"6. An\u00e1lise Integrada","text":""},{"location":"indicadores/grupo3-financeiro.html#61-padrao-de-maximizacao-financeira","title":"6.1. Padr\u00e3o de Maximiza\u00e7\u00e3o Financeira","text":"<p>Quando uma farm\u00e1cia apresenta valores elevados em m\u00faltiplos indicadores deste grupo, pode indicar uma estrat\u00e9gia de maximiza\u00e7\u00e3o de fraude:</p> flowchart TD     A[Alto Ticket M\u00e9dio] --&gt; D{Fraude?}     B[Alta Receita por Paciente] --&gt; D     C[Alto % de Medicamentos Caros] --&gt; D     D --&gt;|3 indicadores altos| E[\ud83d\udd34 Alta probabilidade]     D --&gt;|2 indicadores altos| F[\ud83d\udfe0 Investigar]     D --&gt;|1 indicador alto| G[\ud83d\udfe1 Monitorar]"},{"location":"indicadores/grupo3-financeiro.html#62-exemplo","title":"6.2. Exemplo","text":"<p>Cen\u00e1rio Suspeito</p> <p>Farm\u00e1cia com:</p> <pre><code>- Ticket m\u00e9dio: R$ 50 (m\u00e9dia UF: R$ 20)\n- Receita por paciente: R$ 400 (m\u00e9dia UF: R$ 200)\n- % Medicamentos alto custo: 60%\n\n**An\u00e1lise:**\n\nEsta combina\u00e7\u00e3o \u00e9 altamente suspeita. A farm\u00e1cia parece estar:\n\n1. Concentrando vendas em medicamentos caros\n2. Maximizando o valor de cada transa\u00e7\u00e3o\n3. Utilizando poucos CPFs para grandes volumes\n</code></pre> <p>Pr\u00f3ximo Grupo</p> <p>Veja o Grupo 4: Automa\u00e7\u00e3o &amp; Geografia para indicadores de padr\u00f5es operacionais e geogr\u00e1ficos.</p>"},{"location":"indicadores/grupo4-automacao.html","title":"Grupo 4: Indicadores de Automa\u00e7\u00e3o &amp; Geografia","text":"<p>Este grupo cont\u00e9m indicadores que detectam padr\u00f5es operacionais at\u00edpicos e anomalias geogr\u00e1ficas que podem indicar automa\u00e7\u00e3o de fraude ou opera\u00e7\u00f5es fora do padr\u00e3o normal.</p>"},{"location":"indicadores/grupo4-automacao.html#1-vendas-consecutivas-rapidas-60-segundos","title":"1. Vendas Consecutivas R\u00e1pidas (&lt;60 segundos)","text":""},{"location":"indicadores/grupo4-automacao.html#11-definicao","title":"1.1. Defini\u00e7\u00e3o","text":"<p>Mede a propor\u00e7\u00e3o de vendas que ocorrem em um intervalo de menos de 60 segundos ap\u00f3s a venda anterior.</p>"},{"location":"indicadores/grupo4-automacao.html#12-script","title":"1.2. Script","text":"<pre><code>\ud83d\udcc4 Indicadores/vendas_consecutivas.sql\n</code></pre>"},{"location":"indicadores/grupo4-automacao.html#13-contexto","title":"1.3. Contexto","text":"<p>Uma venda leg\u00edtima envolve:</p> <ul> <li>Apresenta\u00e7\u00e3o de documentos e receita</li> <li>Consulta ao sistema</li> <li>Confer\u00eancia dos medicamentos</li> <li>Processamento do pagamento</li> </ul> <p>Este processo leva, no m\u00ednimo, alguns minutos. Vendas consecutivas em menos de 1 minuto podem indicar:</p> <ul> <li>Automa\u00e7\u00e3o: Scripts inserindo vendas fict\u00edcias</li> <li>Fraude estruturada: M\u00faltiplas vendas pr\u00e9-preparadas</li> </ul>"},{"location":"indicadores/grupo4-automacao.html#14-logica-de-calculo","title":"1.4. L\u00f3gica de C\u00e1lculo","text":""},{"location":"indicadores/grupo4-automacao.html#algoritmo","title":"Algoritmo","text":"<ol> <li>Ordena\u00e7\u00e3o: Ordena vendas por <code>data_hora</code> para cada PDV</li> <li>C\u00e1lculo de Delta: Usa <code>LAG()</code> para obter a venda anterior</li> <li>Diferen\u00e7a de Tempo: Calcula <code>DATEDIFF(SECOND, venda_anterior, venda_atual)</code></li> <li>Filtro: Seleciona onde delta &gt; 0 e delta &lt; 60</li> <li>Percentual: Divide pelo total de vendas</li> </ol>"},{"location":"indicadores/grupo4-automacao.html#15-formula","title":"1.5. F\u00f3rmula","text":"\\[ \\% \\text{Vendas R\u00e1pidas} = \\frac{\\text{Vendas com intervalo } &lt; 60s}{\\text{Total de Vendas}} \\times 100 \\]"},{"location":"indicadores/grupo4-automacao.html#16-interpretacao","title":"1.6. Interpreta\u00e7\u00e3o","text":"Valor Interpreta\u00e7\u00e3o 0% - 5% Normal &gt;5% Elevado - Investigar"},{"location":"indicadores/grupo4-automacao.html#2-horario-atipico-madrugada","title":"2. Hor\u00e1rio At\u00edpico (Madrugada)","text":""},{"location":"indicadores/grupo4-automacao.html#21-definicao","title":"2.1. Defini\u00e7\u00e3o","text":"<p>Mede a propor\u00e7\u00e3o de vendas processadas entre 00h00 e 06h00.</p>"},{"location":"indicadores/grupo4-automacao.html#22-script","title":"2.2. Script","text":"<pre><code>\ud83d\udcc4 Indicadores/horario_atipico.sql\n</code></pre>"},{"location":"indicadores/grupo4-automacao.html#23-contexto","title":"2.3. Contexto","text":"<p>A maioria das farm\u00e1cias opera em hor\u00e1rio comercial. Vendas na madrugada podem indicar:</p> <ul> <li>Farm\u00e1cias 24h leg\u00edtimas: Algumas farm\u00e1cias operam neste hor\u00e1rio</li> <li>Inser\u00e7\u00e3o de vendas fict\u00edcias: Fraudes s\u00e3o inseridas fora do expediente</li> <li>Altera\u00e7\u00e3o de timestamps: Manipula\u00e7\u00e3o de registros</li> </ul>"},{"location":"indicadores/grupo4-automacao.html#24-logica-de-calculo","title":"2.4. L\u00f3gica de C\u00e1lculo","text":""},{"location":"indicadores/grupo4-automacao.html#algoritmo_1","title":"Algoritmo","text":"<ol> <li>Extra\u00e7\u00e3o de Hora: <code>DATEPART(HOUR, data_hora)</code></li> <li>Filtro: Seleciona onde hora &gt;= 0 e hora &lt; 6</li> <li>Contagem: Conta vendas neste per\u00edodo</li> <li>Percentual: Divide pelo total</li> </ol>"},{"location":"indicadores/grupo4-automacao.html#25-formula","title":"2.5. F\u00f3rmula","text":"\\[ \\% \\text{Madrugada} = \\frac{\\text{Vendas entre 00h e 06h}}{\\text{Total de Vendas}} \\times 100 \\]"},{"location":"indicadores/grupo4-automacao.html#26-interpretacao","title":"2.6. Interpreta\u00e7\u00e3o","text":"Valor Interpreta\u00e7\u00e3o 0% - 1% Normal &gt;1% Elevado - Investigar"},{"location":"indicadores/grupo4-automacao.html#3-concentracao-em-dias-de-pico","title":"3. Concentra\u00e7\u00e3o em Dias de Pico","text":""},{"location":"indicadores/grupo4-automacao.html#31-definicao","title":"3.1. Defini\u00e7\u00e3o","text":"<p>Mede a propor\u00e7\u00e3o do faturamento mensal concentrada nos 3 dias de maior movimento.</p>"},{"location":"indicadores/grupo4-automacao.html#32-script","title":"3.2. Script","text":"<pre><code>\ud83d\udcc4 Indicadores/concentracao_dias_pico.sql\n</code></pre>"},{"location":"indicadores/grupo4-automacao.html#33-contexto","title":"3.3. Contexto","text":"<p>Um padr\u00e3o de vendas natural apresenta distribui\u00e7\u00e3o ao longo do m\u00eas. Concentra\u00e7\u00e3o excessiva em poucos dias pode indicar:</p> <ul> <li>Inser\u00e7\u00e3o de vendas em lote: Fraudes processadas de uma vez</li> <li>Manipula\u00e7\u00e3o de datas: Altera\u00e7\u00e3o de timestamps</li> </ul>"},{"location":"indicadores/grupo4-automacao.html#34-logica-de-calculo","title":"3.4. L\u00f3gica de C\u00e1lculo","text":""},{"location":"indicadores/grupo4-automacao.html#algoritmo_2","title":"Algoritmo","text":"<ol> <li>Agrupamento: Agrupa vendas por dia do m\u00eas</li> <li>Ordena\u00e7\u00e3o: Ordena por valor decrescente</li> <li>Sele\u00e7\u00e3o: Seleciona os 3 dias de maior volume</li> <li>Soma: Soma o valor desses 3 dias</li> <li>Percentual: Divide pelo faturamento mensal total</li> </ol>"},{"location":"indicadores/grupo4-automacao.html#35-formula","title":"3.5. F\u00f3rmula","text":"\\[ \\% \\text{Pico} = \\frac{\\sum \\text{Valor nos 3 maiores dias}}{\\sum \\text{Faturamento Mensal}} \\times 100 \\]"},{"location":"indicadores/grupo4-automacao.html#36-interpretacao","title":"3.6. Interpreta\u00e7\u00e3o","text":"Valor Interpreta\u00e7\u00e3o 10% - 30% Normal &gt;30% Elevado - Investigar"},{"location":"indicadores/grupo4-automacao.html#4-dispersao-geografica","title":"4. Dispers\u00e3o Geogr\u00e1fica","text":""},{"location":"indicadores/grupo4-automacao.html#41-definicao","title":"4.1. Defini\u00e7\u00e3o","text":"<p>Mede a propor\u00e7\u00e3o de vendas para pacientes residentes em UF diferente da localiza\u00e7\u00e3o da farm\u00e1cia.</p>"},{"location":"indicadores/grupo4-automacao.html#42-script","title":"4.2. Script","text":"<pre><code>\ud83d\udcc4 Indicadores/geografico.sql\n</code></pre>"},{"location":"indicadores/grupo4-automacao.html#43-contexto","title":"4.3. Contexto","text":"<p>Pacientes geralmente buscam farm\u00e1cias pr\u00f3ximas de sua resid\u00eancia. Alto percentual de pacientes de outras UFs pode indicar:</p> <ul> <li>Farm\u00e1cia em regi\u00e3o de fronteira: Leg\u00edtimo em cidades-polo</li> <li>Uso de CPFs de outras regi\u00f5es: Fraude com identidades distantes</li> <li>Pacientes fict\u00edcios: CPFs de regi\u00f5es onde n\u00e3o h\u00e1 verifica\u00e7\u00e3o local</li> </ul>"},{"location":"indicadores/grupo4-automacao.html#44-logica-de-calculo","title":"4.4. L\u00f3gica de C\u00e1lculo","text":""},{"location":"indicadores/grupo4-automacao.html#fontes-de-dados","title":"Fontes de Dados","text":"Tabela Uso <code>movimentacaoFP</code> UF da farm\u00e1cia <code>db_CPF</code> ou Cart\u00e3o SUS UF de resid\u00eancia do paciente"},{"location":"indicadores/grupo4-automacao.html#algoritmo_3","title":"Algoritmo","text":"<ol> <li>Cruzamento: Junta vendas com dados do paciente</li> <li>Compara\u00e7\u00e3o: Verifica se <code>UF_farmacia != UF_paciente</code></li> <li>Contagem: Conta vendas com UF diferente</li> <li>Percentual: Divide pelo total</li> </ol>"},{"location":"indicadores/grupo4-automacao.html#45-formula","title":"4.5. F\u00f3rmula","text":"\\[ \\% \\text{Dispers\u00e3o} = \\frac{\\text{Vendas para Pacientes de Outra UF}}{\\text{Total de Vendas}} \\times 100 \\]"},{"location":"indicadores/grupo4-automacao.html#5-pacientes-unicos-one-off","title":"5. Pacientes \u00danicos (One-off)","text":""},{"location":"indicadores/grupo4-automacao.html#51-definicao","title":"5.1. Defini\u00e7\u00e3o","text":"<p>Mede a propor\u00e7\u00e3o de CPFs que realizaram apenas uma compra em todo o per\u00edodo analisado.</p>"},{"location":"indicadores/grupo4-automacao.html#52-script","title":"5.2. Script","text":"<pre><code>\ud83d\udcc4 Indicadores/pacientes_unicos.sql\n</code></pre>"},{"location":"indicadores/grupo4-automacao.html#53-contexto","title":"5.3. Contexto","text":"<p>Medicamentos para doen\u00e7as cr\u00f4nicas s\u00e3o de uso cont\u00ednuo. Pacientes leg\u00edtimos tendem a retornar periodicamente. Alto percentual de pacientes \u00fanicos pode indicar:</p> <ul> <li>CPFs usados uma vez: Evitar detec\u00e7\u00e3o de padr\u00f5es</li> <li>Vendas fict\u00edcias: Cada venda usa CPF diferente</li> <li>Farm\u00e1cia de passagem: Leg\u00edtimo em locais tur\u00edsticos</li> </ul>"},{"location":"indicadores/grupo4-automacao.html#54-logica-de-calculo","title":"5.4. L\u00f3gica de C\u00e1lculo","text":""},{"location":"indicadores/grupo4-automacao.html#algoritmo_4","title":"Algoritmo","text":"<ol> <li>Agrupamento: Agrupa vendas por CPF</li> <li>Contagem: Conta compras por CPF</li> <li>Filtro: Seleciona CPFs com exatamente 1 compra</li> <li>Percentual: Divide pelo total de CPFs distintos</li> </ol>"},{"location":"indicadores/grupo4-automacao.html#55-formula","title":"5.5. F\u00f3rmula","text":"\\[ \\% \\text{Pacientes \u00danicos} = \\frac{\\text{CPFs com apenas 1 compra}}{\\text{Total de CPFs distintos}} \\times 100 \\]"},{"location":"indicadores/grupo4-automacao.html#6-resumo-do-grupo","title":"6. Resumo do Grupo","text":"Indicador M\u00e9trica Alerta Vendas R\u00e1pidas (&lt;60s) % vendas &gt; 5% Hor\u00e1rio At\u00edpico % vendas &gt; 5% Concentra\u00e7\u00e3o em Pico % faturamento &gt; 40% Dispers\u00e3o Geogr\u00e1fica % vendas Pacientes \u00danicos % CPFs"},{"location":"indicadores/grupo4-automacao.html#7-padrao-de-automacao","title":"7. Padr\u00e3o de Automa\u00e7\u00e3o","text":"<p>Combina\u00e7\u00e3o Cr\u00edtica</p> <p>Quando uma farm\u00e1cia apresenta valores elevados em Vendas R\u00e1pidas E Hor\u00e1rio At\u00edpico simultaneamente, \u00e9 forte indicativo de:</p> <pre><code>- Scripts automatizados inserindo vendas\n- Processamento em lote fora do expediente\n- Fraude estruturada e sistem\u00e1tica\n</code></pre> <p>Pr\u00f3ximo Grupo</p> <p>Veja o Grupo 5: Integridade M\u00e9dica (CRMs) para indicadores focados nos prescritores.</p>"},{"location":"indicadores/grupo5-crms.html","title":"Grupo 5: Indicadores de Integridade M\u00e9dica (CRMs)","text":"<p>Este grupo cont\u00e9m indicadores focados nos padr\u00f5es de prescri\u00e7\u00e3o m\u00e9dica, identificando concentra\u00e7\u00e3o, irregularidades e comportamentos at\u00edpicos dos prescritores.</p>"},{"location":"indicadores/grupo5-crms.html#1-concentracao-de-prescritores-indice-hhi","title":"1. Concentra\u00e7\u00e3o de Prescritores (\u00cdndice HHI)","text":""},{"location":"indicadores/grupo5-crms.html#11-definicao","title":"1.1. Defini\u00e7\u00e3o","text":"<p>O \u00cdndice Herfindahl-Hirschman (HHI) mede a concentra\u00e7\u00e3o das vendas em poucos prescritores. Quanto maior o \u00edndice, maior a depend\u00eancia da farm\u00e1cia de poucos m\u00e9dicos.</p>"},{"location":"indicadores/grupo5-crms.html#12-scripts","title":"1.2. Scripts","text":"<pre><code>\ud83d\udcc4 Indicadores/crms.sql\n\ud83d\udcc4 Indicadores/gerador_dados_para_indicador_crms.sql\n</code></pre>"},{"location":"indicadores/grupo5-crms.html#13-contexto","title":"1.3. Contexto","text":"<p>Uma farm\u00e1cia leg\u00edtima atende pacientes de diversos m\u00e9dicos. Concentra\u00e7\u00e3o excessiva pode indicar:</p> <ul> <li>Acordo com m\u00e9dicos: Direcionamento de pacientes</li> <li>CRMs fict\u00edcios: Uso de poucos CRMs para todas as vendas</li> <li>Esquema organizado: M\u00e9dicos \"parceiros\" da fraude</li> </ul>"},{"location":"indicadores/grupo5-crms.html#14-logica-de-calculo","title":"1.4. L\u00f3gica de C\u00e1lculo","text":""},{"location":"indicadores/grupo5-crms.html#conceito-do-hhi","title":"Conceito do HHI","text":"<p>O HHI \u00e9 um \u00edndice econ\u00f4mico padr\u00e3o para medir concentra\u00e7\u00e3o de mercado. No contexto do Sentinela, mede a concentra\u00e7\u00e3o de prescritores.</p>"},{"location":"indicadores/grupo5-crms.html#algoritmo","title":"Algoritmo","text":"<ol> <li>Agrupamento: Agrupa vendas por CRM</li> <li>C\u00e1lculo de Participa\u00e7\u00e3o: Para cada CRM, calcula <code>participa\u00e7\u00e3o = vendas_crm / vendas_total</code></li> <li>Quadrado: Eleva cada participa\u00e7\u00e3o ao quadrado</li> <li>Soma: Soma todos os quadrados</li> <li>Escala: Multiplica por 10.000 (conven\u00e7\u00e3o HHI)</li> </ol>"},{"location":"indicadores/grupo5-crms.html#15-formula","title":"1.5. F\u00f3rmula","text":"\\[ \\text{HHI} = \\sum_{i=1}^{n} (S_i \\times 100)^2 \\] <p>Onde \\(S_i\\) \u00e9 a participa\u00e7\u00e3o percentual do m\u00e9dico \\(i\\) nas vendas.</p>"},{"location":"indicadores/grupo5-crms.html#16-interpretacao","title":"1.6. Interpreta\u00e7\u00e3o","text":"HHI Classifica\u00e7\u00e3o Interpreta\u00e7\u00e3o &lt; 1.500 Baixa concentra\u00e7\u00e3o Normal - m\u00faltiplos prescritores 1.500 - 2.500 Concentra\u00e7\u00e3o moderada Aten\u00e7\u00e3o &gt; 2.500 Alta concentra\u00e7\u00e3o Investigar - poucos CRMs dominam &gt; 5.000 Concentra\u00e7\u00e3o extrema Cr\u00edtico"},{"location":"indicadores/grupo5-crms.html#17-exemplo-de-calculo","title":"1.7. Exemplo de C\u00e1lculo","text":"<p>Exemplo</p> <p>Farm\u00e1cia A - Diversificada:</p> <pre><code>- CRM 1: 20% das vendas \u2192 (20)\u00b2 = 400\n- CRM 2: 15% das vendas \u2192 (15)\u00b2 = 225\n- CRM 3: 10% das vendas \u2192 (10)\u00b2 = 100\n- Outros 50 CRMs: 55% \u2192 ~60 (disperso)\n\n**HHI \u2248 785** (Baixa concentra\u00e7\u00e3o \u2705)\n\n---\n\n**Farm\u00e1cia B - Concentrada:**\n\n- CRM 1: 60% das vendas \u2192 (60)\u00b2 = 3.600\n- CRM 2: 25% das vendas \u2192 (25)\u00b2 = 625\n- CRM 3: 15% das vendas \u2192 (15)\u00b2 = 225\n\n**HHI = 4.450** (Alta concentra\u00e7\u00e3o \u274c)\n</code></pre>"},{"location":"indicadores/grupo5-crms.html#2-exclusividade-de-crm","title":"2. Exclusividade de CRM","text":""},{"location":"indicadores/grupo5-crms.html#21-definicao","title":"2.1. Defini\u00e7\u00e3o","text":"<p>Mede a propor\u00e7\u00e3o de m\u00e9dicos que prescrevem exclusivamente para esta farm\u00e1cia em todo o Brasil.</p>"},{"location":"indicadores/grupo5-crms.html#22-script","title":"2.2. Script","text":"<pre><code>\ud83d\udcc4 Indicadores/exclusividade_crm.sql\n</code></pre>"},{"location":"indicadores/grupo5-crms.html#23-contexto","title":"2.3. Contexto","text":"<p>Um m\u00e9dico leg\u00edtimo atende em consult\u00f3rios e prescreve para diversas farm\u00e1cias onde seus pacientes se sentem confort\u00e1veis. Um CRM que s\u00f3 aparece em uma \u00fanica farm\u00e1cia no pa\u00eds inteiro \u00e9 altamente suspeito:</p> <ul> <li>Pode ser um CRM fict\u00edcio ou de m\u00e9dico falecido</li> <li>Pode indicar acordo exclusivo (ilegal)</li> <li>Pode ser fraude com receitas falsas</li> </ul>"},{"location":"indicadores/grupo5-crms.html#24-logica-de-calculo","title":"2.4. L\u00f3gica de C\u00e1lculo","text":""},{"location":"indicadores/grupo5-crms.html#algoritmo_1","title":"Algoritmo","text":"<ol> <li>Levantamento: Para cada CRM, lista todos os CNPJs onde prescreveu</li> <li>Contagem: Conta CNPJs distintos por CRM</li> <li>Filtro: Identifica CRMs com COUNT(DISTINCT CNPJ) = 1</li> <li>Soma: Soma o valor das vendas desses CRMs</li> <li>Percentual: Divide pelo faturamento total</li> </ol>"},{"location":"indicadores/grupo5-crms.html#25-formula","title":"2.5. F\u00f3rmula","text":"\\[ \\% \\text{Exclusividade} = \\frac{\\sum \\text{Vendas de CRMs Exclusivos}}{\\sum \\text{Faturamento Total}} \\times 100 \\]"},{"location":"indicadores/grupo5-crms.html#26-interpretacao","title":"2.6. Interpreta\u00e7\u00e3o","text":"Valor Interpreta\u00e7\u00e3o 0% - 5% Normal &gt;5% Elevado - Investigar"},{"location":"indicadores/grupo5-crms.html#3-irregularidade-de-crm","title":"3. Irregularidade de CRM","text":""},{"location":"indicadores/grupo5-crms.html#31-definicao","title":"3.1. Defini\u00e7\u00e3o","text":"<p>Mede a propor\u00e7\u00e3o de vendas vinculadas a CRMs inv\u00e1lidos ou com prescri\u00e7\u00e3o anterior ao registro.</p>"},{"location":"indicadores/grupo5-crms.html#32-script","title":"3.2. Script","text":"<pre><code>\ud83d\udcc4 Indicadores/crms_irregulares.sql\n</code></pre>"},{"location":"indicadores/grupo5-crms.html#33-tipos-de-irregularidade","title":"3.3. Tipos de Irregularidade","text":"Tipo Descri\u00e7\u00e3o Gravidade CRM Inexistente N\u00e3o encontrado na base do CFM \ud83d\udd34 Cr\u00edtico CRM Cancelado M\u00e9dico com registro cancelado \ud83d\udd34 Cr\u00edtico Prescri\u00e7\u00e3o Retroativa Data da prescri\u00e7\u00e3o &lt; Data de registro no CFM \ud83d\udd34 Cr\u00edtico CRM de Outra UF M\u00e9dico prescrevendo fora de sua jurisdi\u00e7\u00e3o \ud83d\udfe1 Moderado"},{"location":"indicadores/grupo5-crms.html#34-logica-de-calculo","title":"3.4. L\u00f3gica de C\u00e1lculo","text":""},{"location":"indicadores/grupo5-crms.html#fontes-de-dados","title":"Fontes de Dados","text":"Tabela Uso <code>movimentacaoFP</code> CRM das vendas Base CFM Registro de m\u00e9dicos e datas"},{"location":"indicadores/grupo5-crms.html#algoritmo_2","title":"Algoritmo","text":"<ol> <li>Cruzamento: Junta vendas com base do CFM</li> <li>Verifica\u00e7\u00e3o 1: CRM IS NULL (n\u00e3o encontrado)</li> <li>Verifica\u00e7\u00e3o 2: Data_Venda &lt; Data_Inscricao_CRM</li> <li>Soma: Agrega valores das vendas irregulares</li> <li>Percentual: Divide pelo faturamento total</li> </ol>"},{"location":"indicadores/grupo5-crms.html#35-formula","title":"3.5. F\u00f3rmula","text":"\\[ \\% \\text{CRM Irregular} = \\frac{\\sum \\text{Vendas com CRM Irregular}}{\\sum \\text{Faturamento Total}} \\times 100 \\]"},{"location":"indicadores/grupo5-crms.html#36-interpretacao","title":"3.6. Interpreta\u00e7\u00e3o","text":"Valor Interpreta\u00e7\u00e3o 0% Ideal &gt; 0% Cr\u00edtico - fraude"},{"location":"indicadores/grupo5-crms.html#4-resumo-do-grupo","title":"4. Resumo do Grupo","text":"Indicador M\u00e9trica Alerta Concentra\u00e7\u00e3o HHI \u00cdndice 0-10.000 &gt; 2.500 Exclusividade CRM % faturamento &gt; 5% Irregularidade CRM % faturamento &gt; 0%"},{"location":"indicadores/grupo5-crms.html#5-metricas-complementares","title":"5. M\u00e9tricas Complementares","text":"<p>Al\u00e9m dos indicadores principais, o sistema calcula:</p>"},{"location":"indicadores/grupo5-crms.html#51-concentracao-top-1","title":"5.1. Concentra\u00e7\u00e3o Top 1","text":"<p>Percentual das vendas vinculadas ao principal prescritor:</p> \\[ \\% \\text{Top 1} = \\frac{\\text{Vendas do CRM n\u00ba 1}}{\\text{Faturamento Total}} \\times 100 \\] Valor Interpreta\u00e7\u00e3o &lt; 15% Normal 15% - 30% Elevado &gt; 30% Cr\u00edtico"},{"location":"indicadores/grupo5-crms.html#52-concentracao-top-5","title":"5.2. Concentra\u00e7\u00e3o Top 5","text":"<p>Percentual das vendas vinculadas aos 5 maiores prescritores:</p> \\[ \\% \\text{Top 5} = \\frac{\\sum \\text{Vendas dos 5 maiores CRMs}}{\\text{Faturamento Total}} \\times 100 \\] Valor Interpreta\u00e7\u00e3o &lt; 50% Normal 50% - 70% Elevado &gt; 70% Cr\u00edtico"},{"location":"indicadores/grupo5-crms.html#6-analise-integrada-de-crms","title":"6. An\u00e1lise Integrada de CRMs","text":""},{"location":"indicadores/grupo5-crms.html#61-padrao-de-fraude-medica","title":"6.1. Padr\u00e3o de Fraude M\u00e9dica","text":"<p>Quando uma farm\u00e1cia apresenta:</p> <ul> <li>\u2705 Alto HHI</li> <li>\u2705 Alta exclusividade</li> <li>\u2705 CRMs irregulares</li> </ul> <p>\u00c9 forte indicativo de esquema organizado.</p> <p>Pr\u00f3ximo Passo</p> <p>Veja a An\u00e1lise de Prescritores para mais detalhes sobre a investiga\u00e7\u00e3o de m\u00e9dicos suspeitos.</p>"},{"location":"indicadores/matriz-risco.html","title":"Matriz de Risco Final","text":"<p>A Matriz de Risco Final \u00e9 o produto central da an\u00e1lise do Sistema Sentinela. Ela consolida os 17 indicadores individuais em um score \u00fanico e uma classifica\u00e7\u00e3o de risco para cada farm\u00e1cia.</p>"},{"location":"indicadores/matriz-risco.html#1-conceito","title":"1. Conceito","text":""},{"location":"indicadores/matriz-risco.html#11-o-que-e-a-matriz-de-risco","title":"1.1. O que \u00e9 a Matriz de Risco","text":"<p>A Matriz de Risco \u00e9 uma tabela que cont\u00e9m, para cada farm\u00e1cia:</p> <ul> <li>Valores individuais de cada indicador</li> <li>Score de risco consolidado</li> <li>Classifica\u00e7\u00e3o de risco (Cr\u00edtico, Alto, M\u00e9dio, Baixo, M\u00ednimo)</li> <li>Rankings em diferentes n\u00edveis (Nacional, Estadual, Municipal)</li> </ul>"},{"location":"indicadores/matriz-risco.html#12-script-de-geracao","title":"1.2. Script de Gera\u00e7\u00e3o","text":"<pre><code>\ud83d\udcc4 Indicadores/matriz_risco_final.sql\n</code></pre>"},{"location":"indicadores/matriz-risco.html#2-calculo-do-score-de-risco","title":"2. C\u00e1lculo do Score de Risco","text":""},{"location":"indicadores/matriz-risco.html#21-metodologia","title":"2.1. Metodologia","text":"<p>O Score de Risco Final \u00e9 calculado em duas etapas:</p>"},{"location":"indicadores/matriz-risco.html#etapa-1-normalizacao-risco-relativo","title":"Etapa 1: Normaliza\u00e7\u00e3o (Risco Relativo)","text":"<p>Para cada um dos 17 indicadores, calcula-se o Risco Relativo (RR):</p> \\[ RR_i = \\frac{\\text{Indicador}_i^{\\text{farm\u00e1cia}}}{\\text{M\u00e9dia}_i^{\\text{UF}}} \\] <p>Onde:</p> <ul> <li>\\(\\text{Indicador}_i^{\\text{farm\u00e1cia}}\\) = Valor do indicador \\(i\\) para a farm\u00e1cia</li> <li>\\(\\text{M\u00e9dia}_i^{\\text{UF}}\\) = M\u00e9dia do indicador \\(i\\) para todas as farm\u00e1cias da mesma UF</li> </ul> <p>Por que usar a m\u00e9dia da UF?</p> <p>Usar a m\u00e9dia estadual como refer\u00eancia permite comparar farm\u00e1cias em contextos semelhantes, minimizando diferen\u00e7as regionais de comportamento.</p>"},{"location":"indicadores/matriz-risco.html#etapa-2-agregacao-media-aritmetica","title":"Etapa 2: Agrega\u00e7\u00e3o (M\u00e9dia Aritm\u00e9tica)","text":"<p>O Score Final \u00e9 a m\u00e9dia simples dos 17 Riscos Relativos:</p> \\[ \\text{SCORE\\_RISCO\\_FINAL} = \\frac{1}{17} \\sum_{i=1}^{17} RR_i \\]"},{"location":"indicadores/matriz-risco.html#22-tratamento-de-excecoes","title":"2.2. Tratamento de Exce\u00e7\u00f5es","text":"Situa\u00e7\u00e3o Tratamento M\u00e9dia da UF = 0 Usa m\u00e9dia nacional como refer\u00eancia M\u00e9dia nacional = 0 Considera RR = 1 (neutro) Indicador n\u00e3o dispon\u00edvel Exclui do c\u00e1lculo (ajusta denominador)"},{"location":"indicadores/matriz-risco.html#23-interpretacao-do-score","title":"2.3. Interpreta\u00e7\u00e3o do Score","text":"Score Significado 0.0 - 0.5 Muito abaixo da m\u00e9dia (comportamento exemplar) 0.5 - 1.0 Abaixo da m\u00e9dia (normal) 1.0 Exatamente na m\u00e9dia 1.0 - 2.0 Acima da m\u00e9dia (aten\u00e7\u00e3o) 2.0 - 5.0 Significativamente acima (alerta) &gt; 5.0 Muito acima (cr\u00edtico)"},{"location":"indicadores/matriz-risco.html#3-classificacao-de-risco","title":"3. Classifica\u00e7\u00e3o de Risco","text":""},{"location":"indicadores/matriz-risco.html#31-metodologia-percentil","title":"3.1. Metodologia (Percentil)","text":"<p>Ap\u00f3s calcular o Score para todas as farm\u00e1cias, aplica-se a fun\u00e7\u00e3o <code>PERCENT_RANK()</code> do SQL Server para distribuir os estabelecimentos em faixas.</p>"},{"location":"indicadores/matriz-risco.html#32-faixas-de-classificacao","title":"3.2. Faixas de Classifica\u00e7\u00e3o","text":"pie title Distribui\u00e7\u00e3o das Classifica\u00e7\u00f5es     \"M\u00cdNIMO (0-25%)\" : 25     \"BAIXO (25-75%)\" : 50     \"M\u00c9DIO (75-95%)\" : 20     \"ALTO (95-99%)\" : 4     \"CR\u00cdTICO (99-100%)\" : 1  Classifica\u00e7\u00e3o Percentil Propor\u00e7\u00e3o Descri\u00e7\u00e3o \ud83d\udd34 CR\u00cdTICO 99% - 100% ~1% Top 1% - Maior prioridade \ud83d\udfe0 ALTO 95% - 99% ~4% Top 5% - Alta prioridade \ud83d\udfe1 M\u00c9DIO 75% - 95% ~20% Quartil superior - Monitorar \ud83d\udfe2 BAIXO 25% - 75% ~50% Faixa central - Normal \ud83d\udfe2 M\u00cdNIMO 0% - 25% ~25% Quartil inferior - Comportamento exemplar"},{"location":"indicadores/matriz-risco.html#33-cores-e-alertas-visuais","title":"3.3. Cores e Alertas Visuais","text":"Classifica\u00e7\u00e3o Cor C\u00f3digo Hex CR\u00cdTICO Vermelho escuro <code>#8B0000</code> ALTO Laranja <code>#FF8C00</code> M\u00c9DIO Amarelo <code>#FFD700</code> BAIXO Verde claro <code>#90EE90</code> M\u00cdNIMO Verde <code>#228B22</code>"},{"location":"indicadores/matriz-risco.html#4-rankings","title":"4. Rankings","text":""},{"location":"indicadores/matriz-risco.html#41-tipos-de-ranking","title":"4.1. Tipos de Ranking","text":"<p>O sistema calcula tr\u00eas rankings para cada farm\u00e1cia:</p> Ranking Escopo Uso Nacional Todas as farm\u00e1cias do Brasil Prioriza\u00e7\u00e3o geral de auditorias Estadual Farm\u00e1cias da mesma UF Compara\u00e7\u00e3o regional Municipal Farm\u00e1cias do mesmo munic\u00edpio An\u00e1lise local"},{"location":"indicadores/matriz-risco.html#42-calculo","title":"4.2. C\u00e1lculo","text":"<p>Os rankings s\u00e3o calculados usando a fun\u00e7\u00e3o <code>ROW_NUMBER()</code> ordenada pelo Score de Risco (decrescente):</p> <pre><code>ROW_NUMBER() OVER (ORDER BY SCORE_RISCO_FINAL DESC)\n</code></pre>"},{"location":"indicadores/matriz-risco.html#43-exemplo-de-interpretacao","title":"4.3. Exemplo de Interpreta\u00e7\u00e3o","text":"<p>Exemplo</p> <p>Farm\u00e1cia XYZ</p> <pre><code>- Ranking Nacional: 234\u00ba de 34.000 (Top 1%)\n- Ranking Estadual: 12\u00ba de 850 (Top 2%)\n- Ranking Municipal: 3\u00ba de 45 (Top 7%)\n\n**Interpreta\u00e7\u00e3o:** Esta farm\u00e1cia est\u00e1 entre as mais arriscadas do pa\u00eds, ocupando a 234\u00aa posi\u00e7\u00e3o. No seu estado, est\u00e1 entre as 12 piores. No munic\u00edpio, \u00e9 a 3\u00aa mais arriscada.\n</code></pre>"},{"location":"indicadores/matriz-risco.html#5-indicador-de-qualidade-dos-dados","title":"5. Indicador de Qualidade dos Dados","text":""},{"location":"indicadores/matriz-risco.html#51-o-que-e","title":"5.1. O que \u00e9","text":"<p>Um flag que indica a confiabilidade dos indicadores calculados para cada farm\u00e1cia.</p>"},{"location":"indicadores/matriz-risco.html#52-criterios","title":"5.2. Crit\u00e9rios","text":"Qualidade Crit\u00e9rios Descri\u00e7\u00e3o ALTA \u226524 meses de dados, todos indicadores calculados An\u00e1lise robusta M\u00c9DIA 12-23 meses de dados, maioria dos indicadores An\u00e1lise confi\u00e1vel BAIXA &lt;12 meses ou muitos indicadores faltando Interpretar com cautela"},{"location":"indicadores/matriz-risco.html#53-uso","title":"5.3. Uso","text":"<p>Farm\u00e1cias com qualidade de dados BAIXA devem ter seus resultados interpretados com cautela extra, pois a base de dados pode n\u00e3o ser representativa.</p>"},{"location":"indicadores/matriz-risco.html#6-campos-da-matriz-de-risco","title":"6. Campos da Matriz de Risco","text":""},{"location":"indicadores/matriz-risco.html#61-identificacao","title":"6.1. Identifica\u00e7\u00e3o","text":"Campo Descri\u00e7\u00e3o <code>cnpj</code> CNPJ da farm\u00e1cia <code>razaoSocial</code> Nome da empresa <code>municipio</code> Cidade de localiza\u00e7\u00e3o <code>uf</code> Estado"},{"location":"indicadores/matriz-risco.html#62-score-e-classificacao","title":"6.2. Score e Classifica\u00e7\u00e3o","text":"Campo Descri\u00e7\u00e3o <code>SCORE_RISCO_FINAL</code> Score consolidado (0 a 10+) <code>CLASSIFICACAO_RISCO</code> Categoria (CR\u00cdTICO a M\u00cdNIMO) <code>percentil_risco</code> Percentil no ranking nacional"},{"location":"indicadores/matriz-risco.html#63-rankings","title":"6.3. Rankings","text":"Campo Descri\u00e7\u00e3o <code>rank_nacional</code> Posi\u00e7\u00e3o no Brasil <code>rank_uf</code> Posi\u00e7\u00e3o no estado <code>rank_municipio</code> Posi\u00e7\u00e3o na cidade <code>total_nacional</code> Total de farm\u00e1cias no pa\u00eds <code>total_uf</code> Total de farm\u00e1cias no estado <code>total_municipio</code> Total de farm\u00e1cias na cidade"},{"location":"indicadores/matriz-risco.html#64-indicadores-individuais","title":"6.4. Indicadores Individuais","text":"<p>Para cada um dos 17 indicadores:</p> Campo Descri\u00e7\u00e3o <code>ind_&lt;nome&gt;_valor</code> Valor bruto do indicador <code>ind_&lt;nome&gt;_rr</code> Risco Relativo do indicador <code>ind_&lt;nome&gt;_media_uf</code> M\u00e9dia da UF <code>ind_&lt;nome&gt;_media_br</code> M\u00e9dia nacional"},{"location":"indicadores/matriz-risco.html#65-contexto","title":"6.5. Contexto","text":"Campo Descri\u00e7\u00e3o <code>populacao_municipio</code> Popula\u00e7\u00e3o do munic\u00edpio (IBGE) <code>total_farmacias_municipio</code> N\u00famero de farm\u00e1cias no munic\u00edpio <code>habitantes_por_farmacia</code> Raz\u00e3o popula\u00e7\u00e3o/farm\u00e1cias <code>flag_qualidade_dados</code> Indicador de confiabilidade"},{"location":"indicadores/matriz-risco.html#7-uso-da-matriz-de-risco","title":"7. Uso da Matriz de Risco","text":""},{"location":"indicadores/matriz-risco.html#71-priorizacao-de-auditorias","title":"7.1. Prioriza\u00e7\u00e3o de Auditorias","text":"flowchart LR     A[Matriz de Risco] --&gt; B{Classifica\u00e7\u00e3o}     B --&gt;|CR\u00cdTICO| C[Auditoria Priorit\u00e1ria]     B --&gt;|ALTO| D[Auditoria Programada]     B --&gt;|M\u00c9DIO| E[Monitoramento]     B --&gt;|BAIXO/M\u00cdNIMO| F[Acompanhamento Padr\u00e3o]"},{"location":"indicadores/matriz-risco.html#72-consultas-tipicas","title":"7.2. Consultas T\u00edpicas","text":"<p>Exemplos de Consultas</p> <p>Top 100 farm\u00e1cias mais arriscadas: <pre><code>SELECT TOP 100 * FROM Matriz_Risco_Final\nORDER BY SCORE_RISCO_FINAL DESC\n</code></pre></p> <p>Farm\u00e1cias cr\u00edticas em SC: <pre><code>SELECT * FROM Matriz_Risco_Final\nWHERE uf = 'SC' AND CLASSIFICACAO_RISCO = 'CR\u00cdTICO'\n</code></pre></p> <p>Compara\u00e7\u00e3o de m\u00e9dias por UF: <pre><code>SELECT uf, AVG(SCORE_RISCO_FINAL) as media_score\nFROM Matriz_Risco_Final\nGROUP BY uf\nORDER BY media_score DESC\n</code></pre></p>"},{"location":"indicadores/matriz-risco.html#8-limitacoes-e-consideracoes","title":"8. Limita\u00e7\u00f5es e Considera\u00e7\u00f5es","text":""},{"location":"indicadores/matriz-risco.html#81-o-que-a-matriz-nao-e","title":"8.1. O que a Matriz N\u00c3O \u00e9","text":"<p>Importante</p> <p>A Matriz de Risco n\u00e3o \u00e9 uma prova de fraude. Ela \u00e9 uma ferramenta de prioriza\u00e7\u00e3o que indica quais farm\u00e1cias merecem investiga\u00e7\u00e3o mais aprofundada.</p> <pre><code>Um score alto indica **comportamento at\u00edpico**, n\u00e3o necessariamente ilegal.\n</code></pre>"},{"location":"indicadores/matriz-risco.html#82-fatores-que-podem-gerar-falsos-positivos","title":"8.2. Fatores que podem gerar falsos positivos","text":"<ul> <li>Farm\u00e1cias novas com poucos meses de dados</li> <li>Farm\u00e1cias em regi\u00f5es com poucos estabelecimentos</li> <li>Varia\u00e7\u00f5es sazonais de demanda</li> <li>Eventos locais de sa\u00fade (epidemias, campanhas)</li> </ul>"},{"location":"indicadores/matriz-risco.html#83-recomendacao","title":"8.3. Recomenda\u00e7\u00e3o","text":"<p>Sempre analise o contexto completo antes de concluir sobre irregularidades. Use a Matriz como ponto de partida, n\u00e3o como veredito final.</p> <p>Pr\u00f3ximo Passo</p> <p>Explore cada grupo de indicadores para entender a metodologia detalhada de c\u00e1lculo.</p>"},{"location":"relatorios/index.html","title":"Relat\u00f3rios","text":"<p>Esta se\u00e7\u00e3o detalha a estrutura e conte\u00fado dos relat\u00f3rios Excel gerados pelo Sistema Sentinela.</p>"},{"location":"relatorios/index.html#visao-geral","title":"Vis\u00e3o Geral","text":"<p>Cada farm\u00e1cia auditada recebe um dossi\u00ea em formato Excel (.xlsx) contendo 4 abas:</p> <ul> <li> Aba Movimenta\u00e7\u00e3o</li> </ul> <p>Fluxo cronol\u00f3gico de estoque com rastreabilidade de notas fiscais.</p> <p> Ver detalhes</p> <ul> <li> Aba Evolu\u00e7\u00e3o Financeira</li> </ul> <p>Gr\u00e1ficos semestrais de valores regulares vs irregulares.</p> <p> Ver detalhes</p> <ul> <li> Aba Indicadores</li> </ul> <p>17 indicadores de risco comparados com m\u00e9dias UF/BR.</p> <p> Ver detalhes</p> <ul> <li> Aba An\u00e1lise de CRMs</li> </ul> <p>Detalhamento dos prescritores e alertas de fraude.</p> <p> Ver detalhes</p>"},{"location":"relatorios/index.html#tipos-de-relatorio","title":"Tipos de Relat\u00f3rio","text":"Tipo C\u00f3digo Conte\u00fado Uso Completo 1 Todo o hist\u00f3rico Auditorias profundas Resumido 2 Apenas irregularidades Triagem r\u00e1pida"},{"location":"relatorios/index.html#nomenclatura","title":"Nomenclatura","text":"<p>Os arquivos s\u00e3o salvos com o seguinte padr\u00e3o:</p> <pre><code>&lt;CNPJ&gt; (&lt;Tipo&gt;).xlsx\n</code></pre> <p>Exemplos:</p> <ul> <li><code>12345678000199 (Completo).xlsx</code></li> <li><code>12345678000199 (Resumido).xlsx</code></li> </ul>"},{"location":"relatorios/index.html#formatacao-visual","title":"Formata\u00e7\u00e3o Visual","text":"<p>Os relat\u00f3rios utilizam formata\u00e7\u00e3o visual consistente:</p> Elemento Cor Significado Cabe\u00e7alho principal Azul escuro (#1F4E78) Identifica\u00e7\u00e3o da farm\u00e1cia Cabe\u00e7alho de produto Cinza (#EEEEEE) In\u00edcio de novo medicamento Linha normal Branco Per\u00edodo sem irregularidade Linha com irregularidade Vermelho claro Venda sem comprova\u00e7\u00e3o detectada Totais Azul Soma consolidada"},{"location":"relatorios/index.html#script-de-geracao","title":"Script de Gera\u00e7\u00e3o","text":"<p>Os relat\u00f3rios s\u00e3o gerados pelo script:</p> <pre><code>\ud83d\udcc4 gerar_relatorio_memoriav8.py\n</code></pre>"},{"location":"relatorios/index.html#uso-sob-demanda","title":"Uso sob demanda","text":"<pre><code>python gerar_relatorio_memoriav8.py &lt;CNPJ&gt; [tipo]\n</code></pre> Par\u00e2metro Descri\u00e7\u00e3o Valores <code>CNPJ</code> CNPJ da farm\u00e1cia (apenas n\u00fameros) 14 d\u00edgitos <code>tipo</code> Tipo de relat\u00f3rio (opcional) 1 (Completo) ou 2 (Resumido)"},{"location":"relatorios/index.html#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<p>Clique em cada aba acima para ver o detalhamento do conte\u00fado e formata\u00e7\u00e3o.</p>"},{"location":"relatorios/aba-crms.html","title":"Aba: An\u00e1lise de CRMs","text":"<p>Esta aba foca na \"ponta da caneta\" - os m\u00e9dicos prescritores vinculados \u00e0s vendas da farm\u00e1cia.</p>"},{"location":"relatorios/aba-crms.html#estrutura","title":"Estrutura","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                         CABE\u00c7ALHO                                   \u2502\n\u2502  CNPJ: 12.345.678/0001-99 | FARM\u00c1CIA EXEMPLO LTDA                  \u2502\n\u2502  Munic\u00edpio/UF: FLORIAN\u00d3POLIS/SC                                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                      CARDS DE RESUMO                                \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510            \u2502\n\u2502  \u2502Top 1:  \u2502 \u2502Top 5:  \u2502 \u2502 Rob\u00f4s: \u2502 \u2502Inv\u00e1lidos\u2502 \u2502Geogr\u00e1f.\u2502            \u2502\n\u2502  \u2502  35%   \u2502 \u2502  72%   \u2502 \u2502   3    \u2502 \u2502   2     \u2502 \u2502   1    \u2502            \u2502\n\u2502  \u2502 \ud83d\udd34     \u2502 \u2502 \ud83d\udd34     \u2502 \u2502 \ud83d\udd34     \u2502 \u2502 \ud83d\udd34      \u2502 \u2502 \ud83d\udfe1     \u2502            \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                TABELA DE INDICADORES VS M\u00c9DIAS                      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510           \u2502\n\u2502  \u2502     Indicador      \u2502 Farm\u00e1cia \u2502 M\u00e9dia UF \u2502 M\u00e9dia BR \u2502           \u2502\n\u2502  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524           \u2502\n\u2502  \u2502 Concentra\u00e7\u00e3o Top 1 \u2502   35%    \u2502   15%    \u2502   12%    \u2502           \u2502\n\u2502  \u2502 Concentra\u00e7\u00e3o Top 5 \u2502   72%    \u2502   45%    \u2502   40%    \u2502           \u2502\n\u2502  \u2502 \u00cdndice HHI         \u2502  2845    \u2502   890    \u2502   750    \u2502           \u2502\n\u2502  \u2502 % CRMs Inv\u00e1lidos   \u2502   5%     \u2502   0,5%   \u2502   0,3%   \u2502           \u2502\n\u2502  \u2502 Prescritores Rob\u00f4  \u2502    3     \u2502   0,2    \u2502   0,1    \u2502           \u2502\n\u2502  \u2502 \u00cdndice de Rede     \u2502   1,5    \u2502   3,2    \u2502   4,1    \u2502           \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                   CRMs DE INTERESSE                                 \u2502\n\u2502  (Top 20 prescritores + CRMs com alertas)                          \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502Rank\u2502   CRM   \u2502     Nome       \u2502Prescri\u00e7\u00f5es\u2502  Valor  \u2502 Alertas \u2502 \u2502\n\u2502  \u251c\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524 \u2502\n\u2502  \u2502 1  \u250212345/SC \u2502Dr. Jo\u00e3o Silva  \u2502   1.250  \u2502R$150.000\u2502&gt;30/dia\ud83d\udd34\u2502 \u2502\n\u2502  \u2502 2  \u250299999/SP \u2502Inv\u00e1lido        \u2502     890  \u2502R$ 89.000\u2502Inv\u00e1lido\ud83d\udd34\u2502 \u2502\n\u2502  \u2502 3  \u250267890/SC \u2502Dra. Maria S.   \u2502     750  \u2502R$ 75.000\u2502         \u2502 \u2502\n\u2502  \u2502 ...\u2502  ...    \u2502     ...        \u2502    ...   \u2502   ...   \u2502   ...   \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                   ALERTAS IDENTIFICADOS                             \u2502\n\u2502                                                                     \u2502\n\u2502  \u26a0\ufe0f CRM INV\u00c1LIDO: O m\u00e9dico CRM 99999/SP n\u00e3o foi localizado na base \u2502\n\u2502     do Conselho Federal de Medicina. Total de vendas vinculadas:    \u2502\n\u2502     R$ 89.000,00 (890 prescri\u00e7\u00f5es).                                \u2502\n\u2502                                                                     \u2502\n\u2502  \u26a0\ufe0f PRESCRITOR ROB\u00d4: O m\u00e9dico Dr. Jo\u00e3o Silva (CRM 12345/SC)        \u2502\n\u2502     apresentou m\u00e9dia de 45 prescri\u00e7\u00f5es por dia nesta farm\u00e1cia,     \u2502\n\u2502     volume incompat\u00edvel com a pr\u00e1tica m\u00e9dica regular.              \u2502\n\u2502                                                                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"relatorios/aba-crms.html#cards-de-resumo","title":"Cards de Resumo","text":"Card M\u00e9trica Alerta Top 1 % vendas do principal prescritor &gt;30% = \ud83d\udd34 Top 5 % vendas dos 5 maiores &gt;70% = \ud83d\udd34 Rob\u00f4s Prescritores com &gt;30/dia &gt;0 = \ud83d\udd34 Inv\u00e1lidos CRMs n\u00e3o encontrados &gt;0 = \ud83d\udd34 Geogr\u00e1fico Prescritores &gt;400km &gt;0 = \ud83d\udfe1"},{"location":"relatorios/aba-crms.html#tabela-de-indicadores","title":"Tabela de Indicadores","text":"<p>Compara m\u00e9tricas de CRM da farm\u00e1cia com m\u00e9dias regionais:</p> Indicador Descri\u00e7\u00e3o Concentra\u00e7\u00e3o Top 1 % do faturamento do maior prescritor Concentra\u00e7\u00e3o Top 5 % do faturamento dos 5 maiores \u00cdndice HHI Concentra\u00e7\u00e3o geral (0-10.000) % CRMs Inv\u00e1lidos Propor\u00e7\u00e3o de CRMs inexistentes Prescritores Rob\u00f4 Quantidade com &gt;30 prescri\u00e7\u00f5es/dia \u00cdndice de Rede M\u00e9dia de farm\u00e1cias por prescritor"},{"location":"relatorios/aba-crms.html#tabela-de-crms-de-interesse","title":"Tabela de CRMs de Interesse","text":"<p>Lista detalhada dos principais prescritores:</p> Coluna Descri\u00e7\u00e3o Rank Posi\u00e7\u00e3o por volume de vendas CRM N\u00famero do registro / UF Nome Nome do m\u00e9dico 1\u00aa Prescri\u00e7\u00e3o Data da primeira prescri\u00e7\u00e3o Registro CFM Data de inscri\u00e7\u00e3o no conselho Prescri\u00e7\u00f5es Total de prescri\u00e7\u00f5es Valor Valor total movimentado % Participa\u00e7\u00e3o Percentual do faturamento Prescri\u00e7\u00f5es/Dia M\u00e9dia di\u00e1ria N\u00ba Farm\u00e1cias Em quantas farm\u00e1cias atua Alertas Flags de risco"},{"location":"relatorios/aba-crms.html#tipos-de-alerta","title":"Tipos de Alerta","text":"Alerta Crit\u00e9rio Cor/Formato \ud83d\udd34 CRM Inv\u00e1lido N\u00e3o localizado no CFM Fundo vermelho \ud83d\udd34 &gt;30/dia Aqui &gt;30 prescri\u00e7\u00f5es/dia local Fundo magenta \ud83d\udfe3 &gt;30/dia Rede &gt;30 prescri\u00e7\u00f5es/dia nacional Fundo roxo \ud83d\udfe3 Multi-Farm\u00e1cia Atua em &gt;20 farm\u00e1cias Fundo roxo \ud83d\udfe0 Tempo Concentrado Todas prescri\u00e7\u00f5es em per\u00edodo curto Fundo laranja \ud83d\udd35 Geogr\u00e1fico Prescritor &gt;400km de dist\u00e2ncia Fundo azul \ud83d\udd34 Retroativo Prescri\u00e7\u00e3o antes do registro Fundo vermelho"},{"location":"relatorios/aba-crms.html#secao-de-alertas-identificados","title":"Se\u00e7\u00e3o de Alertas Identificados","text":"<p>Ao final da aba, texto descritivo de cada alerta:</p> <p>Exemplo de Alerta</p> <p>\u26a0\ufe0f CRM INV\u00c1LIDO</p> <pre><code>O m\u00e9dico CRM 99999/SP n\u00e3o foi localizado na base do Conselho Federal de Medicina. Este CRM pode ser:\n\n- Inexistente (n\u00famero fict\u00edcio)\n- De m\u00e9dico com registro cancelado\n- De m\u00e9dico falecido\n\n**Total de vendas vinculadas:** R$ 89.000,00 (890 prescri\u00e7\u00f5es)\n</code></pre>"},{"location":"relatorios/aba-crms.html#interpretacao","title":"Interpreta\u00e7\u00e3o","text":""},{"location":"relatorios/aba-crms.html#checklist-de-analise","title":"Checklist de An\u00e1lise","text":"<ol> <li>Cards vermelhos? \u2192 Investiga\u00e7\u00e3o priorit\u00e1ria</li> <li>CRM inv\u00e1lido? \u2192 Fraude documental prov\u00e1vel</li> <li>Prescritor rob\u00f4? \u2192 Volume imposs\u00edvel</li> <li>Alta concentra\u00e7\u00e3o? \u2192 Depend\u00eancia de poucos m\u00e9dicos</li> <li>Alerta geogr\u00e1fico? \u2192 M\u00e9dico de outra regi\u00e3o</li> </ol>"},{"location":"relatorios/aba-crms.html#acoes-recomendadas","title":"A\u00e7\u00f5es Recomendadas","text":"Situa\u00e7\u00e3o A\u00e7\u00e3o CRM inv\u00e1lido Verificar no portal do CFM Rob\u00f4 Calcular prescri\u00e7\u00f5es por hora trabalhada Concentra\u00e7\u00e3o alta Analisar padr\u00e3o de prescri\u00e7\u00e3o Geogr\u00e1fico Verificar endere\u00e7o real do m\u00e9dico"},{"location":"relatorios/aba-evolucao.html","title":"Aba: Evolu\u00e7\u00e3o Financeira","text":"<p>Esta aba apresenta a vis\u00e3o gerencial da farm\u00e1cia, permitindo identificar tend\u00eancias e padr\u00f5es ao longo do tempo.</p>"},{"location":"relatorios/aba-evolucao.html#estrutura","title":"Estrutura","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      RESUMO FINANCEIRO                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                   \u2502\n\u2502  \u2502Total Vendas \u2502 \u2502Total Irreg. \u2502 \u2502   % M\u00e9dia   \u2502                   \u2502\n\u2502  \u2502R$ 1.500.000 \u2502 \u2502 R$ 450.000  \u2502 \u2502   30,0%     \u2502                   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                      TABELA SEMESTRAL                               \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                \u2502\n\u2502  \u2502 Semestre \u2502   Regular   \u2502  Irregular  \u2502    %    \u2502                \u2502\n\u2502  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524                \u2502\n\u2502  \u2502 2015-S2  \u2502  R$ 45.000  \u2502  R$  5.000  \u2502  10,0%  \u2502                \u2502\n\u2502  \u2502 2016-S1  \u2502  R$ 65.000  \u2502  R$ 15.000  \u2502  18,8%  \u2502                \u2502\n\u2502  \u2502 2016-S2  \u2502  R$ 70.000  \u2502  R$ 20.000  \u2502  22,2%  \u2502                \u2502\n\u2502  \u2502   ...    \u2502     ...     \u2502     ...     \u2502   ...   \u2502                \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                         GR\u00c1FICOS                                    \u2502\n\u2502                                                                     \u2502\n\u2502  [Gr\u00e1fico de Barras Empilhadas]                                    \u2502\n\u2502  Regular vs Irregular por semestre                                  \u2502\n\u2502                                                                     \u2502\n\u2502  [Gr\u00e1fico de \u00c1rea]                                                 \u2502\n\u2502  Evolu\u00e7\u00e3o do valor irregular ao longo do tempo                     \u2502\n\u2502                                                                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"relatorios/aba-evolucao.html#secoes","title":"Se\u00e7\u00f5es","text":""},{"location":"relatorios/aba-evolucao.html#1-cards-de-resumo","title":"1. Cards de Resumo","text":"<p>Tr\u00eas indicadores principais no topo:</p> Card Conte\u00fado Cor Total de Vendas Faturamento total no per\u00edodo Azul Total Irregular Valor das vendas sem comprova\u00e7\u00e3o Vermelho % M\u00e9dia Percentual m\u00e9dio de irregularidade Amarelo ou Verde"},{"location":"relatorios/aba-evolucao.html#2-tabela-semestral","title":"2. Tabela Semestral","text":"<p>Agrega\u00e7\u00e3o dos valores por semestre:</p> Coluna Descri\u00e7\u00e3o Semestre Per\u00edodo no formato AAAA-S1 ou AAAA-S2 Vendas Regulares Valor das vendas com comprova\u00e7\u00e3o Vendas Irregulares Valor das vendas sem comprova\u00e7\u00e3o % Irregularidade Propor\u00e7\u00e3o irregular/total"},{"location":"relatorios/aba-evolucao.html#3-graficos","title":"3. Gr\u00e1ficos","text":""},{"location":"relatorios/aba-evolucao.html#31-barras-empilhadas","title":"3.1. Barras Empilhadas","text":"<ul> <li>Eixo X: Semestres</li> <li>Eixo Y: Valor em R$</li> <li>Cores: Regular (azul), Irregular (vermelho)</li> <li>Finalidade: Comparar propor\u00e7\u00f5es ao longo do tempo</li> </ul>"},{"location":"relatorios/aba-evolucao.html#32-grafico-de-area","title":"3.2. Gr\u00e1fico de \u00c1rea","text":"<ul> <li>Eixo X: Semestres</li> <li>Eixo Y: Valor irregular em R$</li> <li>Finalidade: Destacar tend\u00eancia de crescimento</li> </ul>"},{"location":"relatorios/aba-evolucao.html#interpretacao","title":"Interpreta\u00e7\u00e3o","text":""},{"location":"relatorios/aba-evolucao.html#padroes-tipicos","title":"Padr\u00f5es T\u00edpicos","text":"Padr\u00e3o Visualiza\u00e7\u00e3o Interpreta\u00e7\u00e3o Crescente \u00c1rea subindo Fraude em expans\u00e3o Est\u00e1vel alto \u00c1rea plana no topo Fraude sistem\u00e1tica Pico isolado Barra alta em um per\u00edodo Evento pontual Decrescente \u00c1rea descendo Corre\u00e7\u00e3o ou encerramento"},{"location":"relatorios/aba-evolucao.html#perguntas-a-responder","title":"Perguntas a Responder","text":"<ol> <li>Quando come\u00e7ou? Primeiro semestre com irregularidade significativa</li> <li>Qual a tend\u00eancia? Crescente, est\u00e1vel ou decrescente</li> <li>H\u00e1 sazonalidade? Picos em determinados per\u00edodos</li> <li>Qual o impacto total? Card de Total Irregular</li> </ol>"},{"location":"relatorios/aba-evolucao.html#uso-em-auditoria","title":"Uso em Auditoria","text":""},{"location":"relatorios/aba-evolucao.html#selecao-de-periodo-para-investigacao","title":"Sele\u00e7\u00e3o de Per\u00edodo para Investiga\u00e7\u00e3o","text":"<p>Use esta aba para:</p> <ol> <li>Identificar os semestres mais cr\u00edticos</li> <li>Focar a an\u00e1lise na aba Movimenta\u00e7\u00e3o desses per\u00edodos</li> <li>Correlacionar com mudan\u00e7as de prescritor (aba CRMs)</li> </ol>"},{"location":"relatorios/aba-evolucao.html#formatacao","title":"Formata\u00e7\u00e3o","text":"Elemento Cor Vendas regulares (gr\u00e1fico) Azul (#4472C4) Vendas irregulares (gr\u00e1fico) Vermelho (#FF6B6B) Linha de tend\u00eancia Laranja Fundo da \u00e1rea irregular Vermelho com transpar\u00eancia"},{"location":"relatorios/aba-indicadores.html","title":"Aba: Indicadores de Risco","text":"<p>Esta aba contextualiza a farm\u00e1cia em rela\u00e7\u00e3o ao mercado, apresentando os 17 indicadores de risco e a posi\u00e7\u00e3o nos rankings.</p>"},{"location":"relatorios/aba-indicadores.html#estrutura","title":"Estrutura","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      PAINEL DE SCORE                                \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502  SCORE DE RISCO: 7.8           CLASSIFICA\u00c7\u00c3O: \ud83d\udd34 CR\u00cdTICO    \u2502   \u2502\n\u2502  \u2502  \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591 78%      \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                         RANKINGS                                    \u2502\n\u2502  Nacional: 234\u00ba de 34.000 farm\u00e1cias (Top 1%)                       \u2502\n\u2502  Estadual: 12\u00ba de 850 farm\u00e1cias (Top 2%)                           \u2502\n\u2502  Municipal: 3\u00ba de 45 farm\u00e1cias (Top 7%)                            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                    CONTEXTO DEMOGR\u00c1FICO                             \u2502\n\u2502  Munic\u00edpio: FLORIAN\u00d3POLIS/SC                                        \u2502\n\u2502  Popula\u00e7\u00e3o: 508.826 habitantes                                      \u2502\n\u2502  Farm\u00e1cias credenciadas: 45                                         \u2502\n\u2502  Habitantes por farm\u00e1cia: 11.307                                    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                   TABELA DE INDICADORES                             \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502     Indicador      \u2502 Farm\u00e1cia \u2502 M\u00e9dia UF \u2502 M\u00e9dia BR \u2502  Risco \u2502  \u2502\n\u2502  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524  \u2502\n\u2502  \u2502 % Falecidos        \u2502   2,5%   \u2502   0,1%   \u2502   0,1%   \u2502  \ud83d\udd34    \u2502  \u2502\n\u2502  \u2502 Ticket M\u00e9dio       \u2502  R$ 180  \u2502  R$ 85   \u2502  R$ 90   \u2502  \ud83d\udd34    \u2502  \u2502\n\u2502  \u2502 HHI Prescritores   \u2502   3245   \u2502   890    \u2502   750    \u2502  \ud83d\udd34    \u2502  \u2502\n\u2502  \u2502 % Vendas R\u00e1pidas   \u2502   8,5%   \u2502   1,2%   \u2502   1,0%   \u2502  \ud83d\udfe0    \u2502  \u2502\n\u2502  \u2502 ...                \u2502   ...    \u2502   ...    \u2502   ...    \u2502  ...   \u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502               TOP 15 MAIORES RISCOS NO MUNIC\u00cdPIO                    \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502 Pos \u2502       Raz\u00e3o Social       \u2502  Score   \u2502  Classifica\u00e7\u00e3o \u2502    \u2502\n\u2502  \u251c\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524    \u2502\n\u2502  \u2502  1  \u2502 FARM\u00c1CIA ALPHA LTDA      \u2502   9.2    \u2502   CR\u00cdTICO      \u2502    \u2502\n\u2502  \u2502  2  \u2502 DROGARIA BETA EIRELI     \u2502   8.5    \u2502   CR\u00cdTICO      \u2502    \u2502\n\u2502  \u2502  3  \u2502 FARM\u00c1CIA EXEMPLO LTDA \u25c0  \u2502   7.8    \u2502   CR\u00cdTICO      \u2502    \u2502\n\u2502  \u2502 ... \u2502 ...                      \u2502   ...    \u2502   ...          \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"relatorios/aba-indicadores.html#secoes","title":"Se\u00e7\u00f5es","text":""},{"location":"relatorios/aba-indicadores.html#1-painel-de-score","title":"1. Painel de Score","text":"Elemento Descri\u00e7\u00e3o Score de Risco Valor num\u00e9rico 0-10+ Classifica\u00e7\u00e3o CR\u00cdTICO, ALTO, M\u00c9DIO, BAIXO ou M\u00cdNIMO Barra de Progresso Visualiza\u00e7\u00e3o gr\u00e1fica do percentil"},{"location":"relatorios/aba-indicadores.html#2-rankings","title":"2. Rankings","text":"N\u00edvel O que mostra Nacional Posi\u00e7\u00e3o entre todas as farm\u00e1cias do Brasil Estadual Posi\u00e7\u00e3o entre farm\u00e1cias da mesma UF Municipal Posi\u00e7\u00e3o entre farm\u00e1cias da mesma cidade"},{"location":"relatorios/aba-indicadores.html#3-contexto-demografico","title":"3. Contexto Demogr\u00e1fico","text":"<p>Informa\u00e7\u00f5es que ajudam a contextualizar os n\u00fameros:</p> <ul> <li>Popula\u00e7\u00e3o do munic\u00edpio</li> <li>N\u00famero de farm\u00e1cias credenciadas</li> <li>Raz\u00e3o habitantes/farm\u00e1cia</li> </ul>"},{"location":"relatorios/aba-indicadores.html#4-tabela-de-indicadores","title":"4. Tabela de Indicadores","text":"<p>Os 17 indicadores organizados em grupos:</p> Grupo Indicadores Elegibilidade &amp; Cl\u00ednica Falecidos, Incompatibilidade Quantidade Teto, Polimedicamento, M\u00e9dia de Itens Financeiro Ticket M\u00e9dio, Per Capita, Alto Custo, Receita/Paciente Automa\u00e7\u00e3o &amp; Geografia Vendas R\u00e1pidas, Madrugada, Pico, Geogr\u00e1fico, Pacientes \u00danicos CRMs HHI, Exclusividade, Irregularidade"},{"location":"relatorios/aba-indicadores.html#5-top-15-do-municipio","title":"5. Top 15 do Munic\u00edpio","text":"<p>Lista as farm\u00e1cias de maior risco na mesma cidade, destacando a posi\u00e7\u00e3o da farm\u00e1cia analisada.</p>"},{"location":"relatorios/aba-indicadores.html#formatacao-de-risco","title":"Formata\u00e7\u00e3o de Risco","text":"\u00cdcone Cor Significado \ud83d\udd34 Vermelho Risco Cr\u00edtico/Alto \ud83d\udfe0 Laranja Risco M\u00e9dio \ud83d\udfe1 Amarelo Risco Leve \ud83d\udfe2 Verde Normal/Baixo"},{"location":"relatorios/aba-indicadores.html#comentarios-explicativos","title":"Coment\u00e1rios Explicativos","text":"<p>Cada indicador na tabela possui um coment\u00e1rio (c\u00e9lula de nota no Excel) que explica:</p> <ul> <li>Metodologia de c\u00e1lculo</li> <li>Interpreta\u00e7\u00e3o do valor</li> <li>Contextualiza\u00e7\u00e3o</li> </ul> <p>Como ver coment\u00e1rios</p> <p>Passe o mouse sobre a c\u00e9lula do nome do indicador para ver a explica\u00e7\u00e3o completa.</p>"},{"location":"relatorios/aba-indicadores.html#interpretacao","title":"Interpreta\u00e7\u00e3o","text":""},{"location":"relatorios/aba-indicadores.html#leitura-do-score","title":"Leitura do Score","text":"Score Interpreta\u00e7\u00e3o 0 - 1 Muito abaixo da m\u00e9dia 1 - 2 Na m\u00e9dia 2 - 5 Acima da m\u00e9dia 5 - 10 Muito acima da m\u00e9dia &gt; 10 Extremamente an\u00f4malo"},{"location":"relatorios/aba-indicadores.html#analise-por-indicador","title":"An\u00e1lise por Indicador","text":"<ol> <li>Compare o valor da farm\u00e1cia com as m\u00e9dias UF e BR</li> <li>Indicadores com alto desvio merecem investiga\u00e7\u00e3o</li> <li>M\u00faltiplos indicadores altos indicam padr\u00e3o sistem\u00e1tico</li> </ol>"},{"location":"relatorios/aba-indicadores.html#uso-em-auditoria","title":"Uso em Auditoria","text":"<ol> <li>Prioriza\u00e7\u00e3o: Use o score para decidir quais farm\u00e1cias auditar primeiro</li> <li>Foco: Identifique os indicadores mais discrepantes para direcionar a an\u00e1lise</li> <li>Contexto: Compare com outras farm\u00e1cias do munic\u00edpio (Top 15)</li> <li>Documenta\u00e7\u00e3o: A tabela serve como resumo executivo do perfil de risco</li> </ol>"},{"location":"relatorios/aba-movimentacao.html","title":"Aba: Movimenta\u00e7\u00e3o de Estoque","text":"<p>Esta \u00e9 a aba anal\u00edtica principal do relat\u00f3rio, contendo a prova material da auditoria de fluxo de estoque.</p>"},{"location":"relatorios/aba-movimentacao.html#estrutura-visual","title":"Estrutura Visual","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      CABE\u00c7ALHO DA FARM\u00c1CIA                          \u2502\n\u2502  Raz\u00e3o Social: FARM\u00c1CIA EXEMPLO LTDA                                \u2502\n\u2502  CNPJ: 12.345.678/0001-99    Munic\u00edpio/UF: FLORIAN\u00d3POLIS/SC         \u2502\n\u2502  Contato: (48) 3333-3333 | email@farmacia.com                       \u2502\n\u2502  Per\u00edodo: 01/07/2015 a 10/12/2024                                   \u2502\n\u2502  Crit\u00e9rio Estoque Inicial: Soma das 2 \u00faltimas NFs (6 meses)         \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  \ud83c\udfe5 MEDICAMENTO: LOSARTANA 50MG (GTIN: 7891234567890)               \u2502\n\u2502  Estoque Inicial: 50 caixas                                         \u2502\n\u2502  Notas Base: NF 12345 (20/06/2015) 30cx | NF 12346 (25/06/2015) 20cx\u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Per\u00edodo \u2502Est.Ini\u2502Vendas\u2502Aquis.\u2502Est.Fin\u2502S/Comprov.\u2502Valor S/C\u2502 Notas \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502Jul/2015 \u2502   50  \u2502  45  \u2502   0  \u2502   5   \u2502    0     \u2502 R$ 0,00 \u2502       \u2502\n\u2502Ago/2015 \u2502    5  \u2502  30  \u2502   0  \u2502   0   \u2502   25     \u2502R$750,00 \u2502  \u26a0\ufe0f   \u2502\n\u2502Set/2015 \u2502    0  \u2502   0  \u2502  60  \u2502  60   \u2502    0     \u2502 R$ 0,00 \u2502NF 789 \u2502\n\u2502 ...     \u2502  ...  \u2502 ...  \u2502 ...  \u2502  ...  \u2502   ...    \u2502  ...    \u2502 ...   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                         SUM\u00c1RIO DO MEDICAMENTO                      \u2502\n\u2502  Total Vendas: 1.200 | Sem Comprova\u00e7\u00e3o: 180 (15%) | R$ 5.400,00     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  \ud83c\udfe5 MEDICAMENTO: ATENOLOL 25MG (GTIN: 7891234567891)                \u2502\n\u2502  ...                                                                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                            TOTAL GERAL                              \u2502\n\u2502  Total Vendas: R$ 450.000,00                                        \u2502\n\u2502  Total Sem Comprova\u00e7\u00e3o: R$ 135.000,00 (30%)                         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"relatorios/aba-movimentacao.html#colunas","title":"Colunas","text":"Coluna Descri\u00e7\u00e3o Per\u00edodo Data ou m\u00eas/ano da movimenta\u00e7\u00e3o Estoque Inicial Quantidade em estoque no in\u00edcio do per\u00edodo Vendas Per\u00edodo Quantidade vendida Aquisi\u00e7\u00f5es Quantidade comprada (entrada) Estoque Final Estoque recalculado ao final Sem Comprova\u00e7\u00e3o (Qtd) Quantidade vendida sem lastro Sem Comprova\u00e7\u00e3o (R$) Valor financeiro da irregularidade Notas NFs de aquisi\u00e7\u00e3o para rastreabilidade"},{"location":"relatorios/aba-movimentacao.html#coluna-notas-rastreabilidade","title":"Coluna \"Notas\" - Rastreabilidade","text":"<p>Diferencial T\u00e9cnico</p> <p>Esta coluna \u00e9 o diferencial t\u00e9cnico do relat\u00f3rio. Para cada per\u00edodo, o sistema lista as Notas Fiscais que deram lastro ao estoque.</p>"},{"location":"relatorios/aba-movimentacao.html#formato","title":"Formato","text":"<pre><code>NF Aquisi\u00e7\u00e3o: 12345 - 29/09/2021 | Qtde: 50\n</code></pre>"},{"location":"relatorios/aba-movimentacao.html#quando-aparece","title":"Quando aparece","text":"<ul> <li>Com notas: Indica quais NFs comp\u00f5em o estoque que permitiu a venda</li> <li>Vazia: N\u00e3o houve aquisi\u00e7\u00e3o no per\u00edodo</li> <li>\"SEM LASTRO\": Venda ocorreu sem estoque suficiente</li> </ul>"},{"location":"relatorios/aba-movimentacao.html#formatacao-condicional","title":"Formata\u00e7\u00e3o Condicional","text":"Situa\u00e7\u00e3o Cor de Fundo Cor do Texto Per\u00edodo normal Branco Preto Cabe\u00e7alho do medicamento Cinza (#EEEEEE) Preto Irregularidade detectada Vermelho claro Vermelho Totais Azul escuro Branco Linha de aquisi\u00e7\u00e3o Verde claro Preto"},{"location":"relatorios/aba-movimentacao.html#tipos-de-registro","title":"Tipos de Registro","text":"<p>A mem\u00f3ria de c\u00e1lculo cont\u00e9m diferentes tipos de registro:</p> Tipo C\u00f3digo Descri\u00e7\u00e3o Header <code>h</code> Cabe\u00e7alho do medicamento Estoque <code>e</code> Estoque inicial estimado Compra <code>c</code> Aquisi\u00e7\u00e3o de medicamento Devolu\u00e7\u00e3o <code>d</code> Devolu\u00e7\u00e3o ao fornecedor Venda <code>v</code> Per\u00edodo de vendas Sum\u00e1rio <code>s</code> Totais do medicamento"},{"location":"relatorios/aba-movimentacao.html#diferenca-completo-vs-resumido","title":"Diferen\u00e7a: Completo vs Resumido","text":"Relat\u00f3rio CompletoRelat\u00f3rio Resumido <p>Inclui todas as linhas de movimenta\u00e7\u00e3o:</p> <ul> <li>Per\u00edodos com vendas normais</li> <li>Per\u00edodos com irregularidades</li> <li>Per\u00edodos sem movimento</li> </ul> <p>Uso: Auditoria completa, investiga\u00e7\u00e3o profunda</p> <p>Inclui apenas linhas com irregularidades:</p> <ul> <li>Filtra: <code>valor_sem_comprovacao &gt; 0</code></li> <li>Mant\u00e9m cabe\u00e7alhos e sum\u00e1rios</li> </ul> <p>Uso: Triagem r\u00e1pida, vis\u00e3o geral</p>"},{"location":"relatorios/aba-movimentacao.html#interpretacao","title":"Interpreta\u00e7\u00e3o","text":""},{"location":"relatorios/aba-movimentacao.html#como-ler-a-aba","title":"Como ler a aba","text":"<ol> <li>Identifique o medicamento pelo cabe\u00e7alho cinza</li> <li>Verifique o estoque inicial e quais NFs o comp\u00f5em</li> <li>Siga a cronologia linha a linha</li> <li>Linhas vermelhas = irregularidades</li> <li>Verifique a coluna Notas para rastreabilidade</li> </ol>"},{"location":"relatorios/aba-movimentacao.html#exemplo-de-leitura","title":"Exemplo de Leitura","text":"<p>Leitura de uma linha</p> <p><code>Per\u00edodo: Ago/2015 | Est.Ini: 5 | Vendas: 30 | Est.Fin: 0 | S/C: 25</code></p> <pre><code>**Interpreta\u00e7\u00e3o:**\n\n- Em agosto de 2015, havia **5 caixas** em estoque\n- Foram vendidas **30 caixas**\n- Estoque ficou **negativo** em 25\n- Sistema zerou para 0 e registrou **25 caixas sem comprova\u00e7\u00e3o**\n- Essas 25 caixas foram vendidas sem ter sido compradas\n</code></pre>"},{"location":"relatorios/aba-movimentacao.html#navegacao","title":"Navega\u00e7\u00e3o","text":"<ul> <li>Use Ctrl+F para buscar um GTIN espec\u00edfico</li> <li>Os pain\u00e9is est\u00e3o congelados - cabe\u00e7alhos ficam vis\u00edveis ao rolar</li> <li>Utilize os filtros do Excel para focar em irregularidades</li> </ul>"}]}